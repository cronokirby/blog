<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>cronokirby - Cait-Sith Security (0): Preliminaries</title>
<meta name="description" content="The security framework we follow is MPS, which provides similar guarantees to UC security, but in a state-separable proof flavor.Unfortunately I don't think the">
<meta name="google-site-verification" content="L52nFdg1z0h1iXWgwFjYNRl14XgaybiiL_UbPpm6-Mc" />
<link rel="canonical" href="https://cronokirby.com/Notes/Cait-Sith-Security-0-Preliminaries.html">
<meta property="og:title" content="Cait-Sith Security (0): Preliminaries">
<meta property="og:description" content="The security framework we follow is MPS, which provides similar guarantees to UC security, but in a state-separable proof flavor.Unfortunately I don't think the">
<meta property="og:url" content="https://cronokirby.com/Notes/Cait-Sith-Security-0-Preliminaries.html">
<meta property="og:site_name" content="cronokirby">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cait-Sith Security (0): Preliminaries">
<meta name="twitter:description" content="The security framework we follow is MPS, which provides similar guarantees to UC security, but in a state-separable proof flavor.Unfortunately I don't think the">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css" integrity="sha384-Pu5+C18nP5dwykLJOhd2U4Xen7rjScHN/qusop27hdd2drI+lL5KvX7YntvT8yew" crossorigin="anonymous">

<link rel="stylesheet" href="/static/index.css">
<link rel="icon" href="/static/icon.png">
<script src="/static/theme.js" defer></script>
</head>
<body>
<header>
<div class="icon-bar">
  <a href="/">
    <img src="/static/icon.png" class="avatar" alt="cronokirby" />
  </a>
  <button class="theme-toggle" id="theme-toggle">
    <svg xmlns="http://www.w3.org/2000/svg" height="2em" viewBox="0 -960 960 960" width="2em" fill="currentColor"><path d="M480-120q-133 0-226.5-92.5T160-436q0-66 25-122t69-100l226-222 226 222q44 44 69 100t25 122q0 131-93.5 223.5T480-120Zm0-80v-568L310-600q-35 33-52.5 74.5T240-436q0 97 70 166.5T480-200Z"/></svg>
  </button>
</div>
<time datetime="2023-04-30">2023-04-30</time>

<h1>Cait-Sith Security (0): Preliminaries</h1>




</header>

<p>The security framework we follow is <a href=https://eprint.iacr.org/2023/187>MPS</a>,
which provides similar guarantees to UC security,
but in a state-separable proof flavor.</p>
<p>Unfortunately I don't think there's a much better introduction to the framework
than the paper itself, although the paper should be relatively approachable.</p>
<h1>Notation</h1>
<p>We use a kind of vector notation pervasively.
The basics are that:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>implicitly means that we're parametrizing a piece of code over
every value of <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> as it ranges over some number of values.
Usually this is over <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span></span>, the number of parties.</p>
<p>For example, a function named <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_i()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span></span></span> would in fact
mean that we're writing down several functions at the same time,
parametrized by <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>.</p>
<p>Any index that isn't free doesn't range.</p>
<p>For example a value <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mi>j</mi></mrow></mrow><annotation encoding="application/x-tex">y\_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9695em;vertical-align:-0.31em;"></span><span class="mord mathnormal" style="margin-right:0.0359em;">y</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">ij</span></span></span></span></span></span> inside of a function <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">F_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-left:-0.1389em;margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> would
denote the entries of a vector, ranging over <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span></span></span></span></span>,
since <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> is fixed.</p>
<p>For example:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable columnspacing="0em" rowspacing="0.25em" columnalign="right left"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msub><mi>F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">‾</mo></munder><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>y</mi><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>←</mo><mi>m</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\underline{F_i(m)}:\cr
&amp;\enspace
  y\_{ij} \gets m
\cr
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.09em;vertical-align:-1.295em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.795em;"><span style="top:-3.795em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.205em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.295em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.795em;"><span style="top:-3.955em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-left:-0.1389em;margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:-2.365em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal" style="margin-right:0.0359em;">y</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">ij</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.295em;"><span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>would denote several functions <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">F_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-right:0.05em;top:-2.55em;margin-left:-0.1389em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>, each of which modifies
an entire column of the matrix <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0359em;">y</span></span></span></span></span>.</p>
<p>We can also perform operations point wise, like <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>←</mo><mi>b</mi><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>+</mo><mi>c</mi><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mi>j</mi></mrow></mrow><annotation encoding="application/x-tex">a\_{ij} \gets b\_{ij} + c\_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9695em;vertical-align:-0.31em;"></span><span class="mord mathnormal">a</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">ij</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="vertical-align:-0.31em;height:1.0044em;"></span><span class="mord mathnormal">b</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">ij</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="vertical-align:-0.31em;height:0.9695em;"></span><span class="mord mathnormal">c</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">ij</span></span></span></span></span></span>.</p>
<p>Finally, we use <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi mathvariant="normal">_</mi><mo>∙</mo></mrow><annotation encoding="application/x-tex">a\_\bullet</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.31em;height:0.7545em;"></span><span class="mord mathnormal">a</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span></span></span></span></span> to denote all of the elements
of some vector.
For example <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Hash</mtext><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mo>∙</mo></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Hash}(x\_{i\bullet})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord text"><span class="mord">H</span><span class="mord">a</span><span class="mord">s</span><span class="mord">h</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal">i</span><span class="mord">∙</span></span><span class="mclose">)</span></span></span></span></span> would hash an entire column
of a matrix.</p>
<p>Sometimes we also use this for arguments, e.g: <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">_</mi><mo>∙</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_i(x\_\bullet)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.31em;height:1.06em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-right:0.05em;margin-left:-0.1389em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mclose">)</span></span></span></span></span>
denotes several functions, each of which takes an entire vector,
whereas <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_i(x_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.2861em;height:1.0361em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-right:0.05em;top:-2.55em;margin-left:-0.1389em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-left:0em;margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> denotes several functions, parametrized over both <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span></span></span></span></span> (if these aren't already bound), each taking a single value,
rather than a vector.</p>
<p>If <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">_</mi><mo>∙</mo></mrow><annotation encoding="application/x-tex">x\_\bullet</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7545em;vertical-align:-0.31em;"></span><span class="mord mathnormal">x</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span></span></span></span></span> is in scope, we can of course write <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">x_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-left:0em;top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> to denote individual entries.</p>
<h2>Conventions</h2>
<p><span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.0822em;">P</span></span></span></span></span> or <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋆</mo></mrow><annotation encoding="application/x-tex">\star</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord">⋆</span></span></span></span></span> denotes all the parties, usually the set <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span></span>,
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span></span></span></span></span> is the set of honest parties, and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi></mrow><annotation encoding="application/x-tex">\mathcal{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal">M</span></span></span></span></span> the set of malicious parties.</p>
<p>We often use <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span> to range over honest parties, and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span></span></span></span></span> to range over malicious
parties.</p>
<h3>Games</h3>
<p>We also use <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊚</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \circledcirc B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7653em;vertical-align:-0.082em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin amsrm">⊚</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span></span></span></span></span> to denote <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>⊗</mo><mn>1</mn><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>∘</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">(A \otimes 1(B)) \circ B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span></span></span></span></span>,
i.e. <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span> lives alongside the game <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span></span></span></span></span>, but also reexports its functions.</p>
<h3>Misc</h3>
<p><span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> is the security parameter, <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span> the threshold needed to sign,
and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">01</mtext><mo>=</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\texttt{01} = \{0, 1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6111em;"></span><span class="mord text"><span class="mord texttt">01</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span></span>.</p>
<h1>Aborts</h1>
<p>We often assume an ambient abort functionality <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Stop</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F[\text{Stop}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">t</span><span class="mord">o</span><span class="mord">p</span></span><span class="mclose">]</span></span></span></span></span>.
The basic operation it provides is <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\texttt{stop}(S, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span><span class="mclose">)</span></span></span></span></span>,
which "stops" all parties in a given set <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span></span></span></span></span> after a round <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span></span></span></span></span>.
Each party can check whether or not it has stopped after a given
round via the functionality.</p>
<p>A convention we use is then via the notation <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">wait</mtext><mi mathvariant="normal">_</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\texttt{wait}\_{(i, w)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord text"><span class="mord texttt">wait</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span><span class="mclose">)</span></span></span></span></span></span>
this allows a party to wait for a condition, while also checking
that they're not supposed to stop at a given waitpoint <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span></span></span></span></span>.
If an honest party detects that, then they'll trigger
a stop themselves, via <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\texttt{stop}(\star, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span><span class="mclose">)</span></span></span></span></span>,
to cause others to abort, and then they'll "die".</p>
<p>When a game is "dead", it means that it responds to all function calls
with a dummy value indicating this fact.
Furthermore, if a game calls a function that returns "dead",
by convention, it will also then die.</p>
<p>The precise semantics of aborts aren't particularly important,
but we just need some way of having parties signalling that something
bad happened, and we want to be able to selectively trigger aborts
to aid in simulation.</p>
<h1>Synchronous Communication</h1>
<p>It's simpler to work in a synchronous communication model,
which assumes that message delivery happens immediately.
Also, this lets us focus on the ECDSA part of things, rather
than the sending messages aspect.</p>
<p>The two main modes of message sending we have in cait-sith
are sending a message to everybody, and sending a message privately.
We'll model these forms of communication using an ideal functionality
(which, in MPS, is just an asynchronous game).</p><div class="flex-initial">
$$
\boxed{
\normalsize{
\begin{aligned}
&\colorbox{#FBCFE8}{\large
  $F[\text{SyncComm}]$
}\cr
\cr
&\begin{aligned}
&m_{i \to j, w} \gets \bot\cr
\cr
&\underline{\Rsh_i(P, [m_j], w):}\cr
&\enspace \texttt{for } i \neq j \in P:\cr
&\quad \texttt{if } m_{i \to j, w} = \bot:\cr
&\quad\enspace m_{i \to j, w} \gets m_j\cr
\cr
&\underline{\Lsh_i(P, w):}\cr
&\enspace \texttt{wait}_{(i, w)} \forall i \neq j \in P.\ m_{j \to i, w} \neq \bot\cr
&\enspace \texttt{return } [m_{j \to i, w} \mid j \in P]\cr
\end{aligned}
\end{aligned}
}
}
$$
</div>
<div>
<p style="text-align: left">
$m_{i \to j, w}$ means that every pair of parties $i \neq j$ has an empty message slot
for every future waitpoint $w$, when $i$ wants to send a message to $j$.
</p>
<p style="text-align: left">
The $\Rsh_i$ function lets $i$ send a bunch of messages to different
parties in the set $P$ they provide.
</p>
<p style="text-align: left">
$\Lsh_i$ is the counterpart, allowing us to receive messages.
We request to receive from a set of parties $P$ at a given waitpoint, and then receive all those messages, once they're ready.
</p>
<p style="text-align: left">
Any party can immediately stop the protocol at will, by aborting.
</p>
<p style="text-align: left">
The adversary is also able to see which messages have been sent,
but not their contents.
The red color suggest that this function is for the adversary's
eyes only.
</p>
</div>
<blockquote>
<p>[!note] <strong>Note:</strong>
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i, j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span></span></span></span></span> come from the same bounded set, <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span></span>, the number of parties.
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span></span></span></span></span> is, in theory, coming from an unbounded set <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\mathbb{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">N</span></span></span></span></span>.
In practice this is shorthand for creating the appropriate message
slot <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi><mo separator="true">,</mo><mi>w</mi></mrow></msub></mrow><annotation encoding="application/x-tex">m_{i \to j, w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-left:0em;margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">→</span><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.0269em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> on demand, as soon as a given waitpoint <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span></span></span></span></span>
is actually used in <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>↰</mo><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\Lsh_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8422em;vertical-align:-0.15em;"></span><span class="mrel"><span class="mrel amsrm">↰</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-right:0.05em;margin-left:0em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> or <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>↱</mo><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\Rsh_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8422em;vertical-align:-0.15em;"></span><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-right:0.05em;margin-left:0em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.
This is just a technical detail which doesn't change the semantics.</p></blockquote>
<p>One common short hand we use is <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>↱</mo><mi>i</mi></msub><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mi>m</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Rsh_i(\star, m, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.15em;height:0.8422em;"></span><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span><span class="mclose">)</span></span></span></span></span>, shorthand for <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>↱</mo><mi>i</mi></msub><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mo stretchy="false">[</mo><mi>m</mi><mo separator="true">,</mo><mi>m</mi><mo separator="true">,</mo><mo>…</mo><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\Rsh_i([n], [m, m, \ldots], w)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord"><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="margin-left:0em;margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">([</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span><span class="mclose">)</span></span></span></span></span></span>,
indicating that the same message should be sent to all parties.
(The functionality for sending ignores )</p>
<p>For receiving, often honest parties will just receive from everyone,
with <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>↰</mo><mi>i</mi></msub><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\Lsh_i([n], w)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord"><span class="mrel"><span class="mrel amsrm">↰</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">([</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span><span class="mclose">)</span></span></span></span></span></span>.</p>
<p>Malicious parties, however, are free to send different
messages to different parties, even when the protocol specifies
that the party should be using <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>↱</mo><mi>i</mi></msub><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mo>…</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\Rsh_i(\star, \ldots)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord"><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mclose">)</span></span></span></span></span></span> instead,
so we need to allow the more general behavior.</p>
<p>Note that this functionality implicitly depends on <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Stop</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F[\text{Stop}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">t</span><span class="mord">o</span><span class="mord">p</span></span><span class="mclose">]</span></span></span></span></span>,
in that we use the notation <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="monospace">wait</mtext><mo stretchy="false">(</mo></msub><mi>i</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\texttt{wait}_(i, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.3552em;height:1.1052em;"></span><span class="mord"><span class="mord text"><span class="mord texttt">wait</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="margin-right:0.05em;top:-2.5198em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0269em;">w</span><span class="mclose">)</span></span></span></span></span>,
which will check if we need to stop ourselves while waiting for a message,
because of an abort.</p>
<h1>Functionalities</h1>
<p>Here are some additional useful ideal functionalities,
for random oracles, and for ZK proofs.</p>
<h2>Hashing</h2><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mstyle mathsize="0.9em"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mpadded height="+6pt" voffset="3pt" lspace="3pt" mathbackground="#FBCFE8" width="+6pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><mi>F</mi><mo stretchy="false">[</mo><mtext>Hash</mtext></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mi>h</mi><mo stretchy="false">[</mo><mo>∙</mo><mo stretchy="false">]</mo><mo>←</mo><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><mtext>Hash</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mi>x</mi><mi mathvariant="normal">∉</mi><mi>h</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mi>h</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mover><mo minsize="1.75em" stretchy="true">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi mathvariant="normal">$</mi></mpadded></mover><msup><mtext mathvariant="monospace">01</mtext><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mi>h</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $F[\text{Hash}$
}\cr
\cr
&amp;h[\bullet] \gets \bot\cr
\cr
&amp;\underline{
  \text{Hash}(x):
}\cr
  &amp;\enspace
    \texttt{if } x \notin h:
  \cr
  &amp;\enspace\enspace
    h[x] \xleftarrow{\$} \texttt{01}^{2 \lambda}
  \cr
  &amp;\enspace
    \texttt{return } h[x]
  \cr
\end{aligned}
}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-6.0124em;height:12.4748em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.4624em;"><span style="top:-14.4748em;"><span class="pstrut" style="height:14.4748em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.8027em;"><span style="top:-8.8027em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-7.0293em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-5.5293em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-4.0293em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-2.5293em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-0.9393em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:0.8427em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:2.3427em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.3027em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.8027em;"><span style="top:-8.8027em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3em;"><span style="top:-3.3em;"><span class="pstrut" style="height:3.9333em;"></span><span class="stretchy colorbox" style="height:1.9333em;background-color:#FBCFE8;"></span></span><span style="top:-3.9333em;"><span class="pstrut" style="height:3.9333em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.1389em;">F</span><span class="mopen sizing reset-size5 size7">[</span><span class="mord text sizing reset-size5 size7"><span class="mord">H</span><span class="mord">a</span><span class="mord">s</span><span class="mord">h</span></span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333em;"><span></span></span></span></span></span></span></span><span style="top:-5.5293em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord">∙</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:-2.5293em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">H</span><span class="mord">a</span><span class="mord">s</span><span class="mord">h</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:-0.9393em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:0.8427em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" preserveAspectRatio="xMinYMin slice" height="0.522em" viewBox="0 0 400000 522"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord texttt">01</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.876em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span style="top:2.3427em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.3027em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-8.4624em;"><span class="pstrut" style="height:14.4748em;"></span><span class="stretchy fbox" style="height:12.4748em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.0124em;"><span></span></span></span></span></span></span></span></span></span></span>
<h2>ZK</h2><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle displaystyle="false" scriptlevel="0"><mstyle displaystyle="false" scriptlevel="0"><mstyle displaystyle="true" scriptlevel="0"><mstyle mathsize="0.9em"><mtable columnalign="right left" columnspacing="0em" rowspacing="0.25em"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mpadded voffset="3pt" mathbackground="#FBCFE8" height="+6pt" width="+6pt" lspace="3pt"><mstyle mathsize="1.2em"><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi><mo stretchy="false">[</mo><mtext>ZK</mtext><mo stretchy="false">(</mo><mi>φ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mi mathvariant="normal">Π</mi><mo stretchy="false">[</mo><mo>∙</mo><mo stretchy="false">]</mo><mo>←</mo><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msub><mtext>Prove</mtext><mi>i</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">;</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">assert</mtext><mtext> </mtext></mrow><mi>x</mi><mo>⋅</mo><mi>G</mi><mo>=</mo><mi>X</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mi>π</mi><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi mathvariant="normal">$</mi></mpadded></mover><msup><mtext mathvariant="monospace">01</mtext><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi mathvariant="normal">Π</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">]</mo><mo>←</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mi>π</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><mtext>Verify</mtext><mo stretchy="false">(</mo><mi>π</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mi mathvariant="normal">Π</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">]</mo><mi mathvariant="normal">≠</mi><mi mathvariant="normal">⊥</mi><mo>∧</mo><mi mathvariant="normal">Π</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">]</mo><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $F[\text{ZK}(\varphi)]$
}\cr
\cr
&amp;\Pi[\bullet] \gets \bot\cr
\cr
&amp;\underline{
  \text{Prove}_i(X;x):
}\cr
  &amp;\enspace
    \texttt{assert } x \cdot G = X
  \cr
  &amp;\enspace
    \pi \xleftarrow{\$} \texttt{01}^{2\lambda}
  \cr
  &amp;\enspace
    \Pi[\pi] \gets x
  \cr
  &amp;\enspace
    \texttt{return } \pi
  \cr
\cr
&amp;\underline{
  \text{Verify}(\pi, x):
}\cr
  &amp;\enspace
    \texttt{return } \Pi[\pi] \neq \bot \land \Pi[\pi] = x
  \cr
\end{aligned}
}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:17.9558em;vertical-align:-8.7529em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.2029em;"><span style="top:-19.9558em;"><span class="pstrut" style="height:19.9558em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.8477em;"><span style="top:-11.8477em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-10.0743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-8.5743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-7.0743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-5.5743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-3.9843em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-2.2023em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-0.7023em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:0.7977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:2.2977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:3.7977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:5.3877em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.3477em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.8477em;"><span style="top:-11.8477em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3em;"><span style="top:-3.3em;"><span class="pstrut" style="height:3.9333em;"></span><span class="stretchy colorbox" style="height:1.9333em;background-color:#FBCFE8;"></span></span><span style="top:-3.9333em;"><span class="pstrut" style="height:3.9333em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.1389em;">F</span><span class="mopen sizing reset-size5 size7">[</span><span class="mord text sizing reset-size5 size7"><span class="mord">Z</span><span class="mord">K</span></span><span class="mopen sizing reset-size5 size7">(</span><span class="mord mathnormal sizing reset-size5 size7">φ</span><span class="mclose sizing reset-size5 size7">)]</span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333em;"><span></span></span></span></span></span></span></span><span style="top:-8.5743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Π</span><span class="mopen">[</span><span class="mord">∙</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:-5.5743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">o</span><span class="mord">v</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:-3.9843em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">assert </span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span></span></span><span style="top:-2.2023em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" viewBox="0 0 400000 522" height="0.522em" preserveAspectRatio="xMinYMin slice"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord texttt">01</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.876em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span style="top:-0.7023em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord">Π</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span></span></span><span style="top:0.7977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span></span></span><span style="top:3.7977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">V</span><span class="mord">e</span><span class="mord">r</span><span class="mord">i</span><span class="mord">f</span><span class="mord">y</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:5.3877em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord">Π</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Π</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.3477em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-11.2029em;"><span class="pstrut" style="height:19.9558em;"></span><span class="stretchy fbox" style="border-width:0.04em;height:17.9558em;border-style:solid;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.7529em;"><span></span></span></span></span></span></span></span></span></span></span><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mstyle mathsize="0.9em"><mtable columnalign="right left" columnspacing="0em" rowspacing="0.25em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mpadded lspace="3pt" voffset="3pt" height="+6pt" width="+6pt" mathbackground="#FBCFE8"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><mi>F</mi><mo stretchy="false">[</mo><mtext>ZK</mtext><mo stretchy="false">(</mo><mi>ψ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Π</mi><mo stretchy="false">[</mo><mo>∙</mo><mo stretchy="false">]</mo><mo>←</mo><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msub><mtext>Prove</mtext><mi>i</mi></msub><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo separator="true">;</mo><mi>a</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">assert</mtext><mtext> </mtext></mrow><mi>a</mi><mo>⋅</mo><mi>G</mi><mo>=</mo><mi>A</mi><mo>∧</mo><mi>a</mi><mo>⋅</mo><mi>B</mi><mo>=</mo><mi>C</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mi>π</mi><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi mathvariant="normal">$</mi></mpadded></mover><msup><mtext mathvariant="monospace">01</mtext><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mi mathvariant="normal">Π</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">]</mo><mo>←</mo><mi>a</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mi>π</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><mtext>Verify</mtext><mo stretchy="false">(</mo><mi>π</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mi mathvariant="normal">Π</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">]</mo><mi mathvariant="normal">≠</mi><mi mathvariant="normal">⊥</mi><mo>∧</mo><mi mathvariant="normal">Π</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">]</mo><mo>=</mo><mi>a</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $F[\text{ZK}(\psi)]$
}\cr
\cr
&amp;\Pi[\bullet] \gets \bot\cr
\cr
&amp;\underline{
  \text{Prove}_i(A, B, C; a):
}\cr
  &amp;\enspace
    \texttt{assert } a \cdot G = A \land a \cdot B = C
  \cr
  &amp;\enspace
    \pi \xleftarrow{\$} \texttt{01}^{2\lambda}
  \cr
  &amp;\enspace
    \Pi[\pi] \gets a
  \cr
  &amp;\enspace
    \texttt{return } \pi
  \cr
\cr
&amp;\underline{
  \text{Verify}(\pi, a):
}\cr
  &amp;\enspace
    \texttt{return } \Pi[\pi] \neq \bot \land \Pi[\pi] = a
  \cr
\end{aligned}
}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:17.9558em;vertical-align:-8.7529em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.2029em;"><span style="top:-19.9558em;"><span class="pstrut" style="height:19.9558em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.8477em;"><span style="top:-11.8477em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-10.0743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-8.5743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-7.0743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-5.5743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-3.9843em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-2.2023em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-0.7023em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:0.7977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:2.2977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:3.7977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:5.3877em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.3477em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.8477em;"><span style="top:-11.8477em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3em;"><span style="top:-3.3em;"><span class="pstrut" style="height:3.9333em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.9333em;"></span></span><span style="top:-3.9333em;"><span class="pstrut" style="height:3.9333em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.1389em;">F</span><span class="mopen sizing reset-size5 size7">[</span><span class="mord text sizing reset-size5 size7"><span class="mord">Z</span><span class="mord">K</span></span><span class="mopen sizing reset-size5 size7">(</span><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.0359em;">ψ</span><span class="mclose sizing reset-size5 size7">)]</span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333em;"><span></span></span></span></span></span></span></span><span style="top:-8.5743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Π</span><span class="mopen">[</span><span class="mord">∙</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:-5.5743em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">o</span><span class="mord">v</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">C</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:-3.9843em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">assert </span></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">C</span></span></span><span style="top:-2.2023em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice" width="400em" height="0.522em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord texttt">01</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.876em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span style="top:-0.7023em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord">Π</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">a</span></span></span><span style="top:0.7977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span></span></span><span style="top:3.7977em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">V</span><span class="mord">e</span><span class="mord">r</span><span class="mord">i</span><span class="mord">f</span><span class="mord">y</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:5.3877em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord">Π</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Π</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0359em;">π</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.3477em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-11.2029em;"><span class="pstrut" style="height:19.9558em;"></span><span class="stretchy fbox" style="border-width:0.04em;height:17.9558em;border-style:solid;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.7529em;"><span></span></span></span></span></span></span></span></span></span></span><section class="footnotes">
<ol>
</ol>
</section>


</body>
</html>