<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>cronokirby - Cait-Sith Security (4): Signing</title>
<meta name="description" content="For the sake of simplicity, we use a simpler key generation and triple protocol as ideal functionalities, to isolate the analysis of our presignature and signat">
<meta name="google-site-verification" content="L52nFdg1z0h1iXWgwFjYNRl14XgaybiiL_UbPpm6-Mc" />
<link rel="canonical" href="https://cronokirby.com/Notes/Cait-Sith-Security-4-Signing.html">
<meta property="og:title" content="Cait-Sith Security (4): Signing">
<meta property="og:description" content="For the sake of simplicity, we use a simpler key generation and triple protocol as ideal functionalities, to isolate the analysis of our presignature and signat">
<meta property="og:url" content="https://cronokirby.com/Notes/Cait-Sith-Security-4-Signing.html">
<meta property="og:site_name" content="cronokirby">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cait-Sith Security (4): Signing">
<meta name="twitter:description" content="For the sake of simplicity, we use a simpler key generation and triple protocol as ideal functionalities, to isolate the analysis of our presignature and signat">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css" integrity="sha384-Pu5+C18nP5dwykLJOhd2U4Xen7rjScHN/qusop27hdd2drI+lL5KvX7YntvT8yew" crossorigin="anonymous">

<link rel="stylesheet" href="/static/index.css">
<link rel="icon" href="/static/icon.png">
<script src="/static/theme.js" defer></script>
</head>
<body>
<header>
<div class="icon-bar">
  <a href="/">
    <img src="/static/icon.png" class="avatar" alt="cronokirby" />
  </a>
  <button class="theme-toggle" id="theme-toggle">
    <svg xmlns="http://www.w3.org/2000/svg" height="2em" viewBox="0 -960 960 960" width="2em" fill="currentColor"><path d="M480-120q-133 0-226.5-92.5T160-436q0-66 25-122t69-100l226-222 226 222q44 44 69 100t25 122q0 131-93.5 223.5T480-120Zm0-80v-568L310-600q-35 33-52.5 74.5T240-436q0 97 70 166.5T480-200Z"/></svg>
  </button>
</div>
<time datetime="2023-04-16">2023-04-16</time>

<h1>Cait-Sith Security (4): Signing</h1>




</header>

<p>For the sake of simplicity, we use a simpler key generation
and triple protocol as ideal functionalities,
to isolate the analysis of our presignature and signature protocols.</p>
<h1>Presigning</h1>
<p><strong>Definition (Presignatures):</strong></p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle displaystyle="false" scriptlevel="0"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="true"><mtable columnalign="center" rowspacing="0.16em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" voffset="3pt" mathbackground="#FBCFE8" height="+6pt" lspace="3pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>Presign</mtext><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><menclose notation="box"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mstyle mathsize="0.9em"><mtable columnspacing="0em" rowspacing="0.25em" columnalign="right left"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mpadded lspace="3pt" height="+6pt" mathbackground="#FBCFE8" voffset="3pt" width="+6pt"><mstyle mathsize="1.2em"><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mi>i</mi></msub></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><msubsup><mtext>Presign</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo><mo>←</mo><msubsup><mtext>Triple</mtext><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mtext>kd</mtext><mi>i</mi></msub><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>D</mi><mo separator="true">,</mo><mtext>KD</mtext><mo stretchy="false">)</mo><mo>←</mo><msubsup><mtext>Triple</mtext><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mo>↱</mo><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">(</mo><mi mathvariant="script">P</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mtext>kd</mtext><mi>i</mi></msub><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mo>↱</mo><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">(</mo><mi mathvariant="script">P</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mo>↱</mo><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">(</mo><mi mathvariant="script">P</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mtext>kd</mtext><mi mathvariant="normal">_</mi><mo>∙</mo><msubsup><mo>↰</mo><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mtext>ka</mtext><mi mathvariant="normal">_</mi><mo>∙</mo><msubsup><mo>↰</mo><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mtext>xb</mtext><mi mathvariant="normal">_</mi><mo>∙</mo><msubsup><mo>↰</mo><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mtext>kd</mtext><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mtext>kd</mtext><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mtext>kd</mtext><mo>⋅</mo><mi>G</mi><mi mathvariant="normal">≠</mi><mtext>KD</mtext><mo>:</mo><mspace width="0.5em"/><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mtext>ka</mtext><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mtext>ka</mtext><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mtext>ka</mtext><mo>⋅</mo><mi>G</mi><mi mathvariant="normal">≠</mi><mi>K</mi><mo>+</mo><mi>A</mi><mo>:</mo><mspace width="0.5em"/><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mtext>xb</mtext><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mtext>xb</mtext><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mtext>xb</mtext><mo>⋅</mo><mi>G</mi><mi mathvariant="normal">≠</mi><mi>X</mi><mo>+</mo><mi>B</mi><mo>:</mo><mspace width="0.5em"/><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>R</mi><mo>←</mo><mfrac><mn>1</mn><mtext>kd</mtext></mfrac><mo>⋅</mo><mi>D</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>σ</mi><mi>i</mi></msub><mo>←</mo><mtext>ka</mtext><mo>⋅</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mtext>xb</mtext><mo>⋅</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>R</mi><mo separator="true">,</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>σ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose><mspace width="1em"/><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mstyle mathsize="0.9em"><mtable columnspacing="0em" rowspacing="0.25em" columnalign="right left"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mpadded height="+6pt" width="+6pt" voffset="3pt" lspace="3pt" mathbackground="#FBCFE8"><mstyle mathsize="1.2em"><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi><mo stretchy="false">[</mo><mtext>Setup</mtext><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mi>f</mi><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi mathvariant="normal">$</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><mi mathvariant="normal">_</mi><mrow><mo>≤</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><msub><mtext>Key</mtext><mi>i</mi></msub><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>G</mi><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⊗</mo></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mstyle mathsize="0.9em"><mtable columnspacing="0em" columnalign="right left" rowspacing="0.25em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mpadded voffset="3pt" mathbackground="#FBCFE8" width="+6pt" height="+6pt" lspace="3pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><mi>F</mi><mo stretchy="false">[</mo><mtext>Triple</mtext><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><msup><mi>f</mi><mrow><mi>A</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo separator="true">,</mo><msup><mi>f</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi mathvariant="normal">$</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><mi mathvariant="normal">_</mi><mrow><mo>≤</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><msup><mi>f</mi><mrow><mi>C</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded lspace="0.3em" width="+0.6em"><mi mathvariant="normal">$</mi></mpadded></mover><mo stretchy="false">{</mo><mi>f</mi><mo>∈</mo><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><mi mathvariant="normal">_</mi><mrow><mo>≤</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo>∣</mo><mi>f</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><msup><mi>f</mi><mrow><mi>A</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><msup><mi>f</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mtext>Triple</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>←</mo><mo stretchy="false">(</mo><msup><mi>f</mi><mrow><mi>A</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>f</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>f</mi><mrow><mi>C</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo><mo>←</mo><mo stretchy="false">(</mo><msup><mi>f</mi><mrow><mi>A</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>G</mi><mo separator="true">,</mo><msup><mi>f</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>G</mi><mo separator="true">,</mo><msup><mi>f</mi><mrow><mi>C</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>G</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mo lspace="0em" rspace="0em">⊗</mo></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Triple</mtext><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo rspace="0em" lspace="0em">⊗</mo></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>SyncComm</mtext><msup><mo stretchy="false">]</mo><mi mathvariant="double-struck">N</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mo lspace="0em" rspace="0em">⊚</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Stop</mtext><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Leakage</mtext><mo>:</mo><mo>=</mo><mo stretchy="false">{</mo><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\begin{matrix}
\colorbox{FBCFE8}{\large
  $\mathscr{P}[\text{Presign}]$
}\cr
\cr
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $P_i$
}\cr
\cr
&amp;\underline{
  (1)\text{Presign}_i^\tau():
}\cr
  &amp;\enspace
    (a_i, b_i, c_i, A, B, C) \gets \text{Triple}_i^{(\tau, 0)}()
  \cr
  &amp;\enspace
    (k_i, d_i, \text{kd}_i, K, D, \text{KD}) \gets \text{Triple}_i^{(\tau, 1)}()
  \cr
  &amp;\enspace
    \Rsh^\tau_i(\star, \lambda(\mathcal{P}) \cdot \text{kd}_i, 1)
  \cr
  &amp;\enspace
    \Rsh^\tau_i(\star, \lambda(\mathcal{P}) \cdot (k_i + a_i), 2)
  \cr
  &amp;\enspace
    \Rsh^\tau_i(\star, \lambda(\mathcal{P}) \cdot (x_i + b_i), 3)
  \cr
  &amp;\enspace\cr
  &amp;\enspace
    \text{kd}\_\bullet \Lsh^\tau_i(\star, 1)
  \cr
  &amp;\enspace
    \text{ka}\_\bullet \Lsh^\tau_i(\star, 2)
  \cr
  &amp;\enspace
    \text{xb}\_\bullet \Lsh^\tau_i(\star, 3)
  \cr
  &amp;\enspace
    \text{kd} \gets \sum_j \text{kd}_j
  \cr
  &amp;\enspace
    \texttt{if } \text{kd} \cdot G \neq \text{KD}:\enspace\texttt{stop}(\star, 1)
  \cr
  &amp;\enspace
    \text{ka} \gets \sum_j \text{ka}_j
  \cr
  &amp;\enspace
    \texttt{if } \text{ka} \cdot G \neq K + A:\enspace\texttt{stop}(\star, 2)
  \cr
  &amp;\enspace
    \text{xb} \gets \sum_j \text{xb}_j
  \cr
  &amp;\enspace
    \texttt{if } \text{xb} \cdot G \neq X + B:\enspace\texttt{stop}(\star, 3)
  \cr
  &amp;\enspace\cr
  &amp;\enspace
    R \gets \frac{1}{\text{kd}} \cdot D
  \cr
  &amp;\enspace
    \sigma_i \gets \text{ka} \cdot x_i - \text{xb} \cdot a_i + c_i
  \cr
  &amp;\enspace
    \texttt{return } (X, x_i, R, k_i, \sigma_i)
  \cr
\end{aligned}
}
}
\quad
\begin{matrix}
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $F[\text{Setup}]$
}\cr
\cr
&amp;f \xleftarrow{\$} \mathbb{F}_q[X]\_{\leq t - 1}\cr
\cr
&amp;\underline{
  \text{Key}_i():
}\cr
  &amp;\enspace
    \texttt{return } (f(0) \cdot G, f(i))
  \cr
\end{aligned}
}
}\cr
\otimes\cr
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $F[\text{Triple}]$
}\cr
\cr
&amp;f^{A, \tau}, f^{B, \tau} \xleftarrow{\$} \mathbb{F}_q[X]\_{\leq t - 1}\cr
&amp;f^{C, \tau} \xleftarrow{\$} \{ f \in \mathbb{F}_q[X]\_{\leq t - 1} \mid f(0) = f^{A, \tau}(0) \cdot f^{B, \tau} \}
\cr
\cr
&amp;\underline{
  \text{Triple}_i^\tau():
}\cr
  &amp;\enspace
    (a_i, b_i, c_i) \gets
    (f^{A, \tau}(i), f^{B, \tau}(i), f^{C, \tau}(i))
  \cr
  &amp;\enspace
    (A, B, C) \gets (f^{A, \tau}(0) \cdot G, f^{B, \tau}(0) \cdot G, f^{C, \tau}(0) \cdot G)
  \cr
  &amp;\enspace
    \texttt{return } (a_i, b_i, c_i, A, B, C)
  \cr
\end{aligned}
}
}\cr
\otimes\cr
F[\text{Triple}]\cr
\otimes\cr
F[\text{SyncComm}]^{\mathbb{N}}\cr
\circledcirc \cr
F[\text{Stop}]
\end{matrix}\cr
\cr
\text{Leakage} := \{\texttt{stop}\}
\end{matrix}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:41.3817em;vertical-align:-20.4408em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:20.9408em;"><span style="top:-43.3817em;"><span class="pstrut" style="height:43.3817em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:20.6008em;"><span style="top:-39.2767em;"><span class="pstrut" style="height:19.8758em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2em;"><span style="top:-3.2em;"><span class="pstrut" style="height:3.8em;"></span><span class="stretchy colorbox" style="height:1.8em;background-color:#FBCFE8;"></span></span><span style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord boxpad"><span class="mord mathscr sizing reset-size6 size7" style="margin-right:0.0808em;">P</span><span class="mopen sizing reset-size6 size7">[</span><span class="mord text sizing reset-size6 size7"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose sizing reset-size6 size7">]</span><span class="mord sizing reset-size6 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6em;"><span></span></span></span></span></span></span></span><span style="top:-37.8367em;"><span class="pstrut" style="height:19.8758em;"></span><span class="mord"></span></span><span style="top:-19.6008em;"><span class="pstrut" style="height:19.8758em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:17.8758em;"><span style="top:-37.3017em;"><span class="pstrut" style="height:37.3017em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:19.4843em;"><span style="top:-21.5946em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-19.9546em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-18.4546em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-16.682em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-15.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-13.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-12.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-10.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-9.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-7.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-6.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-4.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-2.8006em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-0.2752em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:1.4348em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:3.9601em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:5.6701em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:8.1954em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:9.6954em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:11.6768em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:13.5028em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:15.0028em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:18.9843em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:19.4843em;"><span style="top:-21.5946em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2111em;"><span style="top:-3.2111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="stretchy colorbox" style="height:1.7111em;background-color:#FBCFE8;"></span></span><span style="top:-3.7111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="mord boxpad"><span class="mord sizing reset-size5 size7"><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.1389em;margin-right:0.0417em;top:-2.65em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span><span style="top:-18.4546em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:-16.682em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">T</span><span class="mord">r</span><span class="mord">i</span><span class="mord">p</span><span class="mord">l</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0115em;"><span style="margin-right:0.0556em;top:-2.3451em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1115em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2549em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:-15.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:-0.0315em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;margin-left:0em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0278em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">K</span><span class="mord">D</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">T</span><span class="mord">r</span><span class="mord">i</span><span class="mord">p</span><span class="mord">l</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0115em;"><span style="top:-2.3451em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1115em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2549em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:-13.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.0822em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-12.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;margin-left:0em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.0822em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:-0.0315em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span><span style="top:-10.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.0822em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span><span style="top:-9.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span></span></span><span style="top:-7.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel amsrm">↰</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-6.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel amsrm">↰</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span><span style="top:-4.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel amsrm">↰</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:0em;top:-2.353em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span><span style="top:-2.8006em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8943em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.2752em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">K</span><span class="mord">D</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:1.4348em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8943em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:3.9601em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="vertical-align:-0.1944em;height:0.8889em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span><span style="top:5.6701em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8943em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:8.1954em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="vertical-align:-0.1944em;height:0.8889em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span><span style="top:9.6954em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span></span></span><span style="top:11.6768em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter sizing reset-size5 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size5 size6"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0278em;">D</span></span></span><span style="top:13.5028em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:-0.0359em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:15.0028em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;margin-left:-0.0315em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:-0.0359em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:18.9843em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-19.8758em;"><span class="pstrut" style="height:37.3017em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:35.3017em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:17.4258em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:16.415em;"><span style="top:-20.5926em;"><span class="pstrut" style="height:9.295em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.1174em;"><span style="top:-11.7848em;"><span class="pstrut" style="height:11.7848em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.3082em;"><span style="top:-7.3082em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-5.5349em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-3.7529em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-2.2529em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-0.7529em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:0.8482em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.8082em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.3082em;"><span style="top:-7.3082em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3em;"><span style="top:-3.3em;"><span class="pstrut" style="height:3.9333em;"></span><span class="stretchy colorbox" style="height:1.9333em;background-color:#FBCFE8;"></span></span><span style="top:-3.9333em;"><span class="pstrut" style="height:3.9333em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.1389em;">F</span><span class="mopen sizing reset-size5 size7">[</span><span class="mord text sizing reset-size5 size7"><span class="mord">S</span><span class="mord">e</span><span class="mord">t</span><span class="mord">u</span><span class="mord">p</span></span><span class="mclose sizing reset-size5 size7">]</span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333em;"><span></span></span></span></span></span></span></span><span style="top:-3.7529em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin slice" height="0.522em" width="400em" viewBox="0 0 400000 522"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mclose">]</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span style="top:-0.7529em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">e</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="margin-right:0.0556em;top:-2.3389em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:0.8482em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.8082em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-7.1174em;"><span class="pstrut" style="height:11.7848em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:9.7848em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.6674em;"><span></span></span></span></span></span></span></span><span style="top:-15.0852em;"><span class="pstrut" style="height:9.295em;"></span><span class="mord"><span class="mord">⊗</span></span></span><span style="top:-7.4302em;"><span class="pstrut" style="height:9.295em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.295em;"><span style="top:-16.14em;"><span class="pstrut" style="height:16.14em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.7278em;"><span style="top:-9.7278em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-7.9544em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-6.1724em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-4.3904em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-2.8904em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-1.3904em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:0.2392em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:1.7678em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:3.2678em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:7.2278em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.7278em;"><span style="top:-9.7278em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3em;"><span style="top:-3.3em;"><span class="pstrut" style="height:3.9333em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.9333em;"></span></span><span style="top:-3.9333em;"><span class="pstrut" style="height:3.9333em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.1389em;">F</span><span class="mopen sizing reset-size5 size7">[</span><span class="mord text sizing reset-size5 size7"><span class="mord">T</span><span class="mord">r</span><span class="mord">i</span><span class="mord">p</span><span class="mord">l</span><span class="mord">e</span></span><span class="mclose sizing reset-size5 size7">]</span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333em;"><span></span></span></span></span></span></span></span><span style="top:-6.1724em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0502em;">B</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice" height="0.522em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="margin-right:0.0556em;margin-left:0em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mclose">]</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span style="top:-4.3904em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0715em;">C</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin slice" width="400em" viewBox="0 0 400000 522" height="0.522em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mclose">]</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0502em;">B</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span><span style="top:-1.3904em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">T</span><span class="mord">r</span><span class="mord">i</span><span class="mord">p</span><span class="mord">l</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.3389em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:0.2392em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;margin-left:0em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0502em;">B</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0715em;">C</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">))</span></span></span><span style="top:1.7678em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0502em;">B</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0715em;">C</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span><span style="top:3.2678em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;margin-left:0em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">C</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:7.2278em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-9.295em;"><span class="pstrut" style="height:16.14em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:14.14em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.845em;"><span></span></span></span></span></span></span></span><span style="top:0.2548em;"><span class="pstrut" style="height:9.295em;"></span><span class="mord"><span class="mord">⊗</span></span></span><span style="top:1.4548em;"><span class="pstrut" style="height:9.295em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">T</span><span class="mord">r</span><span class="mord">i</span><span class="mord">p</span><span class="mord">l</span><span class="mord">e</span></span><span class="mclose">]</span></span></span><span style="top:2.6548em;"><span class="pstrut" style="height:9.295em;"></span><span class="mord"><span class="mord">⊗</span></span></span><span style="top:3.86em;"><span class="pstrut" style="height:9.295em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span><span class="mord">C</span><span class="mord">o</span><span class="mord">m</span><span class="mord">m</span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8452em;"><span style="margin-right:0.05em;top:-3.063em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbb mtight">N</span></span></span></span></span></span></span></span></span></span></span><span style="top:5.06em;"><span class="pstrut" style="height:9.295em;"></span><span class="mord"><span class="mord amsrm">⊚</span></span></span><span style="top:6.26em;"><span class="pstrut" style="height:9.295em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">t</span><span class="mord">o</span><span class="mord">p</span></span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:15.915em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.335em;"><span class="pstrut" style="height:19.8758em;"></span><span class="mord"></span></span><span style="top:-0.135em;"><span class="pstrut" style="height:19.8758em;"></span><span class="mord"><span class="mord text"><span class="mord">L</span><span class="mord">e</span><span class="mord">a</span><span class="mord">k</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mclose">}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:20.1008em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-22.9408em;"><span class="pstrut" style="height:43.3817em;"></span><span class="stretchy fbox" style="height:41.3817em;border-width:0.04em;border-style:solid;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:20.4408em;"><span></span></span></span></span></span></span></span></span></span></span>
<p><span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">□</mi></mrow><annotation encoding="application/x-tex">\square</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em;"></span><span class="mord amsrm">□</span></span></span></span></span></p>
<p>The functionalities we use here are perfect, in essence.
The idea behind the presignature functionality
is relatively simple.
One triple is used to help multiply <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span></span></span></span></span> and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>,
and the other contains <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span></span></span></span></span> itself, which we use to help invert <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span></span></span></span></span>
for the signature formula.</p>
<p>For convenience, we make it so that the presignature gives us <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span></span></span></span></span> and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span> (secret shared).</p>
<p>Another convention is that the same key <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span> is used for an arbitrary
number of signatures, hence <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\mathbb{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">N</span></span></span></span></span> instances.
We use <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span></span> as index to denote this instances.</p>
<p><strong>Definition (Ideal Presignatures):</strong></p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mtable columnalign="center" columnspacing="1em" rowspacing="0.16em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded mathbackground="#FBCFE8" voffset="3pt" height="+6pt" width="+6pt" lspace="3pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>IdealPresign</mtext><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><menclose notation="box"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mstyle mathsize="0.9em"><mtable rowspacing="0.25em" columnspacing="0em" columnalign="right left"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mpadded height="+6pt" lspace="3pt" voffset="3pt" width="+6pt" mathbackground="#FBCFE8"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><msub><mi>P</mi><mi>i</mi></msub></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><msubsup><mtext>Presign</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mtext>Sync</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mtext>WaitSync</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><msubsup><mtext>Presign</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose><mspace width="1em"/><mtable columnspacing="1em" columnalign="center" rowspacing="0.16em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mstyle mathsize="0.9em"><mtable columnspacing="0em" columnalign="right left" rowspacing="0.25em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mpadded voffset="3pt" width="+6pt" lspace="3pt" height="+6pt" mathbackground="#FBCFE8"><mstyle mathsize="1.2em"><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi><mo stretchy="false">[</mo><mtext>Presign</mtext><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>f</mi><mi>X</mi></msup><mo separator="true">,</mo><msup><mi>f</mi><mrow><mi>K</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo separator="true">,</mo><mover><mo minsize="1.75em" stretchy="true">←</mo><mpadded lspace="0.3em" width="+0.6em"><mi mathvariant="normal">$</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><mi mathvariant="normal">_</mi><mrow><mo>≤</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>f</mi><mrow><mi mathvariant="normal">Σ</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo separator="true">,</mo><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi mathvariant="normal">$</mi></mpadded></mover><mo stretchy="false">{</mo><mi>f</mi><mo>∈</mo><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><mi mathvariant="normal">_</mi><mrow><mo>≤</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo>∣</mo><mi>f</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mtext>Presign</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>X</mi><mo>←</mo><msup><mi>f</mi><mi>X</mi></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>x</mi><mi>i</mi></msub><mo>←</mo><msup><mi>f</mi><mi>X</mi></msup><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>R</mi><mo>←</mo><mfrac><mn>1</mn><mrow><msup><mi>f</mi><mrow><mi>K</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mfrac><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>k</mi><mi>i</mi></msub><mo>←</mo><msup><mi>f</mi><mrow><mi>K</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>σ</mi><mi>i</mi></msub><mo>←</mo><msup><mi>f</mi><mi>X</mi></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><msup><mi>f</mi><mrow><mi>K</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><msup><mi>f</mi><mrow><mi mathvariant="normal">Σ</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>R</mi><mo separator="true">,</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>σ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><msup><mtext>K</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><msup><mi>f</mi><mrow><mi>K</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msup><mtext>XK</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><msup><mi>f</mi><mi>X</mi></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><msup><mi>f</mi><mrow><mi>K</mi><mo separator="true">,</mo><mi>τ</mi></mrow></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mo lspace="0em" rspace="0em">⊗</mo></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Sync</mtext><msup><mo stretchy="false">]</mo><mi mathvariant="double-struck">N</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mo rspace="0em" lspace="0em">⊚</mo></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Stop</mtext><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Leakage</mtext><mo>:</mo><mo>=</mo><mo stretchy="false">{</mo><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\begin{matrix}
\colorbox{FBCFE8}{\large
  $\mathscr{P}[\text{IdealPresign}]$
}\cr
\cr
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $P_i$
}\cr
\cr
&amp;\underline{
  (1)\text{Presign}_i^\tau():
}\cr
  &amp;\enspace
    \text{Sync}^{\tau}_i(\star, 0)
  \cr
  &amp;\enspace
    \text{WaitSync}^\tau_i(\star, 0)
  \cr
  &amp;\enspace
    \texttt{return } \text{Presign}_i^\tau()
  \cr
\end{aligned}
}
}
\quad
\begin{matrix}
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $F[\text{Presign}]$
}\cr
\cr
&amp;f^X, f^{K, \tau}, \xleftarrow{\$} \mathbb{F}_q[X]\_{\leq t - 1}\cr
&amp;f^{\Sigma, \tau}, \xleftarrow{\$} \{ f \in \mathbb{F}_q[X]\_{\leq t - 1} \mid f(0) = 0 \}\cr
\cr
&amp;\underline{
  \text{Presign}_i^\tau():
}\cr
  &amp;\enspace
    X \gets f^X(0) \cdot G
  \cr
  &amp;\enspace
    x_i \gets f^X(i)
  \cr
  &amp;\enspace
    R \gets \frac{1}{f^{K, \tau}(0)} \cdot G
  \cr
  &amp;\enspace
    k_i \gets f^{K, \tau}(i)
  \cr
  &amp;\enspace
    \sigma_i \gets f^X(0) \cdot f^{K, \tau}(0) + f^{\Sigma, \tau}(i)
  \cr
  &amp;\enspace
    \texttt{return } (X, x_i, R, k_i, \sigma_i)
  \cr
\cr
&amp;\underline{
  \text{K}^\tau():
}\cr
  &amp;\enspace
    \texttt{return } f^{K, \tau}(0) \cdot G
  \cr
&amp;\underline{
  \text{XK}^\tau():
}\cr
  &amp;\enspace
    \texttt{return } f^{X}(0) \cdot f^{K, \tau}(0) \cdot G
  \cr
\end{aligned}
}
}\cr
\otimes\cr
F[\text{Sync}]^{\mathbb{N}}\cr
\circledcirc \cr
F[\text{Stop}]
\end{matrix}\cr
\cr
\text{Leakage} := \{\texttt{stop}\}
\end{matrix}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-18.2709em;height:37.0417em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:18.7709em;"><span style="top:-39.0417em;"><span class="pstrut" style="height:39.0417em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:18.4309em;"><span style="top:-34.9617em;"><span class="pstrut" style="height:17.7309em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2em;"><span style="top:-3.2em;"><span class="pstrut" style="height:3.8em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.8em;"></span></span><span style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord boxpad"><span class="mord mathscr sizing reset-size6 size7" style="margin-right:0.0808em;">P</span><span class="mopen sizing reset-size6 size7">[</span><span class="mord text sizing reset-size6 size7"><span class="mord">I</span><span class="mord">d</span><span class="mord">e</span><span class="mord">a</span><span class="mord">l</span><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose sizing reset-size6 size7">]</span><span class="mord sizing reset-size6 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6em;"><span></span></span></span></span></span></span></span><span style="top:-33.5217em;"><span class="pstrut" style="height:17.7309em;"></span><span class="mord"></span></span><span style="top:-17.4309em;"><span class="pstrut" style="height:17.7309em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.8905em;"><span style="top:-11.331em;"><span class="pstrut" style="height:11.331em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.0561em;"><span style="top:-7.0561em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-5.4161em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-3.9161em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-2.315em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-0.815em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:0.685em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.5561em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.0561em;"><span style="top:-7.0561em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2111em;"><span style="top:-3.2111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="stretchy colorbox" style="height:1.7111em;background-color:#FBCFE8;"></span></span><span style="top:-3.7111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="mord boxpad"><span class="mord sizing reset-size5 size7"><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.65em;margin-left:-0.1389em;margin-right:0.0417em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span><span style="top:-3.9161em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:-2.315em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.3389em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-0.815em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">W</span><span class="mord">a</span><span class="mord">i</span><span class="mord">t</span><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:0.685em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.5561em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-6.8905em;"><span class="pstrut" style="height:11.331em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:9.331em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4405em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:15.7309em;"><span style="top:-17.7309em;"><span class="pstrut" style="height:15.3032em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:13.3032em;"><span style="top:-28.1565em;"><span class="pstrut" style="height:28.1565em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:14.4036em;"><span style="top:-16.425em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-14.6517em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-12.8697em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-11.0877em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-9.5877em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-8.0877em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-6.458em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-4.9295em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-2.9481em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-0.8435em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:0.6851em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:2.1851em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:3.6851em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:5.1851em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:6.8036em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:8.3036em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:9.9222em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:13.9036em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:14.4036em;"><span style="top:-16.425em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3em;"><span style="top:-3.3em;"><span class="pstrut" style="height:3.9333em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.9333em;"></span></span><span style="top:-3.9333em;"><span class="pstrut" style="height:3.9333em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.1389em;">F</span><span class="mopen sizing reset-size5 size7">[</span><span class="mord text sizing reset-size5 size7"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose sizing reset-size5 size7">]</span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333em;"><span></span></span></span></span></span></span></span><span style="top:-12.8697em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0785em;">X</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0715em;">K</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="margin-left:0em;top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mclose">]</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span style="top:-11.0877em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">Σ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice" height="0.522em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mclose">]</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span><span class="mclose">}</span></span></span><span style="top:-8.0877em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.3389em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:-6.458em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0785em;">X</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-4.9295em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0785em;">X</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span><span style="top:-2.9481em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter sizing reset-size5 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7446em;"><span style="top:-2.889em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0715em;">K</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size5 size6"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-0.8435em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.0315em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0715em;">K</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span><span style="top:0.6851em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:-0.0359em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0785em;">X</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0715em;">K</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">Σ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span><span style="top:2.1851em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;margin-left:-0.0315em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.0359em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:5.1851em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:6.8036em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0715em;">K</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:8.3036em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">X</span><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:9.9222em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0785em;">X</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1076em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8686em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0715em;">K</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:13.9036em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-15.3032em;"><span class="pstrut" style="height:28.1565em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:26.1565em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:12.8532em;"><span></span></span></span></span></span></span></span><span style="top:-4.0376em;"><span class="pstrut" style="height:15.3032em;"></span><span class="mord"><span class="mord">⊗</span></span></span><span style="top:-2.8324em;"><span class="pstrut" style="height:15.3032em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8452em;"><span style="margin-right:0.05em;top:-3.063em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbb mtight">N</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.6324em;"><span class="pstrut" style="height:15.3032em;"></span><span class="mord"><span class="mord amsrm">⊚</span></span></span><span style="top:-0.4324em;"><span class="pstrut" style="height:15.3032em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">t</span><span class="mord">o</span><span class="mord">p</span></span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:15.2309em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.36em;"><span class="pstrut" style="height:17.7309em;"></span><span class="mord"></span></span><span style="top:-0.16em;"><span class="pstrut" style="height:17.7309em;"></span><span class="mord"><span class="mord text"><span class="mord">L</span><span class="mord">e</span><span class="mord">a</span><span class="mord">k</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mclose">}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:17.9309em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-20.7709em;"><span class="pstrut" style="height:39.0417em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:37.0417em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:18.2709em;"><span></span></span></span></span></span></span></span></span></span></span>
<p><span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">□</mi></mrow><annotation encoding="application/x-tex">\square</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em;"></span><span class="mord amsrm">□</span></span></span></span></span></p>
<p>The ideal functionality basically spits out presignatures at will,
all under the same key.
We also get access to <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>⋅</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">k \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span> and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>x</mi><mo>⋅</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">kx \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span>, in addition to <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">k^{-1} \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="margin-right:0.05em;top:-3.063em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span>.
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>x</mi><mo>⋅</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">kx \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span> is actually something you learn from a signature anyhow,
once it's completed.</p>
<p><strong>Lemma:</strong>
For a negligible <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span>, and up to <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.0833em;height:0.6984em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span> malicious corruptions, we have:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>Presign</mtext><mo stretchy="false">]</mo><mo><mover><mo><mo>⇝</mo></mo><mi>ϵ</mi></mover></mo><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>IdealPresign</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathscr{P}[\text{Presign}] \overset{\epsilon}{\leadsto} \mathscr{P}[\text{IdealPresign}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2293em;vertical-align:-0.25em;"></span><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9793em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop amsrm">⇝</span></span></span><span style="margin-left:0em;top:-3.5779em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">I</span><span class="mord">d</span><span class="mord">e</span><span class="mord">a</span><span class="mord">l</span><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span></span></span></span></span></span>
<p><strong>Proof:</strong></p>
<p>First, we note that <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>Presign</mtext><mo stretchy="false">]</mo><mo>⇝</mo><msup><mi mathvariant="script">P</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">\mathscr{P}[\text{Presign}] \leadsto \mathscr{P}^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⇝</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="margin-right:0.05em;top:-3.063em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span>,
which modifies <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> to consolidate message sending:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mstyle mathsize="0.9em"><mtable columnspacing="0em" columnalign="right left" rowspacing="0.25em"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mpadded width="+6pt" mathbackground="#FBCFE8" height="+6pt" lspace="3pt" voffset="3pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><msub><mi>P</mi><mi>i</mi></msub></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><msubsup><mtext>Presign</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo><mo>←</mo><msubsup><mtext>Triple</mtext><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mtext>kd</mtext><mi>i</mi></msub><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>D</mi><mo separator="true">,</mo><mtext>KD</mtext><mo stretchy="false">)</mo><mo>←</mo><msubsup><mtext>Triple</mtext><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mo>↱</mo><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>λ</mi><mo stretchy="false">(</mo><mi mathvariant="script">P</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mtext>kd</mtext><mi>i</mi></msub><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">(</mo><mi mathvariant="script">P</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">(</mo><mi mathvariant="script">P</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mo stretchy="false">(</mo><mtext>kd</mtext><mi mathvariant="normal">_</mi><mo>∙</mo><mo separator="true">,</mo><mtext>ka</mtext><mi mathvariant="normal">_</mi><mo>∙</mo><mo separator="true">,</mo><mtext>xb</mtext><mi mathvariant="normal">_</mi><mo>∙</mo><mo stretchy="false">)</mo><msubsup><mo>↰</mo><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mtext>kd</mtext><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mtext>kd</mtext><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mtext>kd</mtext><mo>⋅</mo><mi>G</mi><mi mathvariant="normal">≠</mi><mtext>KD</mtext><mo>:</mo><mspace width="0.5em"/><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mtext>ka</mtext><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mtext>ka</mtext><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mtext>ka</mtext><mo>⋅</mo><mi>G</mi><mi mathvariant="normal">≠</mi><mi>K</mi><mo>+</mo><mi>A</mi><mo>:</mo><mspace width="0.5em"/><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mtext>xb</mtext><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mtext>xb</mtext><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mtext>xb</mtext><mo>⋅</mo><mi>G</mi><mi mathvariant="normal">≠</mi><mi>X</mi><mo>+</mo><mi>B</mi><mo>:</mo><mspace width="0.5em"/><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mi>R</mi><mo>←</mo><mfrac><mn>1</mn><mtext>kd</mtext></mfrac><mo>⋅</mo><mi>D</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>σ</mi><mi>i</mi></msub><mo>←</mo><mtext>ka</mtext><mo>⋅</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mtext>xb</mtext><mo>⋅</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>R</mi><mo separator="true">,</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>σ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $P_i$
}\cr
\cr
&amp;\underline{
  (1)\text{Presign}_i^\tau():
}\cr
  &amp;\enspace
    (a_i, b_i, c_i, A, B, C) \gets \text{Triple}_i^{(\tau, 0)}()
  \cr
  &amp;\enspace
    (k_i, d_i, \text{kd}_i, K, D, \text{KD}) \gets \text{Triple}_i^{(\tau, 1)}()
  \cr
  &amp;\enspace
    \Rsh^\tau_i(\star, (\lambda(\mathcal{P}) \cdot \text{kd}_i, \lambda(\mathcal{P}) \cdot (k_i + a_i), \lambda(\mathcal{P}) \cdot (x_i + b_i)), 0)
  \cr
  \cr
  &amp;\enspace
    (\text{kd}\_\bullet, \text{ka}\_\bullet, \text{xb}\_\bullet) \Lsh^\tau_i(\star, 0)
  \cr
  &amp;\enspace
    \text{kd} \gets \sum_j \text{kd}_j
  \cr
  &amp;\enspace
    \texttt{if } \text{kd} \cdot G \neq \text{KD}:\enspace\texttt{stop}(\star, 0)
  \cr
  &amp;\enspace
    \text{ka} \gets \sum_j \text{ka}_j
  \cr
  &amp;\enspace
    \texttt{if } \text{ka} \cdot G \neq K + A:\enspace\texttt{stop}(\star, 0)
  \cr
  &amp;\enspace
    \text{xb} \gets \sum_j \text{xb}_j
  \cr
  &amp;\enspace
    \texttt{if } \text{xb} \cdot G \neq X + B:\enspace\texttt{stop}(\star, 0)
  \cr
  &amp;\enspace\cr
  &amp;\enspace
    R \gets \frac{1}{\text{kd}} \cdot D
  \cr
  &amp;\enspace
    \sigma_i \gets \text{ka} \cdot x_i - \text{xb} \cdot a_i + c_i
  \cr
  &amp;\enspace
    \texttt{return } (X, R, k_i, \sigma_i)
  \cr
\end{aligned}
}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-14.7258em;height:29.9017em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:15.1758em;"><span style="top:-31.9017em;"><span class="pstrut" style="height:31.9017em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:16.4843em;"><span style="top:-18.5946em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-16.9546em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-15.4546em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-13.682em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-12.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-10.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-9.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-7.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-5.8006em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-3.2752em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-1.5652em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:0.9601em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:2.6701em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:5.1954em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:6.6954em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:8.6768em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:10.5028em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:12.0028em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:15.9843em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:16.4843em;"><span style="top:-18.5946em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2111em;"><span style="top:-3.2111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="stretchy colorbox" style="height:1.7111em;background-color:#FBCFE8;"></span></span><span style="top:-3.7111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="mord boxpad"><span class="mord sizing reset-size5 size7"><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.1389em;top:-2.65em;margin-right:0.0417em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span><span style="top:-15.4546em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:-13.682em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">T</span><span class="mord">r</span><span class="mord">i</span><span class="mord">p</span><span class="mord">l</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0115em;"><span style="margin-right:0.0556em;top:-2.3451em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.1115em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2549em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:-12.0106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;margin-left:-0.0315em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0278em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">K</span><span class="mord">D</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">T</span><span class="mord">r</span><span class="mord">i</span><span class="mord">p</span><span class="mord">l</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0115em;"><span style="margin-right:0.0556em;top:-2.3451em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1115em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2549em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:-10.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-right:0.0556em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.0822em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.0822em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:-0.0315em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.0822em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-7.5106em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel amsrm">↰</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-5.8006em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8943em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.2752em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">K</span><span class="mord">D</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-1.5652em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="margin-left:0em;top:-1.8943em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:0.9601em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:2.6701em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8943em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:5.1954em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:6.6954em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span></span></span><span style="top:8.6768em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter sizing reset-size5 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size5 size6"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0278em;">D</span></span></span><span style="top:10.5028em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;margin-left:-0.0359em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;margin-left:0em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:12.0028em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:-0.0315em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.0359em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:15.9843em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-17.1758em;"><span class="pstrut" style="height:31.9017em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:29.9017em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:14.7258em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>A sketch of the simulator here would be to delay sending messages
from malicious to honest parties until all three bundles have been sent,
and to detect failures early to make all aborts look the same.</p>
<p>From <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">P</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">\mathcal{P}^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.0822em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span>, we can jump to <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>IdealPresign</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathcal{P}[\text{IdealPresign}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathcal" style="margin-right:0.0822em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">I</span><span class="mord">d</span><span class="mord">e</span><span class="mord">a</span><span class="mord">l</span><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span></span></span></span></span> directly.</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable columnalign="center" columnspacing="1em" rowspacing="0.16em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mtable rowspacing="0.25em" columnspacing="0em" columnalign="right left"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mpadded height="+6pt" lspace="3pt" voffset="3pt" mathbackground="#FBCFE8" width="+6pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><msubsup><mi mathvariant="normal">Γ</mi><mi>H</mi><mn>0</mn></msubsup></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mo>…</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose><mo>⊗</mo><menclose notation="box"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mstyle mathsize="0.9em"><mtable rowspacing="0.25em" columnspacing="0em" columnalign="right left"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mpadded voffset="3pt" mathbackground="#bae6fd" width="+6pt" height="+6pt" lspace="3pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><mi>S</mi></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msubsup><mi>α</mi><mi>j</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>β</mi><mi>j</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>d</mi><mi>j</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>δ</mi><mi>j</mi><mi>τ</mi></msubsup><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded lspace="0.3em" width="+0.6em"><mi mathvariant="normal">$</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>α</mi><mi>τ</mi></msup><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>α</mi><mi>j</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msup><mi>β</mi><mi>τ</mi></msup><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>β</mi><mi>j</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msup><mi>δ</mi><mi>τ</mi></msup><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msubsup><mi>δ</mi><mi>j</mi><mi>τ</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msubsup><mi>γ</mi><mi>j</mi><mi>τ</mi></msubsup><mover><mo minsize="1.75em" stretchy="true">←</mo><mpadded lspace="0.3em" width="+0.6em"><mi mathvariant="normal">$</mi></mpadded></mover><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>γ</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>γ</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>∣</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>γ</mi><mi>j</mi></msub><mo>=</mo><mi>α</mi><mo>⋅</mo><mi>β</mi><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><msubsup><mi>x</mi><mi>k</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msup><mi>R</mi><mi>τ</mi></msup><mo separator="true">,</mo><msubsup><mi>k</mi><mi>k</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>σ</mi><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">)</mo><mo>←</mo><msubsup><mtext>Presign</mtext><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>K</mi><mi>τ</mi></msup><mo>←</mo><msup><mtext>K</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mtext>XK</mtext><mi>τ</mi></msup><mo>←</mo><msup><mtext>XK</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>A</mi><mi>τ</mi></msup><mo>←</mo><msup><mi>α</mi><mi>τ</mi></msup><mo>⋅</mo><mi>G</mi><mo>−</mo><msup><mi>K</mi><mi>τ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><msup><mi>B</mi><mi>τ</mi></msup><mo>←</mo><msup><mi>β</mi><mi>τ</mi></msup><mo>⋅</mo><mi>G</mi><mo>−</mo><mi>X</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>C</mi><mi>τ</mi></msup><mo>←</mo><msup><mi>α</mi><mi>τ</mi></msup><msup><mi>β</mi><mi>τ</mi></msup><mo>−</mo><msup><mi>α</mi><mi>τ</mi></msup><mo>⋅</mo><mi>X</mi><mo>−</mo><msup><mi>β</mi><mi>τ</mi></msup><mo>⋅</mo><msup><mi>K</mi><mi>τ</mi></msup><mo>+</mo><msup><mtext>XK</mtext><mi>τ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><msup><mi>D</mi><mi>τ</mi></msup><mo>←</mo><msup><mi>δ</mi><mi>τ</mi></msup><mo>⋅</mo><msup><mi>R</mi><mi>τ</mi></msup><mo separator="true">,</mo><msup><mtext>KD</mtext><mi>τ</mi></msup><mo>←</mo><msup><mi>δ</mi><mi>τ</mi></msup><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mtext>Triple</mtext><mi>k</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mn>0</mn></mrow></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>a</mi><mi>k</mi></msub><mo>←</mo><msubsup><mi>α</mi><mi>k</mi><mi>τ</mi></msubsup><mo>−</mo><msubsup><mi>k</mi><mi>k</mi><mi>τ</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>b</mi><mi>k</mi></msub><mo>←</mo><msubsup><mi>β</mi><mi>k</mi><mi>τ</mi></msubsup><mo>−</mo><msubsup><mi>k</mi><mi>k</mi><mi>τ</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>c</mi><mi>k</mi></msub><mo>←</mo><msubsup><mi>γ</mi><mi>k</mi><mi>τ</mi></msubsup><mo>−</mo><mi>α</mi><mo>⋅</mo><mi>x</mi><mo>−</mo><mi>β</mi><mo>⋅</mo><mi>k</mi><mo>+</mo><msubsup><mi>σ</mi><mi>k</mi><mi>τ</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>k</mi></msub><mo separator="true">,</mo><msup><mi>A</mi><mi>τ</mi></msup><mo separator="true">,</mo><msup><mi>B</mi><mi>τ</mi></msup><mo separator="true">,</mo><msup><mi>C</mi><mi>τ</mi></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mtext>Triple</mtext><mi>k</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><msubsup><mi>k</mi><mi>k</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>d</mi><mi>k</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>δ</mi><mi>k</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msup><mi>K</mi><mi>τ</mi></msup><mo separator="true">,</mo><msup><mi>D</mi><mi>τ</mi></msup><mo separator="true">,</mo><msup><mtext>KD</mtext><mi>τ</mi></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><msup><mi>m</mi><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>←</mo><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mo>↱</mo><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mover accent="true"><mi>m</mi><mo>^</mo></mover><mi mathvariant="normal">_</mi><mo>∙</mo><mo>=</mo><mo stretchy="false">(</mo><mtext>kd</mtext><mi mathvariant="normal">_</mi><mo>∙</mo><mo separator="true">,</mo><mtext>ka</mtext><mi mathvariant="normal">_</mi><mo>∙</mo><mo separator="true">,</mo><mtext>xb</mtext><mi mathvariant="normal">_</mi><mo>∙</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msup><mi>m</mi><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mi>j</mi></mrow><mo>←</mo><mover accent="true"><mi>m</mi><mo>^</mo></mover><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mi>j</mi></mrow><mtext> </mtext><mo stretchy="false">(</mo><mi mathvariant="normal">∀</mi><mi>j</mi><mo>∈</mo><mi>S</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mtext>Sync</mtext><mi>k</mi></msub><mo stretchy="false">(</mo><mi>S</mi><mo>∩</mo><mi mathvariant="script">H</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">for</mtext><mtext> </mtext></mrow><mi>j</mi><mo>∈</mo><mi mathvariant="script">H</mi><mi mathvariant="normal">.</mi><mtext> </mtext><mi mathvariant="normal">∀</mi><mi>k</mi><mo>∈</mo><mi mathvariant="script">M</mi><mi mathvariant="normal">.</mi><mtext> </mtext><msup><mi>m</mi><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mi>j</mi></mrow><mi mathvariant="normal">≠</mi><mi mathvariant="normal">⊥</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mo stretchy="false">(</mo><msub><mtext>kd</mtext><mi>k</mi></msub><mo separator="true">,</mo><msub><mtext>ka</mtext><mi>k</mi></msub><mo separator="true">,</mo><msub><mtext>xb</mtext><mi>k</mi></msub><mo stretchy="false">)</mo><mo>←</mo><mi>m</mi><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mi>j</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mover accent="true"><mtext>kd</mtext><mo>^</mo></mover><mo>=</mo><mo>∑</mo><mi mathvariant="normal">_</mi><mrow><mi>j</mi><mo>∈</mo><mi mathvariant="script">H</mi></mrow><msubsup><mi>δ</mi><mi>j</mi><mi>τ</mi></msubsup><mo>+</mo><mo>∑</mo><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mo>∈</mo><mi mathvariant="script">M</mi></mrow><msub><mtext>kd</mtext><mi>k</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mover accent="true"><mtext>ka</mtext><mo>^</mo></mover><mo>=</mo><mo>∑</mo><mi mathvariant="normal">_</mi><mrow><mi>j</mi><mo>∈</mo><mi mathvariant="script">H</mi></mrow><msubsup><mi>α</mi><mi>j</mi><mi>τ</mi></msubsup><mo>+</mo><mo>∑</mo><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mo>∈</mo><mi mathvariant="script">M</mi></mrow><msub><mtext>ka</mtext><mi>k</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mover accent="true"><mtext>xb</mtext><mo>^</mo></mover><mo>=</mo><mo>∑</mo><mi mathvariant="normal">_</mi><mrow><mi>j</mi><mo>∈</mo><mi mathvariant="script">H</mi></mrow><msubsup><mi>β</mi><mi>j</mi><mi>τ</mi></msubsup><mo>+</mo><mo>∑</mo><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mo>∈</mo><mi mathvariant="script">M</mi></mrow><msub><mtext>xb</mtext><mi>k</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mover accent="true"><mtext>kd</mtext><mo>^</mo></mover><mo>⋅</mo><mi>G</mi><mi mathvariant="normal">≠</mi><msup><mtext>KD</mtext><mi>τ</mi></msup><mo>∨</mo><mover accent="true"><mtext>ka</mtext><mo>^</mo></mover><mo>⋅</mo><mi>G</mi><mi mathvariant="normal">≠</mi><msup><mi>K</mi><mi>τ</mi></msup><mo>+</mo><msup><mi>A</mi><mi>τ</mi></msup><mo>∨</mo><mover accent="true"><mtext>xb</mtext><mo>^</mo></mover><mo>⋅</mo><mi>G</mi><mi mathvariant="normal">≠</mi><mi>X</mi><mo>+</mo><msup><mi>B</mi><mi>τ</mi></msup><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mspace width="0.5em"/><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo stretchy="false">{</mo><mi>j</mi><mo stretchy="false">}</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mo>↰</mo><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mtext>WaitSync</mtext><mi>k</mi></msub><mo stretchy="false">(</mo><mi>S</mi><mo>∩</mo><mi mathvariant="script">H</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mtext mathvariant="monospace">wait</mtext><mi mathvariant="normal">_</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mi mathvariant="normal">∀</mi><mi>j</mi><mo>∈</mo><mi>S</mi><mi mathvariant="normal">.</mi><mtext> </mtext><msup><mi>m</mi><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mrow><mi>j</mi><mi>k</mi></mrow><mi mathvariant="normal">≠</mi><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>r</mi><mi>j</mi></msub><mo>←</mo><msup><mi>m</mi><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mrow><mi>j</mi><mi>k</mi></mrow><mtext> </mtext><mo stretchy="false">(</mo><mi>j</mi><mo>∈</mo><mi>S</mi><mo>∩</mo><mi mathvariant="script">M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>r</mi><mi>j</mi></msub><mo>←</mo><mo stretchy="false">(</mo><msubsup><mi>δ</mi><mi>j</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>α</mi><mi>j</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>β</mi><mi>j</mi><mi>τ</mi></msubsup><mo stretchy="false">)</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>j</mi><mo>∈</mo><mi>S</mi><mo>∩</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mi>r</mi><mi mathvariant="normal">_</mi><mo>∙</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mo>…</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mo rspace="0em" lspace="0em">∘</mo></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Presign</mtext><mo stretchy="false">]</mo><mo>⊚</mo><mi>F</mi><mo stretchy="false">[</mo><mtext>Stop</mtext><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\boxed{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $\Gamma^0_H$
}\cr
&amp;\ldots
\end{aligned}
}
\otimes
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{bae6fd}{\large
  $S$
}\cr
&amp;\alpha^\tau_j, \beta^\tau_j, d^\tau_j, \delta^\tau_j \xleftarrow{\$} \mathbb{F}_q\cr
&amp;\alpha^\tau \gets \sum_j \alpha^\tau_j, \beta^\tau \gets \sum_j \beta^\tau_j, \delta^\tau \gets \sum_j \delta^\tau_j\cr
&amp;\gamma^\tau_j \xleftarrow{\$} \{(\gamma_1, \ldots, \gamma_n) \mid \sum_j \gamma_j = \alpha \cdot \beta \}\cr
&amp;(X, x^\tau_k, R^\tau, k^\tau_k, \sigma^\tau_k) \gets \text{Presign}^\tau_k()\cr
&amp;K^\tau \gets \text{K}^\tau(), \text{XK}^\tau \gets \text{XK}^\tau()\cr
\cr
&amp;A^\tau \gets \alpha^\tau \cdot G - K^\tau\cr
&amp;B^\tau \gets \beta^\tau \cdot G - X\cr
&amp;C^\tau \gets \alpha^\tau \beta^\tau - \alpha^\tau \cdot X - \beta^\tau \cdot K^\tau + \text{XK}^\tau\cr
&amp;D^\tau \gets \delta^\tau \cdot R^\tau, \text{KD}^\tau \gets \delta^\tau \cdot G\cr
\cr
&amp;\underline{
  \text{Triple}^{\tau, 0}_k():
}\cr
  &amp;\enspace
    a_k \gets \alpha^\tau_k - k^\tau_k
  \cr
  &amp;\enspace
    b_k \gets \beta^\tau_k - k^\tau_k
  \cr
  &amp;\enspace
    c_k \gets \gamma^\tau_k - \alpha \cdot x - \beta \cdot k + \sigma^\tau_k
  \cr
  &amp;\enspace
    \texttt{return } (a_k, b_k, c_k, A^\tau, B^\tau, C^\tau)
  \cr
\cr
&amp;\underline{
  \text{Triple}^{\tau, 1}_k():
}\cr
  &amp;\enspace
    \texttt{return } (k^\tau_k, d^\tau_k, \delta^\tau_k, K^\tau, D^\tau, \text{KD}^\tau)
  \cr
\cr
\cr
&amp;m^\tau\_{ij} \gets \bot\cr
\cr
&amp;\underline{
  \Rsh^{\tau}_k(S, \hat{m}\_\bullet = (\text{kd}\_\bullet, \text{ka}\_\bullet, \text{xb}\_\bullet), 0):
}\cr
  &amp;\enspace
    m^\tau\_{kj} \gets \hat{m}\_{kj}\ (\forall j \in S)
  \cr
  &amp;\enspace
    \text{Sync}_k(S \cap \mathcal{H}, 0)
  \cr
  &amp;\enspace
    \texttt{for } j \in \mathcal{H}.\ \forall k \in \mathcal{M}.\ m^\tau\_{kj} \neq \bot:
  \cr
  &amp;\enspace\enspace
    (\text{kd}_k, \text{ka}_k, \text{xb}_k) \gets m\_{k j}
  \cr
  &amp;\enspace
    \hat{\text{kd}} = \sum\_{j \in \mathcal{H}} \delta^\tau_j + \sum\_{k \in \mathcal{M}} \text{kd}_k
  \cr
  &amp;\enspace\enspace
    \hat{\text{ka}} = \sum\_{j \in \mathcal{H}} \alpha^\tau_j + \sum\_{k \in \mathcal{M}} \text{ka}_k
  \cr
  &amp;\enspace\enspace
    \hat{\text{xb}} = \sum\_{j \in \mathcal{H}} \beta^\tau_j + \sum\_{k \in \mathcal{M}} \text{xb}_k
  \cr
  &amp;\enspace\enspace
    \texttt{if } \hat{\text{kd}} \cdot G \neq \text{KD}^\tau \lor \hat{\text{ka}} \cdot G \neq K^\tau + A^\tau \lor \hat{\text{xb}} \cdot G \neq X + B^\tau:
  \cr
  &amp;\enspace\enspace\enspace
    \texttt{stop}(\{j\}, 0)
  \cr
\cr
&amp;\underline{
  \Lsh^{\tau}_k(S, 0):
}\cr
  &amp;\enspace
    \text{WaitSync}_k(S \cap \mathcal{H}, 0)
  \cr
  &amp;\enspace
    \texttt{wait}\_{(k, 0)} \forall j \in S.\ m^\tau\_{jk} \neq \bot
  \cr
  &amp;\enspace
    r_j \gets m^\tau\_{jk}\ (j \in S \cap \mathcal{M})
  \cr
  &amp;\enspace
    r_j \gets (\delta^\tau_j, \alpha^\tau_j, \beta^\tau_j)\ (j \in S \cap \mathcal{H})
  \cr
  &amp;\enspace
    \texttt{return } r\_\bullet
  \cr
\cr
&amp;\ldots\cr
\end{aligned}
}
}
\cr
\circ\cr
F[\text{Presign}] \circledcirc F[\text{Stop}]
\end{matrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:65.7662em;vertical-align:-32.6331em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:33.1331em;"><span style="top:-35.1331em;"><span class="pstrut" style="height:33.9081em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.4171em;"><span style="top:-6.3342em;"><span class="pstrut" style="height:6.3342em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0771em;"><span style="top:-4.0771em;"><span class="pstrut" style="height:3.2512em;"></span><span class="mord"></span></span><span style="top:-2.334em;"><span class="pstrut" style="height:3.2512em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5771em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0771em;"><span style="top:-4.0771em;"><span class="pstrut" style="height:3.2512em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2512em;"><span style="top:-3.2512em;"><span class="pstrut" style="height:3.8542em;"></span><span class="stretchy colorbox" style="height:1.8542em;background-color:#FBCFE8;"></span></span><span style="top:-3.8542em;"><span class="pstrut" style="height:3.8542em;"></span><span class="mord boxpad"><span class="mord sizing reset-size6 size7"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7926em;"><span style="margin-left:0em;top:-2.5474em;margin-right:0.0417em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0813em;">H</span></span></span><span style="top:-3.163em;margin-right:0.0417em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2526em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6031em;"><span></span></span></span></span></span></span></span><span style="top:-2.334em;"><span class="pstrut" style="height:3.2512em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5771em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-4.4171em;"><span class="pstrut" style="height:6.3342em;"></span><span class="stretchy fbox" style="border-style:solid;height:4.3342em;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9171em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:31.9081em;"><span style="top:-65.3662em;"><span class="pstrut" style="height:65.3662em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:35.0757em;"><span style="top:-37.0757em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-35.2937em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-33.567em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-30.7597em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-28.2344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-26.7344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-25.2344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-23.7344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-22.2344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-20.7344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-19.2344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-17.7344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-16.1704em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-14.5522em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-13.0522em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-11.5522em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-10.0522em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-8.5522em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-6.9881em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-5.37em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-3.87em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-2.37em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-0.87em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:0.63em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:2.13em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:3.78em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:5.28em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:6.78em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:8.28em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:9.99em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:11.89em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:13.79em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:15.5979em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:17.0979em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:18.5979em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:20.0979em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:21.6879em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:23.1879em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:24.6879em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:26.1879em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:27.7046em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:29.2046em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:30.7046em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:34.5757em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:35.0757em;"><span style="top:-37.0757em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2111em;"><span style="top:-3.2111em;"><span class="pstrut" style="height:3.5111em;"></span><span class="stretchy colorbox" style="height:1.5111em;background-color:#bae6fd;"></span></span><span style="top:-3.5111em;"><span class="pstrut" style="height:3.5111em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.0576em;">S</span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3em;"><span></span></span></span></span></span></span></span><span style="top:-35.2937em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0037em;top:-2.353em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-left:-0.0528em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:0em;top:-2.353em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0379em;margin-right:0.0556em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice" width="400em" height="0.522em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:-33.567em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8943em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0037em;margin-right:0.0556em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8943em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-left:-0.0528em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0379em;">δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="margin-left:0em;top:-1.8943em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0379em;top:-2.353em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span></span></span><span style="top:-30.7597em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-left:-0.0556em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400000 522" width="400em" height="0.522em" preserveAspectRatio="xMinYMin slice"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span style="margin-right:0.0556em;margin-left:-0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:-0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="margin-left:0em;top:-1.8943em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:-0.0556em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="mclose">}</span></span></span><span style="top:-28.2344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0315em;margin-right:0.0556em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;margin-left:-0.0359em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:-26.7344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">X</span><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">X</span><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:-23.7344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span></span><span style="top:-22.2344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span></span></span><span style="top:-20.7344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord text"><span class="mord">X</span><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span></span><span style="top:-19.2344em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0278em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0379em;">δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0379em;">δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-16.1704em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9041em;"><span style="top:-2.5618em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">T</span><span class="mord">r</span><span class="mord">i</span><span class="mord">p</span><span class="mord">l</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9041em;"><span style="margin-right:0.0556em;top:-2.3218em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.0744em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2782em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4782em;"><span></span></span></span></span></span></span></span><span style="top:-14.5522em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="top:-2.45em;margin-right:0.0556em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-right:0.0556em;margin-left:-0.0037em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0315em;top:-2.353em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-13.0522em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-right:0.0556em;margin-left:-0.0528em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:-0.0315em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-11.5522em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0556em;margin-right:0.0556em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0359em;top:-2.353em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-10.0522em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-6.9881em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9041em;"><span style="top:-2.5618em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">T</span><span class="mord">r</span><span class="mord">i</span><span class="mord">p</span><span class="mord">l</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9041em;"><span style="top:-2.3218em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.0744em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2782em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4782em;"><span></span></span></span></span></span></span></span><span style="top:-5.37em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:-0.0315em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:-0.0379em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0278em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.87em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">ij</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:2.13em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.53em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-right:0.0556em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">m</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.51em;"><span></span></span></span></span></span></span></span><span style="top:3.78em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">kj</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">m</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">kj</span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mclose">)</span></span></span><span style="top:5.28em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2019em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:6.78em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">for </span></span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span><span class="mord">.</span><span class="mspace"> </span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span><span class="mord">.</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">kj</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="vertical-align:-0.1944em;height:0.8889em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:8.28em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">m</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">kj</span></span></span></span><span style="top:9.99em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span></span><span style="top:-3.1634em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:-0.0379em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-symbol large-op" style="top:0em;position:relative;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:11.89em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span></span><span style="top:-3.1634em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-symbol large-op" style="top:0em;position:relative;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0037em;margin-right:0.0556em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span></span><span class="mord"><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:13.79em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span></span><span style="top:-3.1634em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0528em;top:-2.353em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span></span><span class="mord"><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:15.5979em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">d</span></span></span><span style="top:-3.1634em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord text"><span class="mord">k</span><span class="mord">a</span></span></span><span style="top:-3.1634em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord text"><span class="mord">x</span><span class="mord">b</span></span></span><span style="top:-3.1634em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="vertical-align:-0.1944em;height:0.8889em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0502em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:17.0979em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">({</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:20.0979em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel"><span class="mrel amsrm">↰</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:21.6879em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">W</span><span class="mord">a</span><span class="mord">i</span><span class="mord">t</span><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2019em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:23.1879em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">wait</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mord">.</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">jk</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:24.6879em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0278em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:-0.0278em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">jk</span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathcal">M</span><span class="mclose">)</span></span></span><span style="top:26.1879em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0278em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.0278em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0379em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;margin-left:-0.0379em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0037em;margin-right:0.0556em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0528em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-right:0.0556em;margin-left:-0.0528em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span><span class="mclose">)</span></span></span><span style="top:27.7046em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord mathnormal" style="margin-right:0.0278em;">r</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span></span></span><span style="top:30.7046em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:34.5757em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-33.9081em;"><span class="pstrut" style="height:65.3662em;"></span><span class="stretchy fbox" style="height:63.3662em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:31.4581em;"><span></span></span></span></span></span></span></span><span style="top:-2.835em;"><span class="pstrut" style="height:33.9081em;"></span><span class="mord"><span class="mord">∘</span></span></span><span style="top:-1.635em;"><span class="pstrut" style="height:33.9081em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin amsrm">⊚</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">t</span><span class="mord">o</span><span class="mord">p</span></span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:32.6331em;"><span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>The idea behind the simulator is that you generate random values
for the messages you're going to receive,
and then use those to reverse engineer what the large values
like <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;">B</span></span></span></span></span> should be.</p>
<p><span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em;"></span><span class="mord amsrm">■</span></span></span></span></span></p>
<h1>Signing</h1>
<p>Signatures are pretty straightforward once you have presignatures.</p>
<p><strong>Definition (Signing):</strong></p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="false" scriptlevel="0"><mstyle displaystyle="true" scriptlevel="0"><mtable columnspacing="1em" rowspacing="0.16em" columnalign="center"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mpadded mathbackground="#FBCFE8" lspace="3pt" height="+6pt" voffset="3pt" width="+6pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>Sign</mtext><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="true"><mstyle mathsize="0.9em"><mtable columnspacing="0em" rowspacing="0.25em" columnalign="right left"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mpadded height="+6pt" lspace="3pt" width="+6pt" voffset="3pt" mathbackground="#FBCFE8"><mstyle mathsize="1.2em"><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mi>i</mi></msub></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><msubsup><mtext>Sign</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mo>∙</mo><mo separator="true">,</mo><mi>R</mi><mo separator="true">,</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>σ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>←</mo><msubsup><mtext>Presign</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mi>m</mi><mo>←</mo><msup><mtext>GetMessage</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>s</mi><mi>i</mi></msub><mo>←</mo><mtext>Hash</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>k</mi><mi>i</mi></msub><mo>+</mo><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>σ</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mo>↱</mo><mi>i</mi></msub><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>s</mi><mi mathvariant="normal">_</mi><mo>∙</mo><mo>←</mo><msub><mo>↰</mo><mi>i</mi></msub><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>s</mi><mo>←</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>s</mi><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mi mathvariant="normal">¬</mi><mtext>ECDSA</mtext><mi mathvariant="normal">.</mi><mtext>Verify</mtext><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>m</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>R</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mi>s</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose><mspace width="1em"/><mtable columnalign="center" columnspacing="1em" rowspacing="0.16em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mstyle mathsize="0.9em"><mtable columnalign="right left" rowspacing="0.25em" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mpadded width="+6pt" mathbackground="#FBCFE8" voffset="3pt" height="+6pt" lspace="3pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><mi>F</mi><mo stretchy="false">[</mo><mtext>Messages</mtext><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>m</mi><mi>τ</mi></msup><mo>←</mo><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msup><mtext>SetMessage</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><msup><mi>m</mi><mi>τ</mi></msup><mo>=</mo><mi mathvariant="normal">⊥</mi><mo>:</mo><msup><mi>m</mi><mi>τ</mi></msup><mo>←</mo><mi>m</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><msup><mtext>GetMessage</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">wait</mtext><mtext> </mtext></mrow><msup><mi>m</mi><mi>τ</mi></msup><mi mathvariant="normal">≠</mi><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><msup><mi>m</mi><mi>τ</mi></msup></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo rspace="0em" lspace="0em">⊗</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>SyncComm</mtext><msup><mo stretchy="false">]</mo><mi mathvariant="double-struck">N</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mo rspace="0em" lspace="0em">⊚</mo></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Stop</mtext><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Leakage</mtext><mo>:</mo><mo>=</mo><mo stretchy="false">{</mo><mtext mathvariant="monospace">stop</mtext><mo separator="true">,</mo><msup><mtext>SetMessage</mtext><mi>τ</mi></msup><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose><mo>⊲</mo><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>Presign</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\boxed{
\begin{matrix}
\colorbox{FBCFE8}{\large
  $\mathscr{P}[\text{Sign}]$
}\cr
\cr
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $P_i$
}\cr
\cr
&amp;\underline{
  (1)\text{Sign}_i^\tau():
}\cr
  &amp;\enspace
    (X, \bullet, R, k_i, \sigma_i) \gets \text{Presign}_i^\tau()
  \cr
  &amp;\enspace
    m \gets \text{GetMessage}^\tau()
  \cr
  &amp;\enspace
    s_i \gets \text{Hash}(m) \cdot k_i + x(R) \cdot \sigma_i
  \cr
  &amp;\enspace
    \Rsh_i(\star, s_i, 1)
  \cr
  &amp;\enspace
    s\_\bullet \gets \Lsh_i(\star, 1)
  \cr
  &amp;\enspace
    s \gets \sum_j s_j
  \cr
  &amp;\enspace
    \texttt{if } \neg \text{ECDSA}.\text{Verify}(X, m, (R, s)):
  \cr
  &amp;\enspace\enspace
    \texttt{stop}(\star, 1)
  \cr
  &amp;\enspace
    \texttt{return } s
  \cr
\end{aligned}
}
}
\quad
\begin{matrix}
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $F[\text{Messages}]$
}\cr
\cr
&amp;m^\tau \gets \bot
\cr
&amp;\underline{
  \text{SetMessage}^\tau(m):
}\cr
  &amp;\enspace
    \texttt{if } m^\tau = \bot: m^\tau \gets m
  \cr
\cr
&amp;\underline{
  \text{GetMessage}^\tau():
}\cr
  &amp;\enspace
    \texttt{wait } m^\tau \neq \bot
  \cr
  &amp;\enspace
    \texttt{return } m^\tau
  \cr
\end{aligned}
}
}\cr
\otimes\cr
F[\text{SyncComm}]^\mathbb{N}\cr
\circledcirc \cr
F[\text{Stop}]
\end{matrix}\cr
\cr
\text{Leakage} := \{\texttt{stop}, \text{SetMessage}^\tau\}
\end{matrix}
}
\lhd \mathscr{P}[\text{Presign}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:24.6228em;vertical-align:-12.0614em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:12.5614em;"><span style="top:-26.6228em;"><span class="pstrut" style="height:26.6228em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:12.2214em;"><span style="top:-22.5178em;"><span class="pstrut" style="height:11.4964em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2em;"><span style="top:-3.2em;"><span class="pstrut" style="height:3.8em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.8em;"></span></span><span style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord boxpad"><span class="mord mathscr sizing reset-size6 size7" style="margin-right:0.0808em;">P</span><span class="mopen sizing reset-size6 size7">[</span><span class="mord text sizing reset-size6 size7"><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose sizing reset-size6 size7">]</span><span class="mord sizing reset-size6 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6em;"><span></span></span></span></span></span></span></span><span style="top:-21.0778em;"><span class="pstrut" style="height:11.4964em;"></span><span class="mord"></span></span><span style="top:-11.2214em;"><span class="pstrut" style="height:11.4964em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.4964em;"><span style="top:-20.5428em;"><span class="pstrut" style="height:20.5428em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:10.1738em;"><span style="top:-12.1738em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-10.5338em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-9.0338em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-7.4327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-5.9327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-4.4327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-2.9327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-1.4327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:0.2773em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:2.8027em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:4.3027em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:5.8027em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.6738em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:10.1738em;"><span style="top:-12.1738em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2111em;"><span style="top:-3.2111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.7111em;"></span></span><span style="top:-3.7111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="mord boxpad"><span class="mord sizing reset-size5 size7"><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.65em;margin-left:-0.1389em;margin-right:0.0417em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span><span style="top:-9.0338em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:-7.4327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∙</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.0315em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.0359em;top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:-5.9327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">G</span><span class="mord">e</span><span class="mord">t</span><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:-4.4327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">H</span><span class="mord">a</span><span class="mord">s</span><span class="mord">h</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.0315em;top:-2.45em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:-0.0359em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.9327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-1.4327em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal">s</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mrel"><span class="mrel amsrm">↰</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:0.2773em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="margin-left:0em;top:-1.8943em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-right:0.0556em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:2.8027em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord">¬</span><span class="mord text"><span class="mord">E</span><span class="mord">C</span><span class="mord">D</span><span class="mord">S</span><span class="mord">A</span></span><span class="mord">.</span><span class="mord text"><span class="mord">V</span><span class="mord">e</span><span class="mord">r</span><span class="mord">i</span><span class="mord">f</span><span class="mord">y</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:4.3027em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:5.8027em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.6738em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-11.4964em;"><span class="pstrut" style="height:20.5428em;"></span><span class="stretchy fbox" style="border-width:0.04em;height:18.5428em;border-style:solid;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.0464em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.4786em;"><span style="top:-11.4786em;"><span class="pstrut" style="height:9.051em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.051em;"><span style="top:-15.652em;"><span class="pstrut" style="height:15.652em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.4567em;"><span style="top:-9.4567em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-7.6833em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-6.1833em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-4.6833em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-3.0933em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-1.5933em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:-0.0933em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:1.4967em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span><span style="top:2.9967em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.9567em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.4567em;"><span style="top:-9.4567em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3em;"><span style="top:-3.3em;"><span class="pstrut" style="height:3.9333em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.9333em;"></span></span><span style="top:-3.9333em;"><span class="pstrut" style="height:3.9333em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.1389em;">F</span><span class="mopen sizing reset-size5 size7">[</span><span class="mord text sizing reset-size5 size7"><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span><span class="mord">s</span></span><span class="mclose sizing reset-size5 size7">]</span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333em;"><span></span></span></span></span></span></span></span><span style="top:-6.1833em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:-4.6833em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">e</span><span class="mord">t</span><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:-3.0933em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">m</span></span></span><span style="top:-0.0933em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">G</span><span class="mord">e</span><span class="mord">t</span><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:1.4967em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">wait </span></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="vertical-align:-0.1944em;height:0.8889em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:2.9967em;"><span class="pstrut" style="height:3.3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.9567em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-9.051em;"><span class="pstrut" style="height:15.652em;"></span><span class="stretchy fbox" style="height:13.652em;border-width:0.04em;border-style:solid;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.601em;"><span></span></span></span></span></span></span></span><span style="top:-4.0376em;"><span class="pstrut" style="height:9.051em;"></span><span class="mord"><span class="mord">⊗</span></span></span><span style="top:-2.8324em;"><span class="pstrut" style="height:9.051em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span><span class="mord">C</span><span class="mord">o</span><span class="mord">m</span><span class="mord">m</span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8452em;"><span style="margin-right:0.05em;top:-3.063em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbb mtight">N</span></span></span></span></span></span></span></span></span></span><span style="top:-1.6324em;"><span class="pstrut" style="height:9.051em;"></span><span class="mord"><span class="mord amsrm">⊚</span></span></span><span style="top:-0.4324em;"><span class="pstrut" style="height:9.051em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">t</span><span class="mord">o</span><span class="mord">p</span></span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.9786em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.335em;"><span class="pstrut" style="height:11.4964em;"></span><span class="mord"></span></span><span style="top:-0.135em;"><span class="pstrut" style="height:11.4964em;"></span><span class="mord"><span class="mord text"><span class="mord">L</span><span class="mord">e</span><span class="mord">a</span><span class="mord">k</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">e</span><span class="mord">t</span><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7376em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:11.7214em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-14.5614em;"><span class="pstrut" style="height:26.6228em;"></span><span class="stretchy fbox" style="border-width:0.04em;height:24.6228em;border-style:solid;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:12.0614em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin amsrm">⊲</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span></span></span></span></span></span>
<p><span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">□</mi></mrow><annotation encoding="application/x-tex">\square</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em;"></span><span class="mord amsrm">□</span></span></span></span></span></p>
<p>We assume that there's a separate functionality which provides consensus
on the message to sign in each instance.</p>
<p><strong>Definition (Ideal Signing):</strong></p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><menclose notation="box"><mstyle displaystyle="false" scriptlevel="0"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="true"><mtable columnspacing="1em" rowspacing="0.16em" columnalign="center"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mpadded lspace="3pt" width="+6pt" height="+6pt" mathbackground="#FBCFE8" voffset="3pt"><mstyle mathsize="1.2em"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>IdealSign</mtext><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="true"><mstyle mathsize="0.9em"><mtable columnspacing="0em" rowspacing="0.25em" columnalign="right left"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mpadded height="+6pt" voffset="3pt" width="+6pt" lspace="3pt" mathbackground="#FBCFE8"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><msub><mi>P</mi><mi>i</mi></msub></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><msubsup><mtext>Sign</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mtext>Sync</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mtext>WaitSync</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mtext>Ready</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo>⋆</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><msubsup><mtext>Sig</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose><mspace width="1em"/><mtable columnalign="center" rowspacing="0.16em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><menclose notation="box"><mstyle displaystyle="false" scriptlevel="0"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="true"><mstyle mathsize="0.9em"><mtable columnspacing="0em" columnalign="right left" rowspacing="0.25em"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mpadded voffset="3pt" width="+6pt" height="+6pt" mathbackground="#FBCFE8" lspace="3pt"><mstyle mathsize="1.2em"><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi><mo stretchy="false">[</mo><mtext>Sign</mtext><mo stretchy="false">]</mo></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>ready</mtext><mi mathvariant="normal">_</mi><msup><mrow><mi>i</mi><mi>j</mi></mrow><mi>τ</mi></msup><mo>←</mo><mtext mathvariant="monospace">false</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi><mo separator="true">,</mo><msup><mi>k</mi><mi>τ</mi></msup><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded lspace="0.3em" width="+0.6em"><mi mathvariant="normal">$</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mtext>Ready</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msup><mtext>ready</mtext><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>←</mo><mtext mathvariant="monospace">true</mtext><mtext> </mtext><mo stretchy="false">(</mo><mi mathvariant="normal">∀</mi><mi>j</mi><mo>∈</mo><mi>S</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mtext>WaitReady</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mtext mathvariant="monospace">wait</mtext><mi mathvariant="normal">_</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mi mathvariant="normal">∀</mi><mi>j</mi><mo>∈</mo><mi mathvariant="script">S</mi><mi mathvariant="normal">.</mi><mtext> </mtext><msup><mtext>ready</mtext><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mrow><mi>j</mi><mi>i</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mtext>Sig</mtext><mi>i</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mtext mathvariant="monospace">wait</mtext><mi mathvariant="normal">_</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mi mathvariant="normal">∀</mi><mi>j</mi><mo>∈</mo><mi mathvariant="script">P</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">∃</mi><mi>i</mi><mi mathvariant="normal">.</mi><mtext> </mtext><msup><mtext>ready</mtext><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mrow><mi>j</mi><mi>i</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>m</mi><mo>←</mo><msup><mtext>GetMessage</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>R</mi><mo>←</mo><mfrac><mn>1</mn><msup><mi>k</mi><mi>τ</mi></msup></mfrac><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>s</mi><mo>←</mo><mi>k</mi><mo>⋅</mo><mo stretchy="false">(</mo><mtext>Hash</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>R</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msup><mtext>Leak</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>x</mi><mo>⋅</mo><mi>G</mi><mo separator="true">,</mo><mi>x</mi><msup><mi>k</mi><mi>τ</mi></msup><mo>⋅</mo><mi>G</mi><mo separator="true">,</mo><msup><mi>k</mi><mi>τ</mi></msup><mo>⋅</mo><mi>G</mi><mo separator="true">,</mo><mfrac><mn>1</mn><msup><mi>k</mi><mi>τ</mi></msup></mfrac><mo>⋅</mo><mi>G</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⊚</mo></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Messages</mtext><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo rspace="0em" lspace="0em">⊗</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Sync</mtext><msup><mo stretchy="false">]</mo><mi mathvariant="double-struck">N</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo rspace="0em" lspace="0em">⊚</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Stop</mtext><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Leakage</mtext><mo>:</mo><mo>=</mo><mo stretchy="false">{</mo><mtext mathvariant="monospace">stop</mtext><mo separator="true">,</mo><msup><mtext>SetMessage</mtext><mi>τ</mi></msup><mo separator="true">,</mo><msup><mtext>GetMessage</mtext><mi>τ</mi></msup><mo separator="true">,</mo><msup><mtext>Leak</mtext><mi>τ</mi></msup><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose><mo>⊲</mo><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>Presign</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\boxed{
\begin{matrix}
\colorbox{FBCFE8}{\large
  $\mathscr{P}[\text{IdealSign}]$
}\cr
\cr
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $P_i$
}\cr
\cr
&amp;\underline{
  (1)\text{Sign}_i^\tau():
}\cr
  &amp;\enspace
    \text{Sync}^\tau_i(\star, 0)
  \cr
  &amp;\enspace
    \text{WaitSync}^\tau_i(\star, 0)
  \cr
  &amp;\enspace
    \text{Ready}^\tau_i(\star)
  \cr
  &amp;\enspace
    \texttt{return } \text{Sig}^\tau_i()
  \cr
\end{aligned}
}
}
\quad
\begin{matrix}
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $F[\text{Sign}]$
}\cr
\cr
&amp;\text{ready}\_{ij}^\tau \gets \texttt{false}\cr
&amp;x, k^\tau \xleftarrow{\$} \mathbb{F}_q\cr
\cr
&amp;\underline{
  \text{Ready}^\tau_i(S):
}\cr
  &amp;\enspace
    \text{ready}^\tau\_{ij} \gets \texttt{true}\ (\forall j \in S)
  \cr
\cr
&amp;\underline{
  \text{WaitReady}^\tau_i(S):
}\cr
  &amp;\enspace
    \texttt{wait}\_{(i, 1)} \forall j \in \mathcal{S}.\ \text{ready}^\tau\_{ji}
  \cr
\cr
&amp;\underline{
  \text{Sig}^\tau_i():
}\cr
  &amp;\enspace
    \texttt{wait}\_{(i, 1)} \forall j \in \mathcal{P}. \exists i.\ \text{ready}^\tau\_{ji}
  \cr
  &amp;\enspace
    m \gets \text{GetMessage}^\tau()
  \cr
  &amp;\enspace
    R \gets \frac{1}{k^\tau} \cdot G
  \cr
  &amp;\enspace
    s \gets k \cdot (\text{Hash}(m) + x(R) \cdot x)
  \cr
  &amp;\enspace
    \texttt{return } (R, s)
  \cr
\cr
&amp;\underline{
  \text{Leak}^\tau():
}\cr
  &amp;\enspace
    \texttt{return } (x \cdot G, xk^\tau \cdot G, k^\tau \cdot G, \frac{1}{k^\tau} \cdot G)
  \cr
\end{aligned}
}
}\cr
\circledcirc\cr
F[\text{Messages}]\cr
\otimes\cr
F[\text{Sync}]^\mathbb{N}\cr
\circledcirc \cr
F[\text{Stop}]
\end{matrix}\cr
\cr
\text{Leakage} := \{\texttt{stop}, \text{SetMessage}^\tau, \text{GetMessage}^\tau, \text{Leak}^\tau\}
\end{matrix}
}
\lhd \mathscr{P}[\text{Presign}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-21.5932em;height:43.6864em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:22.0932em;"><span style="top:-45.6864em;"><span class="pstrut" style="height:45.6864em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:21.7532em;"><span style="top:-41.6064em;"><span class="pstrut" style="height:21.0532em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2em;"><span style="top:-3.2em;"><span class="pstrut" style="height:3.8em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.8em;"></span></span><span style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord boxpad"><span class="mord mathscr sizing reset-size6 size7" style="margin-right:0.0808em;">P</span><span class="mopen sizing reset-size6 size7">[</span><span class="mord text sizing reset-size6 size7"><span class="mord">I</span><span class="mord">d</span><span class="mord">e</span><span class="mord">a</span><span class="mord">l</span><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose sizing reset-size6 size7">]</span><span class="mord sizing reset-size6 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6em;"><span></span></span></span></span></span></span></span><span style="top:-40.1664em;"><span class="pstrut" style="height:21.0532em;"></span><span class="mord"></span></span><span style="top:-20.7532em;"><span class="pstrut" style="height:21.0532em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5655em;"><span style="top:-12.681em;"><span class="pstrut" style="height:12.681em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.8061em;"><span style="top:-7.8061em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-6.1661em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-4.6661em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-3.065em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-1.565em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:-0.065em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span><span style="top:1.435em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.3061em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.8061em;"><span style="top:-7.8061em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2111em;"><span style="top:-3.2111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.7111em;"></span></span><span style="top:-3.7111em;"><span class="pstrut" style="height:3.7111em;"></span><span class="mord boxpad"><span class="mord sizing reset-size5 size7"><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:-0.1389em;top:-2.65em;margin-right:0.0417em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span><span style="top:-4.6661em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:-3.065em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-1.565em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">W</span><span class="mord">a</span><span class="mord">i</span><span class="mord">t</span><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-0.065em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">R</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.3389em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋆</span><span class="mclose">)</span></span></span><span style="top:1.435em;"><span class="pstrut" style="height:3.2111em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.3061em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-7.5655em;"><span class="pstrut" style="height:12.681em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:10.681em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.1155em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:19.0532em;"><span style="top:-21.0532em;"><span class="pstrut" style="height:17.4256em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:15.4256em;"><span style="top:-32.4012em;"><span class="pstrut" style="height:32.4012em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:16.7618em;"><span style="top:-18.7832em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-17.0099em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-15.5099em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-13.7279em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-12.2279em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-10.7279em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-9.1268em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-7.6268em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-6.1268em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-4.5257em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-3.0257em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:-1.5257em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:0.0754em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:1.5754em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:3.5569em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:5.3829em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:6.8829em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:8.3829em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:9.8829em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span><span style="top:11.9543em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:16.2618em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:16.7618em;"><span style="top:-18.7832em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3em;"><span style="top:-3.3em;"><span class="pstrut" style="height:3.9333em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.9333em;"></span></span><span style="top:-3.9333em;"><span class="pstrut" style="height:3.9333em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.1389em;">F</span><span class="mopen sizing reset-size5 size7">[</span><span class="mord text sizing reset-size5 size7"><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose sizing reset-size5 size7">]</span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6333em;"><span></span></span></span></span></span></span></span><span style="top:-15.5099em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">r</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">ij</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">false</span></span></span></span><span style="top:-13.7279em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400000 522" width="400em" preserveAspectRatio="xMinYMin slice" height="0.522em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:-10.7279em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">R</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:-9.1268em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">r</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">ij</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">true</span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mclose">)</span></span></span><span style="top:-6.1268em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">W</span><span class="mord">a</span><span class="mord">i</span><span class="mord">t</span><span class="mord">R</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:-4.5257em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">wait</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.075em;">S</span><span class="mord">.</span><span class="mspace"> </span><span class="mord"><span class="mord text"><span class="mord">r</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal">ji</span></span></span></span><span style="top:-1.5257em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:0.0754em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">wait</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0822em;">P</span><span class="mord">.</span><span class="mord">∃</span><span class="mord mathnormal">i</span><span class="mord">.</span><span class="mspace"> </span><span class="mord"><span class="mord text"><span class="mord">r</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal">ji</span></span></span></span><span style="top:1.5754em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">G</span><span class="mord">e</span><span class="mord">t</span><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:3.5569em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter sizing reset-size5 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.576em;"><span style="margin-right:0.0556em;top:-2.889em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size5 size6"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:5.3829em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">H</span><span class="mord">a</span><span class="mord">s</span><span class="mord">h</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:6.8829em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span><span style="top:9.8829em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">L</span><span class="mord">e</span><span class="mord">a</span><span class="mord">k</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:11.9543em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter sizing reset-size5 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.576em;"><span style="top:-2.889em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size5 size6"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:16.2618em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-17.4256em;"><span class="pstrut" style="height:32.4012em;"></span><span class="stretchy fbox" style="height:30.4012em;border-width:0.04em;border-style:solid;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:14.9756em;"><span></span></span></span></span></span></span></span><span style="top:-5.2376em;"><span class="pstrut" style="height:17.4256em;"></span><span class="mord"><span class="mord amsrm">⊚</span></span></span><span style="top:-4.0376em;"><span class="pstrut" style="height:17.4256em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span><span class="mord">s</span></span><span class="mclose">]</span></span></span><span style="top:-2.8376em;"><span class="pstrut" style="height:17.4256em;"></span><span class="mord"><span class="mord">⊗</span></span></span><span style="top:-1.6324em;"><span class="pstrut" style="height:17.4256em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">y</span><span class="mord">n</span><span class="mord">c</span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8452em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbb mtight">N</span></span></span></span></span></span></span></span></span></span><span style="top:-0.4324em;"><span class="pstrut" style="height:17.4256em;"></span><span class="mord"><span class="mord amsrm">⊚</span></span></span><span style="top:0.7676em;"><span class="pstrut" style="height:17.4256em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">t</span><span class="mord">o</span><span class="mord">p</span></span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:18.5532em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.36em;"><span class="pstrut" style="height:21.0532em;"></span><span class="mord"></span></span><span style="top:-0.16em;"><span class="pstrut" style="height:21.0532em;"></span><span class="mord"><span class="mord text"><span class="mord">L</span><span class="mord">e</span><span class="mord">a</span><span class="mord">k</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">e</span><span class="mord">t</span><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7376em;"><span style="margin-right:0.05em;top:-3.1362em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">G</span><span class="mord">e</span><span class="mord">t</span><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7376em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">L</span><span class="mord">e</span><span class="mord">a</span><span class="mord">k</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7487em;"><span style="margin-right:0.05em;top:-3.1473em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:21.2532em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-24.0932em;"><span class="pstrut" style="height:45.6864em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:43.6864em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:21.5932em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin amsrm">⊲</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span></span></span></span></span></span>
<p>The ideal functionality unfortunately has to reflect
the round timing of the protocol itself.</p>
<p><strong>Lemma:</strong></p>
<p>For a negligible <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span>, and up to <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.0833em;height:0.6984em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span> malicious corruptions, we have:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>Sign</mtext><mo stretchy="false">]</mo><mo><mover><mo><mo>⇝</mo></mo><mi>ϵ</mi></mover></mo><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>IdealSign</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathscr{P}[\text{Sign}] \overset{\epsilon}{\leadsto} \mathscr{P}[\text{IdealSign}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2293em;vertical-align:-0.25em;"></span><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9793em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop amsrm">⇝</span></span></span><span style="top:-3.5779em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">I</span><span class="mord">d</span><span class="mord">e</span><span class="mord">a</span><span class="mord">l</span><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span></span></span></span></span></span>
<p><strong>Proof:</strong></p>
<p>First, we can replace <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>Presign</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathscr{P}[\text{Presign}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span></span></span></span></span> with <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi><mo stretchy="false">[</mo><mtext>IdealPresign</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathscr{P}[\text{IdealPresign}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathscr" style="margin-right:0.0808em;">P</span><span class="mopen">[</span><span class="mord text"><span class="mord">I</span><span class="mord">d</span><span class="mord">e</span><span class="mord">a</span><span class="mord">l</span><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mclose">]</span></span></span></span></span>.</p>
<p>From there, we can use a similar simulator as last time:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable columnspacing="1em" columnalign="center" rowspacing="0.16em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mpadded width="+6pt" lspace="3pt" voffset="3pt" mathbackground="#FBCFE8" height="+6pt"><mstyle mathsize="1.2em"><mstyle displaystyle="false" scriptlevel="0"><msubsup><mi mathvariant="normal">Γ</mi><mi>H</mi><mn>0</mn></msubsup></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>…</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose><mo>⊗</mo><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mstyle mathsize="0.9em"><mtable columnspacing="0em" rowspacing="0.25em" columnalign="right left"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mpadded height="+6pt" mathbackground="#bae6fd" width="+6pt" lspace="3pt" voffset="3pt"><mstyle mathsize="1.2em"><mstyle scriptlevel="0" displaystyle="false"><mi>S</mi></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msup><mi>k</mi><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mi>i</mi><mo separator="true">,</mo><msup><mi>σ</mi><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mi>i</mi><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded lspace="0.3em" width="+0.6em"><mi mathvariant="normal">$</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub><mtext> </mtext><mo stretchy="false">(</mo><mi>i</mi><mo>∈</mo><mi mathvariant="script">M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>k</mi><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mi>i</mi><mo separator="true">,</mo><msup><mi>σ</mi><mi>τ</mi></msup><mi mathvariant="normal">_</mi><mi>i</mi><mo>←</mo><mi mathvariant="normal">⊥</mi><mtext> </mtext><mo stretchy="false">(</mo><mi>i</mi><mo>∈</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>s</mi><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>←</mo><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><msup><mtext>XK</mtext><mi>τ</mi></msup><mo separator="true">,</mo><msup><mi>K</mi><mi>τ</mi></msup><mo separator="true">,</mo><msup><mi>R</mi><mi>τ</mi></msup><mo stretchy="false">)</mo><mo>←</mo><msup><mtext>Leak</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mtext>Presign</mtext><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mtext>Ready</mtext><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mi mathvariant="script">M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msup><mi>K</mi><mi>τ</mi></msup><mo separator="true">,</mo><msup><mi>R</mi><mi>τ</mi></msup><mo separator="true">,</mo><msubsup><mi>k</mi><mi>k</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>σ</mi><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><msup><mtext>K</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><msup><mi>K</mi><mi>τ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><msup><mtext>XK</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><msup><mtext>XK</mtext><mi>τ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mo>↰</mo><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>m</mi><mi mathvariant="normal">_</mi><mo>∙</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mtext mathvariant="monospace">wait</mtext><mi mathvariant="normal">_</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mi mathvariant="normal">∀</mi><mi>j</mi><mo>∈</mo><mi>S</mi><mo>∩</mo><mi mathvariant="script">M</mi><mi mathvariant="normal">.</mi><mtext> </mtext><mi>s</mi><mi mathvariant="normal">_</mi><mrow><mi>j</mi><mi>k</mi></mrow><mi mathvariant="normal">≠</mi><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mi>r</mi><mi mathvariant="normal">_</mi><mo>∙</mo><mo>←</mo><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msub><mi>r</mi><mi>j</mi></msub><mo>←</mo><mi>s</mi><mi mathvariant="normal">_</mi><mrow><mi>j</mi><mi>k</mi></mrow><mtext> </mtext><mo stretchy="false">(</mo><mi>j</mi><mo>∈</mo><mi>S</mi><mo>∩</mo><mi mathvariant="script">M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mtext>WaitReady</mtext><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mi>S</mi><mo>∩</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">for</mtext><mtext> </mtext></mrow><mi>j</mi><mo>∈</mo><mi>S</mi><mo>∩</mo><mi mathvariant="script">H</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mi>m</mi><mo>←</mo><msup><mtext>GetMessage</mtext><mi>τ</mi></msup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mi mathvariant="normal">∣</mi><mo stretchy="false">{</mo><mi>i</mi><mo>∈</mo><mi mathvariant="script">H</mi><mo>∣</mo><msubsup><mi>k</mi><mi>i</mi><mi>τ</mi></msubsup><mo>=</mo><mi mathvariant="normal">⊥</mi><mo stretchy="false">}</mo><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mspace width="0.5em"/><msubsup><mi>k</mi><mi>j</mi><mi>τ</mi></msubsup><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded lspace="0.3em" width="+0.6em"><mi mathvariant="normal">$</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mspace width="0.5em"/><mi>s</mi><mo>←</mo><msubsup><mtext>Sig</mtext><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mspace width="0.5em"/><msubsup><mi>σ</mi><mi>j</mi><mi>τ</mi></msubsup><mo>←</mo><mfrac><mn>1</mn><mrow><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>⋅</mo><mrow><mo fence="true">(</mo><mi>s</mi><mo>−</mo><mtext>Hash</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>⋅</mo><munder><mo>∑</mo><mi>i</mi></munder><msubsup><mi>k</mi><mi>i</mi><mi>τ</mi></msubsup><mo>−</mo><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo>∑</mo><mi mathvariant="normal">_</mi><mrow><mi>i</mi><mi mathvariant="normal">≠</mi><mi>j</mi></mrow><msubsup><mi>σ</mi><mi>j</mi><mi>τ</mi></msubsup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mtext mathvariant="monospace">else</mtext><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mspace width="0.5em"/><msubsup><mi>k</mi><mi>j</mi><mi>τ</mi></msubsup><mo separator="true">,</mo><msubsup><mi>σ</mi><mi>j</mi><mi>τ</mi></msubsup><mover><mo minsize="1.75em" stretchy="true">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi mathvariant="normal">$</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><msub><mi>r</mi><mi>j</mi></msub><mo>←</mo><mtext>Hash</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>⋅</mo><msubsup><mi>k</mi><mi>j</mi><mi>τ</mi></msubsup><mo>+</mo><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>⋅</mo><msubsup><mi>σ</mi><mi>j</mi><mi>τ</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mi>r</mi><mi mathvariant="normal">_</mi><mo>∙</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><msubsup><mo>↱</mo><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>m</mi><mi mathvariant="normal">_</mi><mo>∙</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><msubsup><mtext>Ready</mtext><mi>k</mi><mi>τ</mi></msubsup><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">for</mtext><mtext> </mtext></mrow><mi>j</mi><mo>∈</mo><mi>S</mi><mi mathvariant="normal">.</mi><mtext> </mtext><mi>s</mi><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mi>j</mi></mrow><mo>=</mo><mi mathvariant="normal">⊥</mi><mo>:</mo><mtext> </mtext><mi>s</mi><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mi>j</mi></mrow><mo>←</mo><msub><mi>m</mi><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">for</mtext><mtext> </mtext></mrow><mi>j</mi><mo>∈</mo><mi mathvariant="script">H</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">∀</mi><mi>k</mi><mo>∈</mo><mi mathvariant="script">M</mi><mi mathvariant="normal">.</mi><mi>s</mi><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mi>j</mi></mrow><mi mathvariant="normal">≠</mi><mi mathvariant="normal">⊥</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mo>∑</mo><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mo>∈</mo><mi mathvariant="script">M</mi></mrow><mi>s</mi><mi mathvariant="normal">_</mi><mrow><mi>k</mi><mi>j</mi></mrow><mi mathvariant="normal">≠</mi><mtext>Hash</mtext><mo stretchy="false">(</mo><msup><mi>m</mi><mi>τ</mi></msup><mo stretchy="false">)</mo><mo>⋅</mo><munder><mo>∑</mo><mi>k</mi></munder><msubsup><mi>k</mi><mi>k</mi><mi>τ</mi></msubsup><mo>+</mo><mi>x</mi><mo stretchy="false">(</mo><msup><mi>R</mi><mi>τ</mi></msup><mo stretchy="false">)</mo><mo>⋅</mo><munder><mo>∑</mo><mi>k</mi></munder><msubsup><mi>σ</mi><mi>k</mi><mi>τ</mi></msubsup><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="0.5em"/><mspace width="0.5em"/><mspace width="0.5em"/><mtext mathvariant="monospace">stop</mtext><mo stretchy="false">(</mo><mo stretchy="false">{</mo><mi>j</mi><mo stretchy="false">}</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>…</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></mstyle></menclose></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mo rspace="0em" lspace="0em">∘</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>F</mi><mo stretchy="false">[</mo><mtext>Messages</mtext><mo stretchy="false">]</mo><mo>⊚</mo><mi>F</mi><mo stretchy="false">[</mo><mtext>Stop</mtext><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}
\boxed{
\begin{aligned}
&amp;\colorbox{FBCFE8}{\large
  $\Gamma^0_H$
}\cr
&amp;\ldots
\end{aligned}
}
\otimes
\boxed{
\small{
\begin{aligned}
&amp;\colorbox{bae6fd}{\large
  $S$
}\cr
&amp;x_i, k^\tau\_i, \sigma^\tau\_i \xleftarrow{\$} \mathbb{F}_q\ (i \in \mathcal{M})\cr
&amp;k^\tau\_i, \sigma^\tau\_i \gets \bot\ (i \in \mathcal{H})\cr
&amp;s\_{ij} \gets \bot\cr
&amp;(X, \text{XK}^\tau, K^\tau, R^\tau) \gets \text{Leak}^\tau()\cr
\cr
&amp;\underline{
  \text{Presign}^\tau_k():
}\cr
  &amp;\enspace
    \text{Ready}^\tau_k(\mathcal{M})
  \cr
  &amp;\enspace
    \texttt{return } (X, x_i, K^\tau, R^\tau, k^\tau_k, \sigma^\tau_k)
  \cr
\cr
&amp;\underline{
  \text{K}^\tau():
}\cr
  &amp;\enspace
    \texttt{return } K^\tau
  \cr
\cr
\cr
&amp;\underline{
  \text{XK}^\tau():
}\cr
  &amp;\enspace
    \texttt{return } \text{XK}^\tau
  \cr
\cr
&amp;\underline{
  \Lsh^\tau_k(S, m\_\bullet, 1):
}\cr
  &amp;\enspace
    \texttt{wait}\_{(k, 1)} \forall j \in S \cap \mathcal{M}.\ s\_{jk} \neq \bot
  \cr
  &amp;\enspace
    r\_\bullet \gets \bot
  \cr
  &amp;\enspace
    r_j \gets s\_{jk}\ (j \in S \cap \mathcal{M})
  \cr
  &amp;\enspace
    \text{WaitReady}^\tau_k(S \cap \mathcal{H})
  \cr
  &amp;\enspace
    \texttt{for } j \in S \cap \mathcal{H}:
  \cr
  &amp;\enspace\enspace
    m \gets \text{GetMessage}^\tau()
  \cr
  &amp;\enspace\enspace
    \texttt{if } |\{ i \in \mathcal{H} \mid k^\tau_i = \bot \}| = 1:
  \cr
  &amp;\enspace\enspace\enspace
    k^\tau_j \xleftarrow{\$} \mathbb{F}_q
  \cr
  &amp;\enspace\enspace\enspace
    s \gets \text{Sig}^\tau_k()
  \cr
  &amp;\enspace\enspace\enspace
    \sigma^\tau_j \gets \frac{1}{x(R)}\cdot \left(
      s - \text{Hash}(m) \cdot \sum_i k^\tau_i - x(R) \cdot \sum\_{i \neq j} \sigma^\tau_j
    \right)
  \cr
  &amp;\enspace\enspace
    \texttt{else}:
  \cr
  &amp;\enspace\enspace\enspace
    k^\tau_j, \sigma^\tau_j \xleftarrow{\$} \mathbb{F}_q
  \cr
  &amp;\enspace\enspace
    r_j \gets \text{Hash}(m) \cdot k^\tau_j + x(R) \cdot \sigma^\tau_j
  \cr
  &amp;\enspace
    \texttt{return } r\_\bullet
  \cr
\cr
&amp;\underline{
  \Rsh^\tau_k(S, m\_\bullet, 1):
}\cr
  &amp;\enspace
    \text{Ready}^\tau_k(S)
  \cr
  &amp;\enspace
    \texttt{for } j \in S.\ s\_{kj} = \bot:\ s\_{kj} \gets m_j
  \cr
  &amp;\enspace
    \texttt{for } j \in \mathcal{H}. \forall k \in \mathcal{M}. s\_{kj} \neq \bot:
  \cr
  &amp;\enspace\enspace
    \texttt{if } \sum\_{k \in \mathcal{M}} s\_{kj} \neq \text{Hash}(m^\tau) \cdot \sum_k k^\tau_k + x(R^\tau) \cdot \sum_k \sigma^\tau_k:
  \cr
  &amp;\enspace\enspace\enspace
    \texttt{stop}(\{j\}, 1)
  \cr
&amp;\ldots\cr
\end{aligned}
}
}
\cr
\circ\cr
F[\text{Messages}] \circledcirc F[\text{Stop}]
\end{matrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-30.5897em;height:61.6794em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:31.0897em;"><span style="top:-33.0897em;"><span class="pstrut" style="height:31.8647em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.4171em;"><span style="top:-6.3342em;"><span class="pstrut" style="height:6.3342em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0771em;"><span style="top:-4.0771em;"><span class="pstrut" style="height:3.2512em;"></span><span class="mord"></span></span><span style="top:-2.334em;"><span class="pstrut" style="height:3.2512em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5771em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0771em;"><span style="top:-4.0771em;"><span class="pstrut" style="height:3.2512em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2512em;"><span style="top:-3.2512em;"><span class="pstrut" style="height:3.8542em;"></span><span class="stretchy colorbox" style="height:1.8542em;background-color:#FBCFE8;"></span></span><span style="top:-3.8542em;"><span class="pstrut" style="height:3.8542em;"></span><span class="mord boxpad"><span class="mord sizing reset-size6 size7"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7926em;"><span style="margin-right:0.0417em;top:-2.5474em;margin-left:0em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0813em;">H</span></span></span><span style="top:-3.163em;margin-right:0.0417em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2526em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6031em;"><span></span></span></span></span></span></span></span><span style="top:-2.334em;"><span class="pstrut" style="height:3.2512em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5771em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-4.4171em;"><span class="pstrut" style="height:6.3342em;"></span><span class="stretchy fbox" style="border-style:solid;border-width:0.04em;height:4.3342em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9171em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:29.8647em;"><span style="top:-61.2794em;"><span class="pstrut" style="height:61.2794em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord sizing reset-size6 size5"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:32.8052em;"><span style="top:-35.5136em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-33.7316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-32.2316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-30.7316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-29.2316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-27.7316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-26.2316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-24.6304em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-23.1304em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-21.6304em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-20.1304em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-18.5404em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-17.0404em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-15.5404em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-14.0404em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-12.4504em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-10.9504em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-9.4504em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-7.8004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-6.3004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-4.8004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-3.3004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-1.8004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:-0.3004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:1.1996em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:2.9816em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:4.4982em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:7.0776em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:9.6315em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:11.4135em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:12.9302em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:14.4468em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:15.9468em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:17.4468em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:19.0968em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:20.5968em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:22.0968em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:23.8068em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:26.2258em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span><span style="top:27.7258em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:32.3052em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:32.8052em;"><span style="top:-35.5136em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2111em;"><span style="top:-3.2111em;"><span class="pstrut" style="height:3.5111em;"></span><span class="stretchy colorbox" style="background-color:#bae6fd;height:1.5111em;"></span></span><span style="top:-3.5111em;"><span class="pstrut" style="height:3.5111em;"></span><span class="mord boxpad"><span class="mord mathnormal sizing reset-size5 size7" style="margin-right:0.0576em;">S</span><span class="mord sizing reset-size5 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3em;"><span></span></span></span></span></span></span></span><span style="top:-33.7316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin slice" height="0.522em" viewBox="0 0 400000 522" width="400em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span><span class="mclose">)</span></span></span><span style="top:-32.2316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span><span class="mclose">)</span></span></span><span style="top:-30.7316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">s</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">ij</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:-29.2316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">X</span><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">L</span><span class="mord">e</span><span class="mord">a</span><span class="mord">k</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:-26.2316em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.5789em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">P</span><span class="mord">r</span><span class="mord">e</span><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.3389em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4611em;"><span></span></span></span></span></span></span></span><span style="top:-24.6304em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">R</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.3389em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathcal">M</span><span class="mclose">)</span></span></span><span style="top:-23.1304em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:-0.0315em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-left:-0.0359em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-20.1304em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:-18.5404em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0715em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span></span><span style="top:-14.0404em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">X</span><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:-12.4504em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord"><span class="mord text"><span class="mord">X</span><span class="mord">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span></span></span><span style="top:-9.4504em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.53em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel"><span class="mrel amsrm">↰</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.51em;"><span></span></span></span></span></span></span></span><span style="top:-7.8004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">wait</span></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathcal">M</span><span class="mord">.</span><span class="mspace"> </span><span class="mord mathnormal">s</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">jk</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="vertical-align:-0.1944em;height:0.8889em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:-6.3004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal" style="margin-right:0.0278em;">r</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:-4.8004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0278em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="top:-2.45em;margin-left:-0.0278em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">s</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">jk</span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathcal">M</span><span class="mclose">)</span></span></span><span style="top:-3.3004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">W</span><span class="mord">a</span><span class="mord">i</span><span class="mord">t</span><span class="mord">R</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span><span class="mclose">)</span></span></span><span style="top:-1.8004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">for </span></span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:-0.3004em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">G</span><span class="mord">e</span><span class="mord">t</span><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:1.1996em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord">∣</span><span class="mopen">{</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0315em;top:-2.353em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span><span class="mclose">}</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:2.9816em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-left:-0.0315em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin slice" height="0.522em" viewBox="0 0 400000 522" width="400em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:4.4982em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mclose">)</span></span></span><span style="top:7.0776em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-left:-0.0359em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter sizing reset-size5 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size5 size6"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen sizing reset-size5 size6 delimcenter" style="top:0.025em;"><span class="delimsizing size4">(</span></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">H</span><span class="mord">a</span><span class="mord">s</span><span class="mord">h</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="margin-left:0em;top:-1.8943em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2557em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-right:0.0556em;margin-left:-0.0315em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-right:0.0556em;margin-left:-0.0359em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mclose sizing reset-size5 size6 delimcenter" style="top:0.025em;"><span class="delimsizing size4">)</span></span></span></span></span><span style="top:9.6315em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">else</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:11.4135em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;margin-left:-0.0315em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.353em;margin-left:-0.0359em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.122em;"><span style="top:-3.222em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mtight">$</span></span></span></span><span style="top:-2.589em;"><span class="pstrut" style="height:2.6em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice" width="400em" height="0.522em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.137em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:12.9302em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0278em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-right:0.0556em;top:-2.45em;margin-left:-0.0278em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">H</span><span class="mord">a</span><span class="mord">s</span><span class="mord">h</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;margin-left:-0.0315em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-left:-0.0359em;margin-right:0.0556em;top:-2.353em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3766em;"><span></span></span></span></span></span></span></span></span><span style="top:14.4468em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord mathnormal" style="margin-right:0.0278em;">r</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span></span></span><span style="top:17.4468em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.53em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel"><span class="mrel amsrm">↱</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:0em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord">∙</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.51em;"><span></span></span></span></span></span></span></span><span style="top:19.0968em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord text"><span class="mord">R</span><span class="mord">e</span><span class="mord">a</span><span class="mord">d</span><span class="mord">y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-2.3389em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2611em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mclose">)</span></span></span><span style="top:20.5968em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">for </span></span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mord">.</span><span class="mspace"> </span><span class="mord mathnormal">s</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">kj</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace"> </span><span class="mord mathnormal">s</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">kj</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2897em;"><span style="margin-left:0em;margin-right:0.0556em;top:-2.45em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796em;"><span></span></span></span></span></span></span></span></span><span style="top:22.0968em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">for </span></span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0097em;">H</span><span class="mord">.</span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span><span class="mord">.</span><span class="mord mathnormal">s</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">kj</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="vertical-align:-0.1944em;height:0.8889em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:23.8068em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">if </span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-symbol large-op" style="top:0em;position:relative;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span></span><span class="mord mathnormal">s</span><span class="mord" style="margin-right:0.0278em;">_</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0572em;">kj</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">H</span><span class="mord">a</span><span class="mord">s</span><span class="mord">h</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.871em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.279em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:-0.0315em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.013em;margin-right:0.0556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0077em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.871em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.279em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span style="margin-right:0.0556em;top:-2.353em;margin-left:-0.0359em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span><span style="margin-right:0.0556em;top:-3.013em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:26.2258em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord text"><span class="mord texttt">stop</span></span><span class="mopen">({</span><span class="mord mathnormal" style="margin-right:0.0572em;">j</span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:27.7258em;"><span class="pstrut" style="height:3.9194em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:32.3052em;"><span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-31.8647em;"><span class="pstrut" style="height:61.2794em;"></span><span class="stretchy fbox" style="height:59.2794em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:29.4147em;"><span></span></span></span></span></span></span></span><span style="top:-2.835em;"><span class="pstrut" style="height:31.8647em;"></span><span class="mord"><span class="mord">∘</span></span></span><span style="top:-1.635em;"><span class="pstrut" style="height:31.8647em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">M</span><span class="mord">e</span><span class="mord">s</span><span class="mord">s</span><span class="mord">a</span><span class="mord">g</span><span class="mord">e</span><span class="mord">s</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin amsrm">⊚</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.1389em;">F</span><span class="mopen">[</span><span class="mord text"><span class="mord">S</span><span class="mord">t</span><span class="mord">o</span><span class="mord">p</span></span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:30.5897em;"><span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>The strategy is the same as other simulators in this section, where
we use the fact that only the sum has to verify
correctly, in order to give junk values up until the last moment.</p>
<p><span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em;"></span><span class="mord amsrm">■</span></span></span></span></span></p>
<h1>The security of using presignatures</h1>
<p>Here, we've limited ourselves to showing that our protocol
implements "ECDSA with presignatures",
as far as the security of "ECDSA with presignatures"
as a threshold signature scheme,
see <a href=https://eprint.iacr.org/2021/1330>Groth & Shoup 2021</a>.</p><section class="footnotes">
<ol>
</ol>
</section>


</body>
</html>