<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>cronokirby - Canetti et al's Paradoxical Encryption Scheme</title>
<meta name="description" content="When proving security, Cryptographers often model hash functions as random oracles, which act like random functions. In practice, hash functions are different f">
<meta name="google-site-verification" content="L52nFdg1z0h1iXWgwFjYNRl14XgaybiiL_UbPpm6-Mc" />
<link rel="canonical" href="https://cronokirby.com/posts/canetti-et-als-paradoxical-encryption-scheme.html">
<meta property="og:title" content="Canetti et al's Paradoxical Encryption Scheme">
<meta property="og:description" content="When proving security, Cryptographers often model hash functions as random oracles, which act like random functions. In practice, hash functions are different f">
<meta property="og:url" content="https://cronokirby.com/posts/canetti-et-als-paradoxical-encryption-scheme.html">
<meta property="og:site_name" content="cronokirby">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Canetti et al's Paradoxical Encryption Scheme">
<meta name="twitter:description" content="When proving security, Cryptographers often model hash functions as random oracles, which act like random functions. In practice, hash functions are different f">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css" integrity="sha384-Pu5+C18nP5dwykLJOhd2U4Xen7rjScHN/qusop27hdd2drI+lL5KvX7YntvT8yew" crossorigin="anonymous">

<link rel="stylesheet" href="/static/index.css">
<link rel="icon" href="/static/icon.png">
<script src="/static/theme.js" defer></script>
</head>
<body>
<header>
<div class="icon-bar">
  <a href="/">
    <img src="/static/icon.png" class="avatar" alt="cronokirby" />
  </a>
  <button class="theme-toggle" id="theme-toggle">
    <svg xmlns="http://www.w3.org/2000/svg" height="2em" viewBox="0 -960 960 960" width="2em" fill="currentColor"><path d="M480-120q-133 0-226.5-92.5T160-436q0-66 25-122t69-100l226-222 226 222q44 44 69 100t25 122q0 131-93.5 223.5T480-120Zm0-80v-568L310-600q-35 33-52.5 74.5T240-436q0 97 70 166.5T480-200Z"/></svg>
  </button>
</div>
<time datetime="2022-04-23">2022-04-23</time>

<h1>Canetti et al's Paradoxical Encryption Scheme</h1>




<ul class="tags">

  <li class="tag">
    <a href="/tag/cryptography/index.html">
    #cryptography
    </a>
  </li>

</ul>

</header>

<p>When proving security, Cryptographers often model hash functions
as random oracles, which act like random functions. In practice,
hash functions are different from random oracles. The question is: does this
difference impact security?</p><!--more-->
<p>It turns out that it does. In 1998, Ran Canetti, Oded Goldreich, and Shai
Halevi <a href=https://eprint.iacr.org/1998/011.pdf>constructed an example</a> of an encryption scheme which
was <em>secure</em> with random oracles, but <em>insecure</em> if any concrete
hash function were to be used. This example shows that, in general,
proving that a scheme is secure with random oracles is not enough
to show that it's secure with a real hash function.</p>
<p>I'll be trying to present this fun little result in a more informal
way, leaning on some of the natural intuition we have about
how computer programs work, instead of the heavier formalisms used
in their paper.</p>
<h1>The Ideal of the Random Oracle</h1>
<p>A <em>random oracle</em> is not really something that exists:
rather, it is a <em>technique</em> we use to reason about security. We
model some component of a Cryptographic scheme <em>as</em> a random
oracle, and study the security of that scheme with this model.
We often say that some scheme is secure "in the random oracle model",
when talking about security proofs made using this technique.</p>
<h2>Example: Hybrid Encryption</h2>
<p>As an example, let's consider a scheme using <em>hybrid encryption</em>.
We'll combine a Diffie-Hellman key-exchange, with a symmetric
encryption scheme, to create an <em>asymmetric</em> encryption
scheme.</p>
<p>The private key will be a scalar <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">x \in \mathbb{F}_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.0391em;height:0.5782em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.975em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span>,
and the associated public key will be the point
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>:</mo><mo>=</mo><mi>x</mi><mo>⋅</mo><mi>G</mi><mo>∈</mo><mi mathvariant="double-struck">G</mi></mrow><annotation encoding="application/x-tex">{X := x \cdot G \in \mathbb{G}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.0391em;height:0.728em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">G</span></span></span></span></span></span>.</p>
<p>Encrypting a message can be described with three steps:</p>
<ol><li>Generate a random key pair <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>e</mi><mo separator="true">,</mo><mi>E</mi><mo>:</mo><mo>=</mo><mi>e</mi><mo>⋅</mo><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(e, E := e \cdot G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span></span>, and obtain the shared secret <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mi>e</mi><mo>⋅</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">{S := e \cdot X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0576em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span></span></span></span></span></span>.</li><li>Derive a symmetric key <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span></span></span></span></span> from this secret.</li><li>Encrypt the message <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span> using <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span></span></span></span></span>, to obtain <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span>. Join <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span> with <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span></span></span></span></span> to produce the ciphertext <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>E</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(E, c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span></span>.</li></ol>
<p>Step 2 is where we bridge points in the group with
keys for our symmetric encryption. In practice, this is usually done
with a hash function <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>:</mo><mi mathvariant="double-struck">G</mi><mo>→</mo><mi mathvariant="script">K</mi></mrow><annotation encoding="application/x-tex">H : \mathbb{G} \to \mathcal{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.0144em;">K</span></span></span></span></span>.
A random oracle is used to <em>model</em> how this hash function behaves.
The idea is that this function should act like a randomly
chosen function. There shouldn't be any way to predict
what the output of the function will be, without actually
calling the function.</p>
<p>This random oracle
is like a gnome in a box generating random
outputs for our function. When we give an input to the gnome,
it will check if it's already decided on an output, and
generate a random output otherwise.</p>
<p>
<img src=../Images/2a5af12b5b3221418166c7f1907f2764d41bb703929d2074130aa784c6319606.png alt= /></p>
<p>In practice, we don't actually need to talk about gnomes
when proving the security of schemes. Instead, this book-keeping
is managed as part of the game we use to model security.</p>
<p>To illustrate, let's look at the <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>IND-CPA</mtext></mrow><annotation encoding="application/x-tex">\text{IND-CPA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">I</span><span class="mord">N</span><span class="mord">D</span><span class="mord">-</span><span class="mord">C</span><span class="mord">P</span><span class="mord">A</span></span></span></span></span></span> security
of this hybrid encryption scheme.</p>
<blockquote>
<p>[!note] <strong>Note:</strong>
I've been getting into the somewhat unorthodox library based presentation of security games, as featured in
<a href=https://joyofcryptography.com/>The Joy of Cryptography</a>,
so I'm going to present things in this style. Feel free
to skim over the security game aspects: they're secondary
to the point I'm trying to get at.</p></blockquote>
<p>We model the security of this encryption scheme as two
libraries <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="margin-right:0.05em;top:-2.55em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="true"><mtable columnalign="right left" rowspacing="0.25em" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mpadded lspace="3pt" width="+6pt" voffset="3pt" height="+6pt" mathbackground="#FBCFE8"><mstyle mathsize="1.2em"><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mi>b</mi></msub></mstyle><mtext> </mtext></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi>R</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>X</mi><mo>:</mo><mo>=</mo><mi>x</mi><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><mrow><mi mathvariant="monospace">P</mi><mi mathvariant="monospace">k</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><mo>:</mo><mi mathvariant="double-struck">G</mi></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mi>X</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><mrow><mi mathvariant="monospace">C</mi><mi mathvariant="monospace">h</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">l</mi><mi mathvariant="monospace">l</mi><mi mathvariant="monospace">e</mi><mi mathvariant="monospace">n</mi><mi mathvariant="monospace">g</mi><mi mathvariant="monospace">e</mi></mrow><mo stretchy="false">(</mo><msub><mi>m</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>m</mi><mn>1</mn></msub><mo>:</mo><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>:</mo><mi mathvariant="double-struck">G</mi><mo>×</mo><mi mathvariant="script">C</mi></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mi>e</mi><mover><mo minsize="1.75em" stretchy="true">←</mo><mpadded lspace="0.3em" width="+0.6em"><mi>R</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mi>E</mi><mo>:</mo><mo>=</mo><mi>e</mi><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mi>k</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>e</mi><mo>⋅</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mi>c</mi><mo>:</mo><mo>=</mo><mtext>Enc</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>E</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\begin{aligned}
&amp;\colorbox{#FBCFE8}{\large
  $\mathcal{L}_{b}$
}\cr
\cr
&amp;x \xleftarrow{R} \mathbb{F}_q\cr
&amp;X := x \cdot G\cr
\cr
&amp;\underline{\mathtt{Pk()}: \mathbb{G}}\cr
&amp;\ \texttt{return } X\cr
\cr
&amp;\underline{\mathtt{Challenge}(m_0, m_1 : \mathcal{M}): \mathbb{G} \times \mathcal{C}}\cr
&amp;\ e \xleftarrow{R} \mathbb{F}_q\cr
&amp;\ E := e \cdot G\cr
&amp;\ k := H(e \cdot X)\cr
&amp;\ c := \text{Enc}(k, m_b)\cr
&amp;\ \texttt{return } (E, c)\cr
\end{aligned}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:22.7807em;vertical-align:-11.1403em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:11.6403em;"><span style="top:-24.7807em;"><span class="pstrut" style="height:24.7807em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:11.3003em;"><span style="top:-13.3003em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:-11.6803em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:-9.92em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:-8.42em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:-6.92em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:-5.42em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:-3.83em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:-2.33em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:-0.83em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:1.0203em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:2.5203em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:4.0203em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:5.5203em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span><span style="top:7.0203em;"><span class="pstrut" style="height:3.12em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:10.8003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:11.3003em;"><span style="top:-13.3803em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.12em;"><span style="top:-3.12em;"><span class="pstrut" style="height:3.6em;"></span><span class="stretchy colorbox" style="background-color:#FBCFE8;height:1.6em;"></span></span><span style="top:-3.6em;"><span class="pstrut" style="height:3.6em;"></span><span class="mord boxpad"><span class="mord sizing reset-size6 size7"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.313em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.0417em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"> </span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.48em;"><span></span></span></span></span></span></span></span><span style="top:-10em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span><span style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice" height="0.522em" width="400em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="margin-right:0.05em;margin-left:0em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-8.5em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-5.5em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">Pk</span><span class="mopen">(</span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span></span></span><span style="top:-0.91em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">Challenge</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="margin-right:0.05em;top:-2.55em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="margin-right:0.05em;margin-left:0em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathcal" style="margin-right:0.0583em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:0.9403em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span><span style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" viewBox="0 0 400000 522" height="0.522em" preserveAspectRatio="xMinYMin slice"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:2.4403em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:3.9403em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mclose">)</span></span></span><span style="top:5.4403em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">E</span><span class="mord">n</span><span class="mord">c</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="margin-left:0em;margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:6.9403em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:10.8003em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-13.6403em;"><span class="pstrut" style="height:24.7807em;"></span><span class="stretchy fbox" style="height:22.7807em;border-width:0.04em;border-style:solid;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:11.1403em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>The adversary interacts with one of these libraries.
If the encryption scheme is secure, then the adversary shouldn't
be able to figure out which of the two libraries it's interacting with.</p>
<p>This library makes calls to the hash function <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>. In the random
oracle model, we model this function by generating random
outputs on demand:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mtable columnspacing="0em" columnalign="right left" rowspacing="0.25em"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext>outputs</mtext><mo stretchy="false">[</mo><mo>⋅</mo><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi mathvariant="normal">⊥</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>P</mi><mo>:</mo><mi mathvariant="double-struck">G</mi><mo stretchy="false">)</mo><mo>:</mo><mi mathvariant="script">K</mi></mrow><mo stretchy="true">‾</mo></munder></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mrow><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mtext>outputs</mtext><mo stretchy="false">[</mo><mi>P</mi><mo stretchy="false">]</mo><mo>=</mo><mi mathvariant="normal">⊥</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mspace width="1em"/><mtext>outputs</mtext><mo stretchy="false">[</mo><mi>P</mi><mo stretchy="false">]</mo><mover><mo minsize="1.75em" stretchy="true">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi>R</mi></mpadded></mover><mi mathvariant="script">K</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mtext>outputs</mtext><mo stretchy="false">[</mo><mi>P</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\begin{aligned}
&amp;\text{outputs}[\cdot] := \bot\cr
\cr
&amp;\underline{H(P : \mathbb{G}): \mathcal{K}}\cr
&amp;\ \texttt{if } \text{outputs}[P] = \bot:\cr
&amp;\ \quad \text{outputs}[P] \xleftarrow{R} \mathcal{K}\cr
&amp;\ \texttt{return } \text{outputs}[P]\cr
\end{aligned}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.0303em;vertical-align:-4.7652em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.2652em;"><span style="top:-12.0303em;"><span class="pstrut" style="height:12.0303em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9252em;"><span style="top:-7.1855em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-5.6855em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-4.1855em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-2.5955em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-0.8352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:0.6648em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4252em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9252em;"><span style="top:-7.1855em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">o</span><span class="mord">u</span><span class="mord">t</span><span class="mord">p</span><span class="mord">u</span><span class="mord">t</span><span class="mord">s</span></span><span class="mopen">[</span><span class="mord">⋅</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span></span></span><span style="top:-4.1855em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0144em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span></span></span><span style="top:-2.5955em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">if </span></span><span class="mord text"><span class="mord">o</span><span class="mord">u</span><span class="mord">t</span><span class="mord">p</span><span class="mord">u</span><span class="mord">t</span><span class="mord">s</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">⊥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span><span style="top:-0.8352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">o</span><span class="mord">u</span><span class="mord">t</span><span class="mord">p</span><span class="mord">u</span><span class="mord">t</span><span class="mord">s</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span><span style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin slice" width="400em" height="0.522em" viewBox="0 0 400000 522"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0144em;">K</span></span></span><span style="top:0.6648em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">return </span></span><span class="mord text"><span class="mord">o</span><span class="mord">u</span><span class="mord">t</span><span class="mord">p</span><span class="mord">u</span><span class="mord">t</span><span class="mord">s</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.1389em;">P</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4252em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-7.2652em;"><span class="pstrut" style="height:12.0303em;"></span><span class="stretchy fbox" style="height:10.0303em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.7652em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>Every time we need to query the function, we generate a random
output, making sure to reuse the output if we've already
generated it before.</p>
<p>And this is really all there is to random oracles. They're
much easier to work with, because their output has no structure
whatsoever, unlike a real hash function. This makes proofs
in the random oracle model simpler. In this
case, a sketch of the security proof is essentially
that the only way to break the scheme would be to somehow
gain information about the key <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span></span></span></span></span>. But because we model
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span> as a random oracle, the only way to do that would be
to learn <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>⋅</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">e \cdot X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span></span></span></span></span>, since the output
is completely unrelated. And being able to learn <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>⋅</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">e \cdot X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span></span></span></span></span>
from <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span></span></span></span></span> and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span></span></span></span></span> is reducable to the Computational Diffie-Hellman
(CDH) problem.</p>
<p>This approach also extends to the case of protocols,
where multiple players are interacting, instead of
just one adversary interacting with a challenger. In this case,
the random oracle is modelled as a common function that all
the players have access to. Internally, it still works
with the lazy random outputs technique we used here; or
with something equivalent.</p>
<p>
<img src=../Images/71ad9c72b137d98416478bc54568b14f1730c9f2026801e6e2cd1ad57aa9f3e8.png alt= /></p>
<h1>Hash Functions</h1>
<p>In practice, we don't have random oracles, nor magic gnomes.
Instead, we have actual hash functions, like BLAKE3, or SHA256,
aut cetera.
Do these functions behave like random oracles?</p>
<h2>Trivial Differences</h2>
<p>There's one trivial way in which all of these fail to be random
oracles, which is that we can <em>pre-compute</em> their outputs.
For example, the SHA256 of the empty string is:</p>
<pre><code>e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</code></pre>
<p>I can tell that SHA256 is being used, and not a random oracle,
simply by querying the random oracle on the empty string.
Since the random oracle is initialized at the start of the
security game, it won't already have this output baked in. In
all likelihood, I'll see a different outupt for the empty string.</p>
<p>This stems from a more fundamental issue with modelling the security
of hash functions. Because a hash function doesn't have any
dependency on secret inputs, it's possible for an adversary
to have a lot of knowledge about that hash function
already "baked in".</p>
<p>For example, SHA256 necessarily has collisions --
two inputs with the same hash -- because
the output space is smaller than the input space; more pigeons
than holes. But, no one knows a collision, nor does anyone
know a procedure for efficiently finding one. Nonetheless,
there does <em>exist</em> some program which immediately outputs
a collision. And, if you tried to model collision resistance
as a security game, you'd run into the issue that this preminiscent
adversary would win that game, because there's no secret
information involved.</p>
<p>
<img src=../Images/85de1832530fa1b803451954b604fea82a97c8978d891d5f0dec7ad44debb4c3.png alt= /></p>
<p>On the other hand, if the hash function were calculated using
a secret key, such that calculating the function without the key were difficult, then the adversary would be forced to actually
interact with the challenger, actively finding a collision instead
of being born knowing that collision.</p>
<p>Another related approach is to use a keyed hash function,
but also provide the adversary with the key. We could even
integrate this into our hybrid encryption scheme from the
previous section. The public key would also include
a hashing key to be used with the hash function, when deriving
the encryption key from the share Diffie-Hellman secret.</p>
<p>You can abstract this a bit further, by modelling
a hash function such as SHA256 as a <em>family</em> of hash functions.
SHA256 relies on the following block of constant values:</p>
<pre><code>428a2f98 71374491 b5c0fbcf e9b5dba5
3956c25b 59f111f1 923f82a4 ab1c5ed5
d807aa98 12835b01 243185be 550c7dc3
72be5d74 80deb1fe 9bdc06a7 c19bf174
e49b69c1 efbe4786 0fc19dc6 240ca1cc
2de92c6f 4a7484aa 5cb0a9dc 76f988da
983e5152 a831c66d b00327c8 bf597fc7
c6e00bf3 d5a79147 06ca6351 14292967
27b70a85 2e1b2138 4d2c6dfc 53380d13
650a7354 766a0abb 81c2c92e 92722c85
a2bfe8a1 a81a664b c24b8b70 c76c51a3
d192e819 d6990624 f40e3585 106aa070
19a4c116 1e376c08 2748774c 34b0bcb5
391c0cb3 4ed8aa4a 5b9cca4f 682e6ff3
748f82ee 78a5636f 84c87814 8cc70208
90befffa a4506ceb bef9a3f7 c67178f2</code></pre>
<p>"These words represent the first 32
bits of the fractional parts of the cube roots of the first sixty-
four prime numbers.",
as per <a href=https://datatracker.ietf.org/doc/html/rfc6234#section-5.1>RFC 6234</a>.</p>
<p>But you could have chosen <em>different</em> values for these constants.
So, in some sense, you can think of SHA256 as a family
of hash functions, one for each choice of constants. Then
you'd model security games involving SHA256 as first involving
a public, but random, choice for these parameters, and then
using the version of SHA256 with those parameters.
This would avoid the trivial issue of adversaries magically
knowing collisions, because their knowledge would
depend on this choice of parameters.</p>
<h2>Some Non-Trivial Differences</h2>
<p>SHA256 specifically is actually not a random oracle in
a less trivial way. This is because it suffers from
<a href=https://www.wikiwand.com/en/Length_extension_attack>Length Extension Attacks</a>.</p>
<p>Essentially, if you know <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(m_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>, and the length of <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.15em;height:0.5806em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="margin-left:0em;margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>,
then you can learn <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(m_0 || m_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="margin-left:0em;margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>, for a somewhat specially
crafted <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.15em;height:0.5806em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="margin-right:0.05em;top:-2.55em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>Now, this quirk doesn't violate any kind of collision
or preimage property we expect hash functions to have,
although it does lead to broken protocols if they naively
concatenate variable length inputs.</p>
<p>On the other hand, this behavior is very different from
that of a random oracle. With a random oracle, the output
is chosen at random, so we aren't able to predict what
the output is going to be on a different message,
no matter what the relation is with other messages.</p>
<p>With SHA256, we can predict the output on related messages,
thus breaking this unpredictability.</p>
<p>While this quirk breaks
the properties of a random oracle,
it's very specific to SHA256 (or hash functions
following the <a href=https://www.wikiwand.com/en/Merkle%E2%80%93Damg%C3%A5rd_construction>Merkle-Damgård paradigm</a>).
The question is then: are there hash functions
without any such quirk?</p>
<h1>Canetti's Paradox</h1>
<p>This is the question Canetti et al. answered, in the negative:
no matter which hash function you choose, there will be
a "quirk" which lets you distinguish this hash function
from a random oracle. In fact, the quirk they found was
"this hash function can be implemented by a deterministic computer program". This is a quirk shared by <strong>every</strong> hash function
we know of, and will ever invent.</p>
<h2>Strings are Programs</h2>
<p>To understand this quirk, we'll first have to take a bit of
a detour. Let me start with a notion that was controversial
100 years ago, but is pretty much accepted by any programmer
nowadays:</p>
<p><strong>You can interpret a string of characters as a program.</strong></p>
<p>If you take a string like <code>foo</code>, <code>bar</code>, or <code>print("hello")</code>,
then you can try and interpret it in your favorite programming
language. You'll either get a valid program which
does something, or you won't. That last string,
<code>print("hello")</code> happens to be a valid python program, printing <code>hello</code>.</p>
<p>So, given a string, we might have a valid program. Given
this program, we might be able to interpret it as a hash function.
For example, the following string:</p>
<pre><code>def hash(x):
  return b"0"</code></pre>
<p>is the world's worst hash function, but it most definitely
has the shape of a hash function.</p>
<p>All of this is just to say that given a string <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">s \in \{0, 1\}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>,
I can interpret that string as a function
<code>${\langle s \rangle : \{0, 1\}^\* \to \{0, 1\}^\* + \bot}$</code>,
potentially outputting <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">⊥</mi></mrow><annotation encoding="application/x-tex">\bot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">⊥</span></span></span></span></span> if we have an invalid program,
or the program doesn't have the shape of a hash function, etc.</p>
<h2>The Quirk</h2>
<p>So, let's say I'm given an oracle as an opaque box <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>.
I'm trying to figure out whether or not I have a real random
oracle, or whether or not this box is just running some
kind of deterministic computer program on each message.</p>
<p>
<img src=../Images/1eb1b71c4c588cebdaf7997e2e7e79fc60f75ad05f6bc03bdece8d62a2ab4d12.png alt= /></p>
<p>Given a message <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span>, I can interpret this message as
function <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><mi>m</mi><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle m \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mopen">⟨</span><span class="mord mathnormal">m</span><span class="mclose">⟩</span></span></span></span></span>, and then evaluate it on the original
message <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span>, to get</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">⟨</mo><mi>m</mi><mo stretchy="false">⟩</mo><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\langle m \rangle (m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord mathnormal">m</span><span class="mclose">⟩</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span></span>
<p>I can then compare this with the result of <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>, checking:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">⟨</mo><mi>m</mi><mo stretchy="false">⟩</mo><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo><mover><mo><mo>=</mo></mo><mo lspace="0em" rspace="0em" stretchy="false">?</mo></mover></mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\langle m \rangle(m) \stackrel{?}{=} H(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.403em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord mathnormal">m</span><span class="mclose">⟩</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="margin-left:0em;top:-3.5669em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span></span>
<p>And here's the magic part. If <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span> is actually a computer program,
then there's a special message <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mo>∗</mo></msub></mrow><annotation encoding="application/x-tex">m_*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1757em;"><span style="top:-2.55em;margin-right:0.05em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> which will make this
check pass. All I have to do is pass in the source code
for <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>. If <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mo>∗</mo></msub></mrow><annotation encoding="application/x-tex">m_*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.15em;height:0.5806em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1757em;"><span style="margin-right:0.05em;margin-left:0em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is the source code for the program implementing
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>, then <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><msub><mi>m</mi><mo>∗</mo></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle m_* \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1757em;"><span style="margin-right:0.05em;margin-left:0em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span></span></span></span></span> is the same function as <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>,
and so the check will pass, both sides being equal to <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mo>∗</mo></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(m_*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1757em;"><span style="margin-right:0.05em;margin-left:0em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>On the other hand, if <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span> is a genuine random oracle,
there's no way to consistently make the check pass, because
the output is genuinely unpredictable, and has no relation
with whatever is happening with the <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><mi>m</mi><mo stretchy="false">⟩</mo><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\langle m \rangle(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mopen">⟨</span><span class="mord mathnormal">m</span><span class="mclose">⟩</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span>
part.</p>
<p>So, no matter which hash function <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span> you use to try
and implement a random oracle, you will always run into
this quirk, because your hash function is implemented by
a computer program. And this quirk is also easy
to find, because if you're using <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span> in your program, it's
because you have access to code implementing <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>.</p>
<h2>A broken Encryption Scheme</h2>
<p>So, there's a quirk which lets us tell the difference between
a concrete hash function and random oracle, no matter the hash
function: does that actually mean that secure schemes using
random oracles become broken if we use a concrete hash function?</p>
<p>Sometimes, yes.</p>
<p>Let's start with the hybrid encryption scheme we had earlier:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle displaystyle="false" scriptlevel="0"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mtable rowspacing="0.25em" columnspacing="0em" columnalign="right left"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><munder accentunder="true"><mrow><mtext mathvariant="monospace">Enc</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>:</mo><mi mathvariant="script">M</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">‾</mo></munder><mo>:</mo><mi mathvariant="script">C</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mi>e</mi><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded width="+0.6em" lspace="0.3em"><mi>R</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mi>E</mi><mo>:</mo><mo>=</mo><mi>e</mi><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mi>k</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>e</mi><mo>⋅</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mi>c</mi><mo>:</mo><mo>=</mo><mtext mathvariant="monospace">SymmetricEnc</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>E</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\begin{aligned}
&amp;\underline{\texttt{Enc}(m : \mathcal{M})}: \mathcal{C}\cr
&amp;\ e \xleftarrow{R} \mathbb{F}_q\cr
&amp;\ E := e \cdot G\cr
&amp;\ k := H(e \cdot X)\cr
&amp;\ c := \texttt{SymmetricEnc}(k, m_b)\cr
&amp;\ \texttt{return } (E, c)\cr
\end{aligned}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-4.7652em;height:10.0303em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.2652em;"><span style="top:-12.0303em;"><span class="pstrut" style="height:12.0303em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9252em;"><span style="top:-7.1855em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-5.3352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-3.8352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-2.3352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-0.8352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:0.6648em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4252em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9252em;"><span style="top:-7.1855em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord texttt">Enc</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal" style="margin-right:0.0583em;">C</span></span></span><span style="top:-5.3352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span><span style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice" width="400em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="margin-right:0.05em;top:-2.55em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.8352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-2.3352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mclose">)</span></span></span><span style="top:-0.8352em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">SymmetricEnc</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.6648em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4252em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-7.2652em;"><span class="pstrut" style="height:12.0303em;"></span><span class="stretchy fbox" style="height:10.0303em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.7652em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>Since this scheme makes use of a hash function <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>, we can try
and modify this scheme so that it gets broken because of the quirk.
We want to end up with a scheme which is secure for random oracles,
but broken for any concrete hash function.</p>
<p>What's the easiest way to make a scheme broken? Leak the private key!
We can modify the scheme to simply leak the private key along with
the ciphertext, using our quirk:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mtable columnalign="right left" rowspacing="0.25em" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><munder accentunder="true"><mrow><mtext mathvariant="monospace">Enc’</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>:</mo><mi mathvariant="script">M</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">‾</mo></munder><mo>:</mo><msup><mi mathvariant="script">C</mi><mo mathvariant="normal" rspace="0em" lspace="0em">′</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mi>e</mi><mover><mo stretchy="true" minsize="1.75em">←</mo><mpadded lspace="0.3em" width="+0.6em"><mi>R</mi></mpadded></mover><msub><mi mathvariant="double-struck">F</mi><mi>q</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext> </mtext><mi>E</mi><mo>:</mo><mo>=</mo><mi>e</mi><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mi>k</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>e</mi><mo>⋅</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mi>c</mi><mo>:</mo><mo>=</mo><mtext mathvariant="monospace">SymmetricEnc</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mpadded mathbackground="palegreen" lspace="3pt" width="+6pt" height="+6pt" voffset="3pt"><mstyle scriptlevel="0" displaystyle="false"><mtext>leak</mtext><mo>:</mo><mo>=</mo><mi>x</mi><mrow><mtext> </mtext><mtext mathvariant="monospace">if</mtext><mtext> </mtext></mrow><mo stretchy="false">⟨</mo><mi>m</mi><mo stretchy="false">⟩</mo><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mrow><mtext> </mtext><mtext mathvariant="monospace">else</mtext><mtext> </mtext></mrow><mi mathvariant="normal">⊥</mi></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mrow><mtext mathvariant="monospace">return</mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mi>E</mi><mo separator="true">,</mo><mi>c</mi><mo separator="true">,</mo><mpadded height="+6pt" mathbackground="palegreen" width="+6pt" voffset="3pt" lspace="3pt"><mtext>leak</mtext></mpadded><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{
\begin{aligned}
&amp;\underline{\texttt{Enc&#x27;}(m : \mathcal{M})}: \mathcal{C}&#x27;\cr
&amp;\ e \xleftarrow{R} \mathbb{F}_q\cr
&amp;\ E := e \cdot G\cr
&amp;\ k := H(e \cdot X)\cr
&amp;\ c := \texttt{SymmetricEnc}(k, m_b)\cr
&amp;\ \colorbox{palegreen}{$\text{leak} :=x \texttt{ if } \langle m \rangle(m) = H(m)\texttt{ else } \bot$}\cr
&amp;\ \texttt{return } (E, c, \colorbox{palegreen}{leak})\cr
\end{aligned}
}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-5.7924em;height:12.0848em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.2924em;"><span style="top:-14.0848em;"><span class="pstrut" style="height:14.0848em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9524em;"><span style="top:-8.2127em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-6.3624em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-4.8624em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-3.3624em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-1.8624em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:-0.1524em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span><span style="top:1.6921em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4524em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9524em;"><span style="top:-8.2127em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord texttt">Enc’</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathcal">M</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.45em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.0583em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="margin-right:0.05em;top:-3.113em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-6.3624em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1003em;"><span style="top:-3.322em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span><span style="top:-2.689em;"><span class="pstrut" style="height:2.7em;"></span><span class="hide-tail" style="min-width:1.469em;height:0.522em;"><svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin slice" height="0.522em" viewBox="0 0 400000 522" width="400em"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="margin-right:0.05em;top:-2.55em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.8624em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-3.3624em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.0785em;">X</span><span class="mclose">)</span></span></span><span style="top:-1.8624em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">SymmetricEnc</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="margin-right:0.05em;top:-2.55em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.1524em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-3.05em;"><span class="pstrut" style="height:3.6em;"></span><span class="stretchy colorbox" style="background-color:palegreen;height:1.6em;"></span></span><span style="top:-3.6em;"><span class="pstrut" style="height:3.6em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord">l</span><span class="mord">e</span><span class="mord">a</span><span class="mord">k</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mord text"><span class="mord texttt"> if </span></span><span class="mopen">⟨</span><span class="mord mathnormal">m</span><span class="mclose">⟩</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord text"><span class="mord texttt"> else </span></span><span class="mord">⊥</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.55em;"><span></span></span></span></span></span></span></span><span style="top:1.6921em;"><span class="pstrut" style="height:3.1003em;"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">return </span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0576em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9944em;"><span style="top:-2.9944em;"><span class="pstrut" style="height:3.2944em;"></span><span class="stretchy colorbox" style="background-color:palegreen;height:1.2944em;"></span></span><span style="top:-3.2944em;"><span class="pstrut" style="height:3.2944em;"></span><span class="mord boxpad"><span class="mord">l</span><span class="mord">e</span><span class="mord">a</span><span class="mord">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4524em;"><span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-8.2924em;"><span class="pstrut" style="height:14.0848em;"></span><span class="stretchy fbox" style="height:12.0848em;border-width:0.04em;border-style:solid;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.7924em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>We interpret the message as a hash function, and evaluate it at <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span>,
comparing it with the result of <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>. If <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span> is a random oracle,
then finding a message which makes this check pass is exceedingly difficult,
and so nothing will actually get leaked. On the other hand, if <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>
is a real hash function, then we can encrypt the source code
of <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>, and have our encryption scheme spit out the secret key.</p>
<p>Thus, this scheme provides a nice counter-example, which shows
that there are schemes secure in the random oracle model, but insecure
when instantiated with a real hash function.</p>
<h1>Lessons?</h1>
<p>While this is a nice theoretical result, the scheme we've created
is a bit silly, for two reasons:</p>
<ul><li>In practice, a scheme isn't going to have an explicit "trapdoor" which
automatically leaks its private key if some condition is met.</li><li>The quirk that <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><mi>m</mi><mo stretchy="false">⟩</mo><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\langle m \rangle(m) = H(M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord mathnormal">m</span><span class="mclose">⟩</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span></span></span> seems quite artificial as well.</li></ul>
<p>Now, while these points are true, I think we shouldn't be too quick to
dismiss this result. In general, counter-examples in Cryptography
seem quite contrived at a first glance, but they can illustrate
more subtle issues.</p>
<p>There are many examples of vulnerabilities where a small amount
of information leakage can be exploited to mount a more complete
attack. Take the example of <a href=https://link.springer.com/content/pdf/10.1007%2FBFb0055716.pdf>Bleichenbacher's Attack</a>, or <a href=https://www.wikiwand.com/en/Padding_oracle_attack>Padding Oracles</a>. So while the trapdoor
on our contrived scheme is very obvious,
it's possible that a concrete
scheme suffers from smaller and more subtle information leakage
because of the difference between a random oracle and a concrete hash function.</p>
<p>This brings us to the second point. The quirk we've noticed
exploits a fundamental, but somewhat trivial difference between hash functions
and random oracles: hash functions can be implemented with a program.
We used this difference to create a scheme which is only secure
with random oracles. But, it's not clear if this property actually matters
for security in "realistic" schemes. For example,
Pseudo-Random Functions (PRF) can also implemented with a program,
but are believed to be as unpredictable as a random oracle,
provided you don't know the secret key used when evaluated them.
On the other hand, it's possible
that there are more <em>subtle</em> differences between random oracles
and hash functions, and that these differences do result in
exploitable vulnerabilities in actual schemes.</p>
<p>By using a very obvious difference, and a obvious clear trapdoor, we make
our counter-example crystal clear. But even though our counter-example
is far removed from concrete schemes, there could still be
subtler differences and trapdoors which might exist with more realistic schemes.</p>
<h1>Conclusion</h1>
<p>At this point, one question should be: can proofs in the random oracle
model be trusted? I think I want to say <em>yes</em> to this question. Obviously,
we shouldn't take the random oracle model as a trivial assumption, and if
a proof can avoid relying on it, that's all for the better. On the other
hand, there are now many proofs relying on this model, and the only major
flaw I know of resulting from the use of this model is perhaps
the presence of <a href=https://www.wikiwand.com/en/Length_extension_attack>Length Extension Attacks</a>, and other similar issues with message concatenation.</p>
<p>There are assumptions that we have to rely on in Cryptography,
like the hardness of certain problems, and maybe the random oracle
model is just one of the assumptions we'll have to concede.</p>
<p>It may also be possible to provider a <em>weaker</em> form of the random oracle
model which is still strong enough to be useful for proofs, but weak
enough that we can use concrete hash functions in order to implement it.</p>
<p>Maybe you'll be the person who discovers these models 8^).</p><section class="footnotes">
<ol>
</ol>
</section>


</body>
</html>