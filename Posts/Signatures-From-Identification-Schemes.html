<!DOCTYPE html>
<html lang="en">
<head>
<title>cronokirby - Signatures From Identification Schemes</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css" integrity="sha384-Pu5+C18nP5dwykLJOhd2U4Xen7rjScHN/qusop27hdd2drI+lL5KvX7YntvT8yew" crossorigin="anonymous"><title>cronokirby - Signatures From Identification Schemes</title>

<link rel="stylesheet" href="/static/index.css">
<link rel="icon" href="/static/icon.png">
<script src="/static/theme.js" defer></script>
</head>
<body>
<header>
<div class="icon-bar">
  <a href="/">
    <img src="/static/icon.png" class="avatar" />
  </a>
  <button class="theme-toggle" id="theme-toggle">
    <svg xmlns="http://www.w3.org/2000/svg" height="2em" viewBox="0 -960 960 960" width="2em" fill="currentColor"><path d="M480-120q-133 0-226.5-92.5T160-436q0-66 25-122t69-100l226-222 226 222q44 44 69 100t25 122q0 131-93.5 223.5T480-120Zm0-80v-568L310-600q-35 33-52.5 74.5T240-436q0 97 70 166.5T480-200Z"/></svg>
  </button>
</div>
<time datetime="2021-07-10">2021-07-10</time>

<h1>Signatures From Identification Schemes</h1>




<ul class="tags">

  <li class="tag">
    <a href="/tag/cryptography/index.html">
    #cryptography
    </a>
  </li>

  <li class="tag">
    <a href="/tag/math/index.html">
    #math
    </a>
  </li>

  <li class="tag">
    <a href="/tag/security/index.html">
    #security
    </a>
  </li>

</ul>

</header>

<p>It turns out that all you need to make a signature scheme
is a way to prove your identity.</p><!--more-->
<p>In fact, you can develop such a scheme from first principles,
arriving at a deterministic signature scheme, commonly
known as "Schnorr Signatures". I'll be trying
to demonstrate that in this post. I hope to show that
this signature system was too obvious to be patented.</p>
<p>That being said, I am not a lawyer.</p>
<h1>Identification</h1>
<p>You arrive at "the club". The bouncer asks you, "what's the secret password?".
You tell him the "secret password".
He now knows you are indeed a member of "the club".
The bouncer knows this, because you know the "secret password".</p>
<p>What you <em>know</em> is a great way to prove <em>who</em> you are.</p>
<p>Like many serious topics in security,
we start with a game. The game involves a challenger,
and yourself. You want to prove who you are to this challenger. You
do this by exchanging messages with eachother. We call this game
an "identification protocol". At least, I do.</p>
<p>The simplest protocol follows the club analogy.
We know some secret <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span></span></span>. If a challenger wants
to check who we are, we can prove our identity by showing
that we know our this secret. The simplest way to do this is to
send them the secret:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowlines="none none dashed none" rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>Setup</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>A</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mover><mo stretchy="true" minsize="1.75em">→</mo><mpadded lspace="0.3em" width="+0.6em"><mrow></mrow></mpadded></mover></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\small \text{Setup}\cr
&amp;\textcolor{red}{a} \stackrel{R}{:=} \{0, 1\}^n \cr
\cr
\hdashline
&amp;\small \text{A} \cr
&amp;\textcolor{red}{a} \xrightarrow{} \cr
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.8689em;vertical-align:-3.6844em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1844em;"><span style="top:-6.1844em;"><span class="pstrut" style="height:6.1844em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1844em;"><span style="top:-6.5533em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-4.6844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-3.1844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-1.6844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-0.1844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6844em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1844em;"><span style="top:-6.5533em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">S</span><span class="mord">e</span><span class="mord">t</span><span class="mord">u</span><span class="mord">p</span></span></span></span><span style="top:-4.6844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="margin-left:0em;top:-3.6306em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="margin-right:0.05em;top:-3.113em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span style="top:-1.6844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">A</span></span></span></span><span style="top:-0.1844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.622em;"><span style="top:-3.144em;"><span class="pstrut" style="height:2.522em;"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"></span></span></span><span style="top:-2.511em;"><span class="pstrut" style="height:2.522em;"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400000 522" height="0.522em" preserveAspectRatio="xMaxYMin slice" width="400em"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6844em;"><span></span></span></span></span></span></span></span><span style="top:-5.5em;"><span class="pstrut" style="height:6.1844em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6844em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>There are numerous problems with this scheme.</p>
<p>First, there's no simple way to verify our identity.
We could share a secret among members of some group.
Members could then present this secret amongst themselves to verify
membership. But we can't prove our identity to a non-member.</p>
<p>The other problem is that we leak our secret every time we perform
the protocol. We don't want to leak our secret.</p>
<p>One way to avoid this is to mask our secret with another random value:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable columnalign="right left" rowspacing="0.25em" columnspacing="0em" rowlines="none none dashed none none none"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>Setup</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>A</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>k</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>⊕</mo><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>⟶</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\small \text{Setup}\cr
&amp;\textcolor{red}{a} \stackrel{R}{:=} \{0, 1\}^n \cr
\cr
\hdashline
&amp;\small \text{A} \cr
&amp;\textcolor{red}{k} \stackrel{R}{:=} \{0, 1\}^n \cr
&amp;\textcolor{blue}{s} := \textcolor{red}{k} \oplus \textcolor{red}{a} \cr
&amp;\textcolor{blue}{s} \longrightarrow \cr
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:11.2378em;vertical-align:-5.3689em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.8689em;"><span style="top:-7.8689em;"><span class="pstrut" style="height:7.8689em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.8689em;"><span style="top:-8.2378em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-6.3689em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-4.8689em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-3.3689em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:0em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:1.5em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.3689em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.8689em;"><span style="top:-8.2378em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">S</span><span class="mord">e</span><span class="mord">t</span><span class="mord">u</span><span class="mord">p</span></span></span></span><span style="top:-6.3689em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="margin-left:0em;top:-3.6306em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="margin-right:0.05em;top:-3.113em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span style="top:-3.3689em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">A</span></span></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="margin-left:0em;top:-3.6306em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span style="top:0em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span><span style="top:1.5em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟶</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.3689em;"><span></span></span></span></span></span></span></span><span style="top:-8.8689em;"><span class="pstrut" style="height:7.8689em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.3689em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>Our proof of identity <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:blue;">s</span></span></span></span></span> can be shared publicly,
without revealing our secret. This is because masking our secret
using the xor (<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊕</mo></mrow><annotation encoding="application/x-tex">\oplus</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.0833em;height:0.6667em;"></span><span class="mord">⊕</span></span></span></span></span>) operation makes it look completely random.</p>
<p>Addition modulo some number <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span> would also work:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>+</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.1667em"/><mspace width="0.1667em"/><mi>L</mi></mrow><annotation encoding="application/x-tex">\textcolor{blue}{s} := \textcolor{red}{k} + \textcolor{red}{a} \mod L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span></span></span></span></span></span>
<blockquote>
<p>[!note] <strong>Note:</strong>
In fact, modular <em>multiplication</em> would also work, provided
we pick a number coprime to the modulus <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span>.</p></blockquote>
<p>The problem with this scheme is that our proof can't be verified.
The challenger has no
information about <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span>. The value <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:blue;">s</span></span></span></span></span>
looks completely random to them. They can't verify that we know
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span></span></span>.</p>
<p>We can't reveal <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span>
without allowing the challenger to compute:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>=</mo><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>−</mo><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a} = \textcolor{blue}{s} - \textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span></span>
<p>We're at a bit of an impass.</p>
<h1>A Technical Leap of Faith</h1>
<p>This section presents a jump in our technical tools. We introduce
a cyclic group <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">G</mi></mrow><annotation encoding="application/x-tex">\mathbb{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">G</span></span></span></span></span>, of order <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span>, and with generator <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span>.
Our hypothesis is that if we have a scalar <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x \in \mathbb{Z}/(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></span>,
then calculating the element <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mi>x</mi><mo>⋅</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">H = x \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span> is easy. But, given <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mo lspace="0em" mathvariant="normal" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">H&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>,
finding
what <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is needed to produce <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mo mathvariant="normal" rspace="0em" lspace="0em">′</mo></msup><mo>=</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⋅</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">H&#x27; = x&#x27; \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="margin-right:0.05em;top:-3.063em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span> is very difficult.
This problem is called the "Discrete Logarithm Problem".
There are groups where we know the problem is very easy,
like <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}/(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.109em;">N</span><span class="mclose">)</span></span></span></span></span>. There are also groups where we <em>believe</em> this
problem is very hard. The main kind of group we use now is
a group of points on an Elliptic Curve.</p>
<p>If medium sized Quantum Computers come to exist, they will be able
to efficiently solve Discrete Logarithms.</p>
<p>I don't believe this is
a problem we'll have to deal with for at least 20 years.</p>
<p>Using a group is a breakthrough. This is because we can safely
share <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>⋅</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K} = \textcolor{red}{k} \cdot G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span>, even
if we want to keep <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span> secret. This allows us to
verify secret equations like <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>=</mo><mstyle mathcolor="red"><mi>b</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a} = \textcolor{red}{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="color:red;">b</span></span></span></span></span>
by instead verifying public equations, like <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle><mo>=</mo><mstyle mathcolor="blue"><mi>B</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{A}
= \textcolor{blue}{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="color:blue;">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0502em;color:blue;">B</span></span></span></span></span>.</p>
<p>Let's update our scheme with this in mind.</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowlines="none none none dashed none none none none none dashed none" columnalign="right left" rowspacing="0.25em" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>Setup</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>A</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>k</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>⟶</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>+</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.1667em"/><mspace width="0.1667em"/><mi>L</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>⟶</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>B</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>⋅</mo><mi>G</mi><mo><mover><mo><mo>=</mo></mo><mo rspace="0em" lspace="0em" stretchy="false">?</mo></mover></mo><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>+</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\small \text{Setup}\cr
&amp;\textcolor{red}{a} \stackrel{R}{:=} \mathbb{Z}/(L) \cr
&amp;\textcolor{blue}{A} := \textcolor{red}{a} \cdot G \cr
\cr
\hdashline
&amp;\small \text{A} \cr
&amp;\textcolor{red}{k} \stackrel{R}{:=} \mathbb{Z}/(L) \cr
&amp;\textcolor{blue}{K} := \textcolor{red}{k} \cdot G\cr
&amp;\textcolor{blue}{K} \longrightarrow \cr
&amp;\textcolor{blue}{s} := \textcolor{red}{k} + \textcolor{red}{a} \mod L \cr
&amp;\textcolor{blue}{s} \longrightarrow \cr
\hdashline
&amp;\small \text{B} \cr
&amp;\textcolor{blue}{s} \cdot G \stackrel{?}{=}
\textcolor{blue}{K} + \textcolor{blue}{A}
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-9.2754em;height:19.0508em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.7754em;"><span style="top:-11.7754em;"><span class="pstrut" style="height:11.7754em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.7754em;"><span style="top:-12.1443em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-10.2754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-8.7754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-7.2754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-5.7754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-3.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-2.4065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-0.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:0.5935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:2.0935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:3.5935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:5.4065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.2754em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.7754em;"><span style="top:-12.1443em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">S</span><span class="mord">e</span><span class="mord">t</span><span class="mord">u</span><span class="mord">p</span></span></span></span><span style="top:-10.2754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="margin-left:0em;top:-3.6306em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span><span style="top:-8.7754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-5.7754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">A</span></span></span></span><span style="top:-3.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="top:-3.6306em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span><span style="top:-2.4065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-0.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟶</span></span></span><span style="top:0.5935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span></span></span><span style="top:2.0935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟶</span></span></span><span style="top:3.5935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">B</span></span></span></span><span style="top:5.4065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="margin-left:0em;top:-3.5669em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.2754em;"><span></span></span></span></span></span></span></span><span style="top:-5.813em;"><span class="pstrut" style="height:11.7754em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span><span style="top:-15.1819em;"><span class="pstrut" style="height:11.7754em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.2754em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>We now have both a private key, <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span></span></span>, and a public
key, <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span></span>. Our public key acts as our identity.
The identification scheme lets us prove that know the corresponding
private key.</p>
<p>We also have an equation to verify the validity of our proof.
This equation works because:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>⋅</mo><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>+</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mo stretchy="false">)</mo><mo>⋅</mo><mi>G</mi><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>⋅</mo><mi>G</mi><mo>+</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>⋅</mo><mi>G</mi><mo>=</mo><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>+</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{s}\cdot G =
(\textcolor{red}{k} + \textcolor{red}{a})\cdot G =
\textcolor{red}{k} \cdot G + \textcolor{red}{a} \cdot G =
\textcolor{blue}{K} + \textcolor{blue}{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span></span></span>
<p>The reason this scheme works is pretty ingenious. We
generate a mask <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span>, which hides <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span></span></span>
when added to it. But, we can allow the challenger to verify our
operation, by providing a public commitment <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span>
to this random mask. This shifts a verification of a property
of our secrets <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span> and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span></span></span>
into a verification about our public values
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span> and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span></span>.</p>
<p>There is one big flaw in this scheme though. Our challenger can reuse
our proof to impersonate us.</p>
<p>After seeing <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span> and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:blue;">s</span></span></span></span></span>,
they can play this game with another challenger. If they just reuse
these values, they will win the game.
his allows them to convince a challenger
that they know the secret associated with <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span></span>.</p>
<p>The problem is that challengers don't act
any differently, so the answer to one challenger's question
can be used for any other challenger.</p>
<p>To fix this, we can have the challenger randomize their challenge.
Now we have to use this randomness to make a proof of identity
tailored to this request:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowlines="none none none dashed none none none dashed none none dashed none none dashed none" rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>Setup</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>A</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>k</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>⟶</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>B</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="green"><mi>u</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>⟵</mo><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>A</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>+</mo><mstyle mathcolor="green"><mi>u</mi></mstyle><mstyle mathcolor="red"><mi>a</mi></mstyle><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.1667em"/><mspace width="0.1667em"/><mi>L</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>⟶</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>B</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>⋅</mo><mi>G</mi><mo><mover><mo><mo>=</mo></mo><mo lspace="0em" rspace="0em" stretchy="false">?</mo></mover></mo><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>+</mo><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>⋅</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\small \text{Setup}\cr
&amp;\textcolor{red}{a} \stackrel{R}{:=} \mathbb{Z}/(L) \cr
&amp;\textcolor{blue}{A} := \textcolor{red}{a} \cdot G \cr
\cr
\hdashline
&amp;\small \text{A} \cr
&amp;\textcolor{red}{k} \stackrel{R}{:=} \mathbb{Z}/(L) \cr
&amp;\textcolor{blue}{K} := \textcolor{red}{k} \cdot G\cr
&amp;\textcolor{blue}{K} \longrightarrow \cr
\hdashline
&amp;\small \text{B} \cr
&amp;\textcolor{green}{u} \stackrel{R}{:=} \mathbb{Z}/(L) \cr
&amp;\longleftarrow \textcolor{green}{u} \cr
\hdashline
&amp;\small \text{A} \cr
&amp;\textcolor{blue}{s} := \textcolor{red}{k} +
\textcolor{green}{u}\textcolor{red}{a} \mod L \cr
&amp;\textcolor{blue}{s} \longrightarrow \cr
\hdashline
&amp;\small \text{B} \cr
&amp;\textcolor{blue}{s} \cdot G \stackrel{?}{=}
\textcolor{blue}{K} + \textcolor{green}{u} \cdot \textcolor{blue}{A}
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:25.4197em;vertical-align:-12.4598em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:12.9598em;"><span style="top:-14.9598em;"><span class="pstrut" style="height:14.9598em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:12.9598em;"><span style="top:-15.3287em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-13.4598em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-11.9598em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-10.4598em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-8.9598em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-7.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-5.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-4.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-2.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-0.722em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:0.778em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:2.278em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:3.778em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:5.278em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:6.778em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:8.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:12.4598em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:12.9598em;"><span style="top:-15.3287em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">S</span><span class="mord">e</span><span class="mord">t</span><span class="mord">u</span><span class="mord">p</span></span></span></span><span style="top:-13.4598em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="margin-left:0em;top:-3.6306em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span><span style="top:-11.9598em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-8.9598em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">A</span></span></span></span><span style="top:-7.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="top:-3.6306em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span><span style="top:-5.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-4.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟶</span></span></span><span style="top:-2.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">B</span></span></span></span><span style="top:-0.722em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="top:-3.6306em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span><span style="top:0.778em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟵</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span><span style="top:2.278em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">A</span></span></span></span><span style="top:3.778em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span></span></span><span style="top:5.278em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟶</span></span></span><span style="top:6.778em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">B</span></span></span></span><span style="top:8.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:12.4598em;"><span></span></span></span></span></span></span></span><span style="top:-5.813em;"><span class="pstrut" style="height:14.9598em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span><span style="top:-10.313em;"><span class="pstrut" style="height:14.9598em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span><span style="top:-15.1819em;"><span class="pstrut" style="height:14.9598em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span><span style="top:-21.5508em;"><span class="pstrut" style="height:14.9598em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:12.4598em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>Our challenger gives us a unique bit of randomness  that
we need to use when producing our proof. This means that the result
of one game can't be reused again, since the challenger will be
supplying a different value for <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span>.
This scheme is a secure identification protocol, but some variations
of it wouldn't be.</p>
<p>For example, we could try multiplying <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span>
with <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span> instead, forming:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="green"><mi>u</mi></mstyle><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>+</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.1667em"/><mspace width="0.1667em"/><mi>L</mi></mrow><annotation encoding="application/x-tex">\textcolor{blue}{s} :=
\textcolor{green}{u}\textcolor{red}{k} + \textcolor{red}{a}\mod L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span></span></span></span></span></span>
<p>The problem is that a challenger could supply <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\textcolor{green}{u} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>,
and then our proof would reveal <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span></span></span>.</p>
<p>Another idea would be to have the challenger send us <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span>
before we send our commitment <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span>.
The problem is that this would allow us to cheat by choosing
a devilish commitment.</p>
<p>If we choose <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\textcolor{blue}{s} \stackrel{R}{:=} \mathbb{Z}/(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2089em;"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="margin-left:0em;top:-3.6306em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></span>,
and then commit to
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>⋅</mo><mi>G</mi><mo>−</mo><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>⋅</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K} := \textcolor{blue}{s} \cdot G - \textcolor{green}{u} \cdot \textcolor{blue}{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span></span>, then our proof will be accepted,
despite us not using any secrets at all. Because of this, it's very important
that <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span> is chosen after <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span>.
In fact, we shouldn't be able to figure out what <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span>
will be until <em>after</em> we've generated <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span>, otherwise
this flaw would remain.</p>
<p>Thanks to <a href=https://twitter.com/adr1anh/status/1412420596974161921>Adrian Hamelink</a> for bringing this one to my attention.</p>
<h1>A Conceptual Leap of Faith</h1>
<p>At this point we have a secure identification scheme. A challenger
can verify that you are who you claim to be. At least, they can
verify that you own the corresponding secret for a public key.
This protocol is dynamic. The transcript for one challenge can't
be reused for another challenge.</p>
<p>This is similar to what we want for
a signature. The data of a signature should show that the owner
of a public key signed off on this specific message. This signature
should be unusable for any other message.</p>
<p>Here's the leap of faith: a signature scheme is just an identification protocol,
where the challenger is the message itself.</p>
<p>Conceptually, think of a bank teller asking you to sign a document.
First, they challenge your identity. Satisfied with that, they then
put a stamp on the document. Effectively, you've signed the document.</p>
<p>A digital signature is like this, except the document itself is issuing
the challenge. What's beautiful is that we can devise a scheme
in which the way you're prodded by a message is transparent, and
knowable in advance. This will allow anyone with access to the transcript
of the game you've played with the message to verify that
you successfully proved your identity to the message.</p>
<p>This acts as a way of signing a message.</p>
<p>Operationally, this means replacing choices made by a challenger,
with deterministic, but unpredictable, functions of the message
and whatever knowledge it has at that point. To do this,
we use hash functions.</p>
<p>A Cryptographic hash function has many useful
properties. Essentially, a hash function acts like a random function
on its inputs. You don't really know what it's going to output
until you shove some stuff into it, and see what comes out.</p>
<p>We can use this to replace the random generation of <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span>,
with deterministic generation, based on a message <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.109em;">M</span></span></span></span></span>. We now calculate:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mstyle mathcolor="blue"><mi>K</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\textcolor{green}{u} := H(\textcolor{blue}{A} || \textcolor{blue}{K} || M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="color:blue;">A</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span></span></span></span>
<p>Now the "challenge" we receive is based on our public key, the commitment
we've provided, and the message "challenging" us to prove our identity.</p>
<p>You can conceptualize this as follows. Each message is like a unique
challenger in time. The function <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span> allows us to provide each of
these challengers with a way of generating a random <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span>,
based on the information they'd have access to if the game were dynamic.
Since <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span> is effectively a random function, it's like each message
is actually challenging us with a random <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span>,
since there's no way to predict what the output of the hash function
is going to be in advance, until we see the message.</p>
<p>We can now construct our signature scheme with this in mind:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable columnalign="right left" rowspacing="0.25em" columnspacing="0em" rowlines="none none none dashed none none none none none none dashed none none"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>Setup</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>A</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>k</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mstyle mathcolor="blue"><mi>K</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>+</mo><mstyle mathcolor="green"><mi>u</mi></mstyle><mstyle mathcolor="red"><mi>a</mi></mstyle><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.1667em"/><mspace width="0.1667em"/><mi>L</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mo stretchy="false">(</mo><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo separator="true">,</mo><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>B</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mstyle mathcolor="blue"><mi>K</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>⋅</mo><mi>G</mi><mo><mover><mo><mo>=</mo></mo><mo rspace="0em" stretchy="false" lspace="0em">?</mo></mover></mo><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>+</mo><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>⋅</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\small \text{Setup}\cr
&amp;\textcolor{red}{a} \stackrel{R}{:=} \mathbb{Z}/(L) \cr
&amp;\textcolor{blue}{A} := \textcolor{red}{a} \cdot G \cr
\cr
\hdashline
&amp;\small \text{A} \cr
&amp;\textcolor{red}{k} \stackrel{R}{:=} \mathbb{Z}/(L) \cr
&amp;\textcolor{blue}{K} := \textcolor{red}{k} \cdot G\cr
&amp;\textcolor{green}{u} := H(\textcolor{blue}{A} || \textcolor{blue}{K} || M)\cr
&amp;\textcolor{blue}{s} := \textcolor{red}{k} +
\textcolor{green}{u}\textcolor{red}{a} \mod L \cr
&amp;(\textcolor{blue}{K}, \textcolor{blue}{s}) \cr
\cr
\hdashline
&amp;\small \text{B} \cr
&amp;\textcolor{green}{u} := H(\textcolor{blue}{A} || \textcolor{blue}{K} || M)\cr
&amp;\textcolor{blue}{s} \cdot G \stackrel{?}{=}
\textcolor{blue}{K} + \textcolor{green}{u} \cdot \textcolor{blue}{A}
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:22.0508em;vertical-align:-10.7754em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:11.2754em;"><span style="top:-13.2754em;"><span class="pstrut" style="height:13.2754em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:11.2754em;"><span style="top:-13.6443em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-11.7754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-10.2754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-8.7754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-7.2754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-5.4065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-3.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-2.4065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-0.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:0.5935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:2.0935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:3.5935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:5.0935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:6.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:10.7754em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:11.2754em;"><span style="top:-13.6443em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">S</span><span class="mord">e</span><span class="mord">t</span><span class="mord">u</span><span class="mord">p</span></span></span></span><span style="top:-11.7754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="top:-3.6306em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span><span style="top:-10.2754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-7.2754em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">A</span></span></span></span><span style="top:-5.4065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="top:-3.6306em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span><span style="top:-3.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-2.4065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="color:blue;">A</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span><span style="top:-0.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span></span></span><span style="top:0.5935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mclose">)</span></span></span><span style="top:3.5935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">B</span></span></span></span><span style="top:5.0935em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="color:blue;">A</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span><span style="top:6.9065em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="top:-3.5669em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:10.7754em;"><span></span></span></span></span></span></span></span><span style="top:-7.313em;"><span class="pstrut" style="height:13.2754em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span><span style="top:-18.1819em;"><span class="pstrut" style="height:13.2754em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:10.7754em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>This is basically the identification scheme earlier, except that
it's no longer interactive. Instead, we produce a signature
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:blue;">s</span></span></span></span></span> alone, which
consists of the public information we would
have sent to a challenger. Others can verify
the signature by computing the challenge <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span>,
and verifying the equation, as challengers did previously.</p>
<p>Some variations on the hash would compromise security. For example,
if we didn't include <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span> in the hash, then we would
run into the same issue as earlier, when <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span>
was sent before <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span>. We would be able to forge
signatures by choosing a fake commitment <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span>.
By including the commitment inside the hash, we make sure that the
random output depends on knowledge of <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span>,
which prevents <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span></span></span></span></span> from depending on
the value of <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="green"><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{green}{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:green;">u</span></span></span></span></span>.</p>
<p>We could also choose not to include <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span></span> in
the hash. I don't think this compromises security. But, it's a
good idea to throw this in there, that way our challenge also depends
on who we're challenging, in addition to the message.</p>
<p>This is a secure signature scheme. In fact, it's an incredibly
natural signature scheme. All the choices we've made in designing
it were pretty straightforward, and usually the easiest one to make.
I'd say that this scheme is a natural consequence of using
groups to create commitments, and of conceiving of messages
as challengers in an identification scheme. Both of these ideas
have widespread usage in more advanced protocols.</p>
<h1>Determinism</h1>
<p>The scheme we have works. There's just a tiny ugliness. That ugliness
is that we need to generate, and not leak,
a random <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span>.  This is a bit excessive for
what we need. We don't need a random <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span>.
It would be fine if running our protocol on the same message
again produced the same signature. That might even be desirable.</p>
<p>What we actually need is for <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span> to be unpredictable,
based on the message <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.109em;">M</span></span></span></span></span>, and also based on our control of
<span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{blue}{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span></span>,
i.e. based on <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span></span></span>.</p>
<p>One straightforward solution is to choose:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\textcolor{red}{k} := H(\textcolor{red}{a} || M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="color:red;">a</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span></span></span></span>
<p>Even better would be to use a specialized <em>keyed hash</em>, designed
for this specific use case:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>:</mo><mo>=</mo><msub><mi>H</mi><mstyle mathcolor="red"><mi>a</mi></mstyle></msub><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\textcolor{red}{k} := H_{\textcolor{red}{a}}(M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="margin-left:-0.0813em;margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="color:red;">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span></span></span></span>
<p>A keyed hash should be very difficult to calculate without
knowledge of the key, and provide the same random guarantees
as a hash function after that. Sometimes concatenating the
key and the message is sufficient to produce a secure keyed hash,
sometimes it isn't.
Using a scheme that provides this as a black box is better
than rolling your own.</p>
<p>One problem is that we now use our key <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span></span></span>
in two ways. As a key for a hash, and as a scalar for generating
the signature. It's generally a bad idea to use a key for multiple
purposes. Instead, you should use a single master key,
and then use a "key derivation function" (KDF) to derive new single-purpose
keys for your different use cases.</p>
<p>This means having two KDFs, <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>KDF</mtext><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\text{KDF}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span><span class="mord">F</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>, and <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>KDF</mtext><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\text{KDF}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.15em;height:0.8333em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span><span class="mord">F</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>, and then
deriving our hashing key and scalar from a master key:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable columnalign="right left" columnspacing="0em" rowspacing="0.25em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>m</mi><mi>k</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>:</mo><mo>=</mo><msub><mtext>KDF</mtext><mn>1</mn></msub><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>m</mi><mi>k</mi></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>h</mi><mi>k</mi></mstyle><mo>:</mo><mo>=</mo><msub><mtext>KDF</mtext><mn>2</mn></msub><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>m</mi><mi>k</mi></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\textcolor{red}{mk} \stackrel{R}{:=} \{0, 1\}^n \cr
&amp;\textcolor{red}{a} := \text{KDF}_1(\textcolor{red}{mk}) \cr
&amp;\textcolor{red}{hk} := \text{KDF}_2(\textcolor{red}{mk}) \cr
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-2.1844em;height:4.8689em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6844em;"><span style="top:-4.6844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-3.1844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-1.6844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1844em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6844em;"><span style="top:-4.6844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">mk</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="top:-3.6306em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="margin-right:0.05em;top:-3.113em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span style="top:-3.1844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span><span class="mord">F</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="margin-right:0.05em;top:-2.55em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">mk</span><span class="mclose">)</span></span></span><span style="top:-1.6844em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">hk</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span><span class="mord">F</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">mk</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1844em;"><span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>(Note that in practice, you can use a single KDF function, and
pass a different "context string" to derive different key values
for different purposes. Note also that KDFs
are often simple wrappers around hash functions).</p>
<p>At this point, we can use <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="color:red;">a</span></span></span></span></span> as we did before,
and then use <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>h</mi><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{hk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">hk</span></span></span></span></span> exclusively for generating
our nonce <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span></span></span></span></span>:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>h</mi><mi>k</mi></mstyle><mo separator="true">,</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\textcolor{red}{k} := H(\textcolor{red}{hk}, M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="vertical-align:-0.25em;height:1em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">hk</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span></span></span></span>
<h1>Wrapping up</h1>
<p>Collecting all we've seen so far,
I now present to you, a fully deterministic signature scheme,
depending on a cylic group <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">G</mi></mrow><annotation encoding="application/x-tex">\mathbb{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">G</span></span></span></span></span> of order <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span>, generated
by <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span>, and a hash function <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span></span></span></span></span>, used to create corresponding
keyed hash variants <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">H_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="vertical-align:-0.15em;height:0.8333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;margin-left:-0.0813em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0315em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>, and KDF functions <span class="katex-wrapper"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>KDF</mtext><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">\text{KDF}_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span><span class="mord">F</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>:</p><span class="katex-wrapper"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable columnspacing="0em" columnalign="right left" rowspacing="0.25em" rowlines="none none none none none dashed none none none none none none none none none dashed none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>KeyGen</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>m</mi><mi>k</mi></mstyle><mo><mover><mo><mo>:</mo><mo>=</mo></mo><mi>R</mi></mover></mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>:</mo><mo>=</mo><msub><mtext>KDF</mtext><mn>1</mn></msub><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>m</mi><mi>k</mi></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>A</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>m</mi><mi>k</mi></mstyle><mo separator="true">,</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>Sign</mtext><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>m</mi><mi>k</mi></mstyle><mo separator="true">,</mo><mi>M</mi><mo stretchy="false">)</mo></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>h</mi><mi>k</mi></mstyle><mo>:</mo><mo>=</mo><msub><mtext>KDF</mtext><mn>2</mn></msub><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>m</mi><mi>k</mi></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>h</mi><mi>k</mi></mstyle><mo separator="true">,</mo><mi>M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mstyle mathcolor="blue"><mi>K</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathcolor="red"><mi>a</mi></mstyle><mo>:</mo><mo>=</mo><msub><mtext>KDF</mtext><mn>1</mn></msub><mo stretchy="false">(</mo><mstyle mathcolor="red"><mi>m</mi><mi>k</mi></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mi>k</mi></mstyle><mo>+</mo><mstyle mathcolor="green"><mi>u</mi></mstyle><mstyle mathcolor="red"><mi>a</mi></mstyle><mspace></mspace><mspace width="1em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.1667em"/><mspace width="0.1667em"/><mi>L</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mtext>sig</mtext><mo>:</mo><mo>=</mo><mo stretchy="false">(</mo><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo separator="true">,</mo><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mstyle mathsize="0.9em"><mtext>Verify</mtext><mo stretchy="false">(</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle><mo separator="true">,</mo><mtext>sig</mtext><mo stretchy="false">)</mo></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mstyle mathcolor="blue"><mi>K</mi></mstyle><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mstyle mathcolor="blue"><mi>s</mi></mstyle><mo>⋅</mo><mi>G</mi><mo><mover><mo><mo>=</mo></mo><mo rspace="0em" stretchy="false" lspace="0em">?</mo></mover></mo><mstyle mathcolor="blue"><mi>K</mi></mstyle><mo>+</mo><mstyle mathcolor="green"><mi>u</mi></mstyle><mo>⋅</mo><mstyle mathcolor="blue"><mi>A</mi></mstyle></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\small \text{KeyGen}\cr
&amp;\textcolor{red}{mk} \stackrel{R}{:=} \{0, 1\}^n \cr
&amp;\textcolor{red}{a} := \text{KDF}_1(\textcolor{red}{mk}) \cr
&amp;\textcolor{blue}{A} := \textcolor{red}{a} \cdot G \cr
&amp;(\textcolor{red}{mk}, \textcolor{blue}{A}) \cr
\cr
\hdashline
&amp;\small \text{Sign}(\textcolor{red}{mk}, M) \cr
\cr
&amp;\textcolor{red}{hk} := \text{KDF}_2(\textcolor{red}{mk}) \cr
&amp;\textcolor{red}{k} := H(\textcolor{red}{hk}, M) \cr
&amp;\textcolor{blue}{K} := \textcolor{red}{k} \cdot G\cr
&amp;\textcolor{green}{u} := H(\textcolor{blue}{A} || \textcolor{blue}{K} || M)\cr
&amp;\textcolor{red}{a} := \text{KDF}_1(\textcolor{red}{mk}) \cr
&amp;\textcolor{blue}{s} := \textcolor{red}{k} +
\textcolor{green}{u}\textcolor{red}{a} \mod L \cr
&amp;\text{sig} := (\textcolor{blue}{K}, \textcolor{blue}{s}) \cr
\cr
\hdashline
&amp;\small \text{Verify}(\textcolor{blue}{A}, \text{sig}) \cr
\cr
&amp;\textcolor{green}{u} := H(\textcolor{blue}{A} || \textcolor{blue}{K} || M)\cr
&amp;\textcolor{blue}{s} \cdot G \stackrel{?}{=}
\textcolor{blue}{K} + \textcolor{green}{u} \cdot \textcolor{blue}{A}
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:30.6819em;vertical-align:-15.0909em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:15.5909em;"><span style="top:-17.5909em;"><span class="pstrut" style="height:17.5909em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:15.5909em;"><span style="top:-17.9598em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-16.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-14.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-13.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-11.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-10.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-8.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-7.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-5.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-4.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-2.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:-1.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:0.4091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:1.9091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:3.4091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:4.9091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:6.4091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:7.9091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:9.4091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span><span style="top:11.222em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:15.0909em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:15.5909em;"><span style="top:-17.9598em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">K</span><span class="mord">e</span><span class="mord">y</span><span class="mord">G</span><span class="mord">e</span><span class="mord">n</span></span></span></span><span style="top:-16.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">mk</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2089em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">:=</span></span></span><span style="top:-3.6306em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0077em;">R</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span style="top:-14.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span><span class="mord">F</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">mk</span><span class="mclose">)</span></span></span><span style="top:-13.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-11.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">mk</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:blue;">A</span><span class="mclose">)</span></span></span><span style="top:-8.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">S</span><span class="mord">i</span><span class="mord">g</span><span class="mord">n</span></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.0315em;color:red;">mk</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.109em;">M</span><span class="mclose sizing reset-size6 size5">)</span></span></span><span style="top:-5.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">hk</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span><span class="mord">F</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">mk</span><span class="mclose">)</span></span></span><span style="top:-4.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">hk</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span><span style="top:-2.5909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span></span></span><span style="top:-1.0909em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="color:blue;">A</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span><span style="top:0.4091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord text"><span class="mord">K</span><span class="mord">D</span><span class="mord">F</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">mk</span><span class="mclose">)</span></span></span><span style="top:1.9091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0315em;color:red;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mord mathnormal" style="color:red;">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span></span></span><span style="top:3.4091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mclose">)</span></span></span><span style="top:6.4091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord text sizing reset-size6 size5"><span class="mord">V</span><span class="mord">e</span><span class="mord">r</span><span class="mord">i</span><span class="mord">f</span><span class="mord">y</span></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5" style="color:blue;">A</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text sizing reset-size6 size5"><span class="mord">s</span><span class="mord">i</span><span class="mord">g</span></span><span class="mclose sizing reset-size6 size5">)</span></span></span><span style="top:9.4091em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0813em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="color:blue;">A</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.109em;">M</span><span class="mclose">)</span></span></span><span style="top:11.222em;"><span class="pstrut" style="height:3.2089em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="color:blue;">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.153em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">=</span></span></span><span style="margin-left:0em;top:-3.5669em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0715em;color:blue;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:green;">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:blue;">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:15.0909em;"><span></span></span></span></span></span></span></span><span style="top:-8.813em;"><span class="pstrut" style="height:17.5909em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span><span style="top:-23.813em;"><span class="pstrut" style="height:17.5909em;"></span><span class="hdashline" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:15.0909em;"><span></span></span></span></span></span></span></span></span></span></span>
<p>It's quite stunning that there's such a natural build up from
a simple and obviously broken identification scheme to
this little intricate signature scheme. I had a lot of fun dissecting
how this kind of signature works, and why things are set up the way
they are.</p>
<p>Hopefully I've conveyed some of that fun in this post.</p>
<h1>Addendum: Patents</h1>
<p>Unfortunately, while this signature scheme is exceedingly natural,
it was covered by
<a href=https://patents.google.com/patent/US4995082A/en>a patent</a>,
filed by Claus Schnorr, from 1991 until 2008. Did this have the effect
of rewarding Schnorr for his invention, through licensing? No.</p>
<p>Instead, it lead to the creation of a different scheme for
signatures: <a href=https://www.wikiwand.com/en/Digital_Signature_Algorithm>DSA</a>.
This scheme has arbitrary modifications designed to skirt existing
patents. At least, some people have intuited that.</p>
<p>Personally, I think DSA is an ugly scheme compared to the more natural
Schnorr signatures. This isn't just a matter of aesthetics: but the shape of DSA
makes building more complicated extensions difficult. Thresholdizing
Schnorr Signatures is easy, but thresholdizing DSA is substantially
trickier.</p>
<p>Patents are intended to spur innovation. In this case, innovation
was necessary to avoid the arbitrary roadblocks imposed by patents.</p>
<p>I don't think patents are the right tool for incentivizing innovation in Cryptography.</p><section class="footnotes">
<ol>
</ol>
</section>


</body>
</html>